<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Home</title>
<link>https://jhylin.github.io/Data_in_life_blog/#category=R</link>
<atom:link href="https://jhylin.github.io/Data_in_life_blog/index-r.xml" rel="self" type="application/rss+xml"/>
<description>A blog website about using software tools to decipher drug discovery and development data</description>
<generator>quarto-1.7.31</generator>
<lastBuildDate>Sun, 09 Nov 2025 11:00:00 GMT</lastBuildDate>
<item>
  <title>Using Python in R - reticulate</title>
  <dc:creator>Jennifer HY Lin</dc:creator>
  <link>https://jhylin.github.io/Data_in_life_blog/posts/22_Back_to_basics/2_Using_python_in_r_reticulate.html</link>
  <description><![CDATA[ 






<section id="background" class="level5">
<h5 class="anchored" data-anchor-id="background"><strong>Background</strong></h5>
<p>The main goal here is to try using Python and R concurrently in a notebook setting. Both programming languages have their weaknesses and strengths, and also differences and similarities. By combining them together, we can leverage R’s strong statistical packages and Python’s well-developed and maintained machine learning packages in some of our scientific research work.</p>
<p>For rpy2 package, I’ve tried it in a separate post (<strong>add link</strong>). Interestingly, I had to pause in the middle of working on it due to an issue about plotting. I’ve since returned to it after trying out reticulate, and have found a way to generate a plot using ggplot2 in rpy2.</p>
<p>For <a href="https://rstudio.github.io/reticulate/index.html">reticulate package</a>, the concept is reversed where we are trying to call Python in a R environment as it is a R-based package. So I’ve changed the title of this post to reflect this.</p>
<p><br></p>
</section>
<section id="setting-up-notebook-environment" class="level5">
<h5 class="anchored" data-anchor-id="setting-up-notebook-environment"><strong>Setting up notebook environment</strong></h5>
<p>Steps I’ve taken:</p>
<p>Initial preparation - this notebook has been created using a virtual environment from uv, with the <a href="https://github.com/jhylin/Back_to_basics">associated repository</a> created using the uv project management structure as well. This step has been done prior to the executions of the following steps.</p>
<ol type="1">
<li><p>Install R with version at least 4.0 or above, and Python with version at least 3.7 or above (<a href="https://rviews.rstudio.com/2022/05/25/calling-r-from-python-with-rpy2/">reference</a>). The versions of R and Python used here are suggested by the <a href="https://rviews.rstudio.com/2022/05/25/calling-r-from-python-with-rpy2/">old reference post about using rpy2 from 2022</a>. So far when I’ve tried it with reticulate package, it works so I’ll leave them as how they are now.</p></li>
<li><p>Install R’s language server. All R packages are to be installed via R console/terminal (not in notebooks, otherwise you may run into some error messages).</p></li>
</ol>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">```{r}</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"languageserver"</span>)</span>
<span id="cb1-3"><span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">```</span></span></code></pre></div>
<ol start="3" type="1">
<li><p>Install <a href="https://rstudio.github.io/reticulate/">reticulate package</a> as shown in its <a href="https://github.com/rstudio/reticulate/">GitHub repository</a>.</p></li>
<li><p>Install rmarkdown package so we can preview .qmd docs (this step may not be required as this is purely for posting on my blog). Some further set-ups may be required if using VS Code, e.g.&nbsp;go to “Settings” of VS Code -&gt; under “User” -&gt; Text Editor -&gt; Files -&gt; Associations -&gt; add *.Rmd as “Item” and rmd as “Value”</p></li>
<li><p>Install R extension for VS Code (may not be required as this is because I’m using VS Code. There is another very similar IDE called Positron created by Posit which may not require this step).</p></li>
<li><p>Install shiny package (I was reminded to do this while installing these packages… unsure of its direct relevance to my goal here but it doesn’t hurt so I’ve done it)</p></li>
</ol>
<p>Quarto markdown documents (.qmd) and R markdown documents (.rmd) are interchangeable as .qmd are based on .rmd so I’ve done a little trial using reticulate package first in .rmd which worked, and then decided to switch to .qmd so that this piece of work may be published on my blog later. The convenient thing here is that you can literally just change the file name ending with .rmd to .qmd to convert a .rmd file into a .qmd file.</p>
<p><br></p>
</section>
<section id="import-libraries" class="level5">
<h5 class="anchored" data-anchor-id="import-libraries"><strong>Import libraries</strong></h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Show R version used</span></span>
<span id="cb2-2">R.version.string</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "R version 4.5.1 (2025-06-13)"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Import R packages/libraries in R</span></span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(reticulate)</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Import Python packages/libraries in R </span></span>
<span id="cb4-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This step is required to install Python packages in R while using reticulate</span></span>
<span id="cb4-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reference: https://rstudio.github.io/reticulate/articles/python_packages.html</span></span>
<span id="cb4-7"></span>
<span id="cb4-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Import pandas</span></span>
<span id="cb4-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">py_require</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pandas"</span>)</span>
<span id="cb4-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># below likely needed if calling pandas in r code, but since I'll be using python code, </span></span>
<span id="cb4-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># we can just import python packages as usual without following code</span></span>
<span id="cb4-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#pd &lt;- import("pandas")</span></span>
<span id="cb4-13"></span>
<span id="cb4-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Import plotnine</span></span>
<span id="cb4-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">py_require</span>( <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plotnine"</span>)</span>
<span id="cb4-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#p9 &lt;- import("plotnine")</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Show Python version used</span></span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">py_config</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>python:         /Users/jenniferlin/Data_in_life_blog/.venv/bin/python
libpython:      /Users/jenniferlin/.local/share/uv/python/cpython-3.12.7-macos-x86_64-none/lib/libpython3.12.dylib
pythonhome:     /Users/jenniferlin/Data_in_life_blog/.venv:/Users/jenniferlin/Data_in_life_blog/.venv
virtualenv:     /Users/jenniferlin/Data_in_life_blog/.venv/bin/activate_this.py
version:        3.12.7 (main, Oct 16 2024, 09:10:10) [Clang 18.1.8 ]
numpy:          /Users/jenniferlin/Data_in_life_blog/.venv/lib/python3.12/site-packages/numpy
numpy_version:  1.26.4

NOTE: Python version was forced by VIRTUAL_ENV</code></pre>
</div>
</div>
<p>Below is a small test snippet of running Python code in R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Code snippet below borrowed from https://www.geeksforgeeks.org/r-language/integrating-python-code-with-r/</span></span>
<span id="cb7-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Running Python code in R</span></span>
<span id="cb7-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">py_run_string</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x = 10"</span>)</span>
<span id="cb7-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">py_run_string</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y = 5"</span>)</span>
<span id="cb7-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">py_run_string</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"z = x + y"</span>)</span>
<span id="cb7-6"></span>
<span id="cb7-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Access the Python variable in R</span></span>
<span id="cb7-8">z <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> py<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>z  </span>
<span id="cb7-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(z)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15</code></pre>
</div>
</div>
<p>I have a feeling now that it’s easier to use reticulate package for the purpose of combining Python and R in one place.</p>
<p><br></p>
</section>
<section id="plotting-in-r-using-ggplot2-and-plotnine" class="level5">
<h5 class="anchored" data-anchor-id="plotting-in-r-using-ggplot2-and-plotnine"><strong>Plotting in R using ggplot2 and plotnine</strong></h5>
<p>Next example is using Python code to read a dataframe using Pandas.</p>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb9-1"><span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">```{python}</span></span>
<span id="cb9-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## This is the code for read_df.py</span></span>
<span id="cb9-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># import pandas</span></span>
<span id="cb9-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb9-5"></span>
<span id="cb9-6"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> reading_df(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">file</span>):</span>
<span id="cb9-7">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reading a df (using one of my old cleaned datasets from a while ago)</span></span>
<span id="cb9-8">    df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.read_csv(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">file</span>)</span>
<span id="cb9-9">    df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df.rename(columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"QED Weighted"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"QED"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Polar Surface Area"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PSA"</span>})</span>
<span id="cb9-10">    </span>
<span id="cb9-11">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> df</span>
<span id="cb9-12"><span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">```</span></span></code></pre></div>
<p><br></p>
<section id="ggplot2" class="level6">
<h6 class="anchored" data-anchor-id="ggplot2"><strong>ggplot2</strong></h6>
<p>Then I’m using R’s well-known plotting package, <a href="https://ggplot2.tidyverse.org/">ggplot2</a>, to plot a scatter plot as an example shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read data using read_df.py</span></span>
<span id="cb10-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source_python</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"read_df.py"</span>)</span>
<span id="cb10-3">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reading_df</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"df_ml.csv"</span>)</span>
<span id="cb10-4"></span>
<span id="cb10-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb10-6"></span>
<span id="cb10-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(PSA, QED, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> Max_Phase)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb10-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb10-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_jitter</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://jhylin.github.io/Data_in_life_blog/posts/22_Back_to_basics/2_Using_python_in_r_reticulate_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="plotnine" class="level6">
<h6 class="anchored" data-anchor-id="plotnine"><strong>plotnine</strong></h6>
<p>An equivalent Python plotting library based on ggplot2 is <a href="https://plotnine.org/">plotnine</a>. The same plot is shown below using plotnine with Python code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> read_df <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> reading_df</span>
<span id="cb11-2">df_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> reading_df(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"df_ml.csv"</span>)</span>
<span id="cb11-3"></span>
<span id="cb11-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> plotnine <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> p9</span>
<span id="cb11-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># from plotnine import *</span></span>
<span id="cb11-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># from plotnine import ggplot, aes, geom_point</span></span>
<span id="cb11-7"></span>
<span id="cb11-8">plot <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (p9.ggplot(data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>df_data) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p9.geom_point(mapping<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>p9.aes(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PSA"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"QED"</span>, color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Max_Phase"</span>)))</span>
<span id="cb11-9"></span>
<span id="cb11-10">plot.show()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://jhylin.github.io/Data_in_life_blog/posts/22_Back_to_basics/2_Using_python_in_r_reticulate_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="614"></p>
</figure>
</div>
</div>
</div>
<p>All plots shown in this post using reticulate and the other post using rpy2 should look the same by using the same set of data but different code in two different programming languages (which means I’ve somewhat achieved my small goal here!).</p>
<p><br></p>
</section>
</section>
<section id="regarding-reproducibility-of-projects-in-r" class="level5">
<h5 class="anchored" data-anchor-id="regarding-reproducibility-of-projects-in-r"><strong>Regarding reproducibility of projects in R</strong></h5>
<p>I realise after finishing these two posts about using R and Python together that I should’ve created two separate repositories and virtual environments where one is based on Python and the other based on R to improve the reproducibilities of the work (hmm… currently it may look messy with what I’ve done here, as these two posts are in a Python-based virtual environment). It is possible and most likely recommended to set up a R virtual environment when working on R-related projects. This <a href="https://posit.co/blog/renv-project-environments-for-r/">introductory post</a> about <a href="https://rstudio.github.io/renv/articles/renv.html">renv</a> will help with this.</p>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <category>Notes</category>
  <category>Python</category>
  <category>R</category>
  <guid>https://jhylin.github.io/Data_in_life_blog/posts/22_Back_to_basics/2_Using_python_in_r_reticulate.html</guid>
  <pubDate>Sun, 09 Nov 2025 11:00:00 GMT</pubDate>
</item>
<item>
  <title>Using R in Python - rpy2</title>
  <dc:creator>Jennifer HY Lin</dc:creator>
  <link>https://jhylin.github.io/Data_in_life_blog/posts/22_Back_to_basics/1_Using_r_in_python_rpy2.html</link>
  <description><![CDATA[ 






<p>This is something I’ve always wanted to try, that is using both R and Python in one place, so here it is.</p>
<p>Essentially, I think there are two packages that may do the trick - one is rpy2 and the other is reticulate. I’ll try rpy2 first in this post. For the notes about using reticulate package, it’ll be in a separate post (<strong>add link</strong>).</p>
<p>There will be two different versions of code below where one is based on using R dataframe in Python and ggplot2, and the other one is based on pandas dataframe in Python with ggplot2. From my little experience using both versions of code, I’d say the second one using pandas and ggplot2 works better than the first (other more experienced users may have different opinions of course… there are always new things to learn for sure).</p>
<p><br></p>
<section id="setting-up-notebook-environment" class="level5">
<h5 class="anchored" data-anchor-id="setting-up-notebook-environment"><strong>Setting up notebook environment</strong></h5>
<p>Steps:</p>
<p>This notebook has been created using a virtual environment using uv, with the associated <a href="https://github.com/jhylin/Back_to_basics">repository</a> created using the project structure from uv too. This step has been done prior to the executions of the following steps.</p>
<ol type="1">
<li><p>Install R with version at least 4.0 or above, and Python with version at least 3.7 or above (as suggested by this <a href="https://rviews.rstudio.com/2022/05/25/calling-r-from-python-with-rpy2/">post</a>). The versions of Python and R used in this notebook are printed above the plot shown below.</p></li>
<li><p>Install R’s language server as shown below.</p></li>
</ol>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">```{r}</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"languageserver"</span>)</span>
<span id="cb1-3"><span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">```</span></span></code></pre></div>
<ol start="3" type="1">
<li><p>Install <a href="https://rstudio.github.io/reticulate/">reticulate package</a> (<a href="https://github.com/rstudio/reticulate/">GitHub repo</a>). It’s a useful R interface to Python and will be used in the other post.</p></li>
<li><p>Install rmarkdown package (may not be required as this is really just making sure that this note may be posted on my blog later that uses Quarto).</p></li>
<li><p>Install R extension for VS Code (may not be required as this is because I’m using VS Code. There is another very similar IDE called Positron created by Posit which may not require this step).</p></li>
<li><p>Install <a href="https://github.com/rpy2/rpy2">rpy2 package</a>. This notebook uses rpy2 version 3.6.4.</p></li>
</ol>
<p>Note: the installations of R-related packages need to be done in the R console in RStudio/Positron IDE or R terminal in VS Code. The R code above are not to be executed in Quarto markdown (.qmd) or RMarkdown (.rmd) documents as this will lead to an error message like this, “trying to use CRAN without setting a mirror…” when trying to preview the .qmd or .rmd.</p>
<p><br></p>
</section>
<section id="using-r-dataframe-in-python-and-ggplot2" class="level5">
<h5 class="anchored" data-anchor-id="using-r-dataframe-in-python-and-ggplot2"><strong>Using R dataframe in python and ggplot2</strong></h5>
<div id="8de755d4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rpy2</span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#import rpy2 as robjects</span></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## To print HTML in notebooks</span></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># import rpy2.ipython.html</span></span>
<span id="cb2-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rpy2.ipython.html.init_printing()</span></span>
<span id="cb2-6"></span>
<span id="cb2-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rpy2.robjects.packages <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> importr</span>
<span id="cb2-8"></span>
<span id="cb2-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Using a local converter</span></span>
<span id="cb2-10"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rpy2.robjects <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> conversion, default_converter</span>
<span id="cb2-11"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> conversion.localconverter(default_converter):</span>
<span id="cb2-12"></span>
<span id="cb2-13">    utils <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> importr(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'utils'</span>)</span>
<span id="cb2-14">    dataf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> utils.read_csv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"df_ml.csv"</span>)</span>
<span id="cb2-15">    </span>
<span id="cb2-16">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#print(dataf)</span></span>
<span id="cb2-17">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(dataf.colnames)</span>
<span id="cb2-18"></span>
<span id="cb2-19">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Visualising with ggplot2 in Python</span></span>
<span id="cb2-20">    <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rpy2.robjects.lib.ggplot2 <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> gp</span>
<span id="cb2-21"></span>
<span id="cb2-22">    p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (gp.ggplot(dataf, gp.aes(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Polar.Surface.Area'</span>, y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'QED.Weighted'</span>)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-23">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># gp.aes(x='Polar.Surface.Area', y='QED.Weighted') + </span></span>
<span id="cb2-24">        gp.geom_point())</span>
<span id="cb2-25"></span>
<span id="cb2-26">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## To see plots in an output cell - this doesn't work yet, it generates an empty .png with error message</span></span>
<span id="cb2-27">    <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rpy2.ipython.ggplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> image_png</span>
<span id="cb2-28">    image_png(p)</span>
<span id="cb2-29"></span>
<span id="cb2-30">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## this code seems to work by completing the run, but no plot is shown</span></span>
<span id="cb2-31">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># p.plot()</span></span>
<span id="cb2-32"></span>
<span id="cb2-33">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## this code also seems to work but with no plot shown</span></span>
<span id="cb2-34">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print(p)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>R callback write-console: In addition:   
R callback write-console: Warning message:
  
R callback write-console: In (function (filename = "Rplot%03d.png", width = 480, height = 480,  :  
R callback write-console: 
   
R callback write-console:  failed to load cairo DLL
  </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Max_Phase"          "Polar.Surface.Area" "HBA"               
[4] "HBD"                "X.RO5.Violations"   "QED.Weighted"      
[7] "CX.LogP"            "CX.LogD"            "Heavy.Atoms"       
</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="coding-issues" class="level5">
<h5 class="anchored" data-anchor-id="coding-issues"><strong>Coding issues</strong></h5>
<p>The first coding issue encountered is that the code to produce a final output of the dataframe won’t transform into a .qmd preview i.e.&nbsp;html page. There is an error message showing such as, “Conversion rules for <code>rpy2.robjects</code> appear to be missing…” when trying to preview this as a .qmd. One of the solutions I’ve found online (<a href="https://stackoverflow.com/questions/75069677/rpy2-throws-a-notimplementederror-concerning-conversion-rules">code reference</a>) is to set up a local converter in the code and run all rpy2-related code within this converter (as commented in the code above).</p>
<p>The second issue is that I’ve only managed to run the code to show R dataframe in Python but not the plot… hence you will see the error message generated from the code above, with only the column names shown without a plot there. To resolve this issue, more time is spent on looking for answers online. A mini test has been done in a Jupyter notebook to show a short code to achieve a simple plot (<a href="https://github.com/jhylin/Back_to_basics/blob/main/1_Using_r_in_python_pd_ggplot2_rpy2.ipynb">link to Jupyter notebook</a> which is based on this <a href="https://stackoverflow.com/questions/43975244/displaying-r-ggplots-inline-in-jupyter-notebooks">code reference</a>) by calling R magic in Python kernel via rpy2. Once this works, I then manage to change the code to import a sample dataframe and set up to display a simple scatter plot as shown below.</p>
<p><br></p>
</section>
<section id="using-pandas-and-ggplot2" class="level5">
<h5 class="anchored" data-anchor-id="using-pandas-and-ggplot2"><strong>Using pandas and ggplot2</strong></h5>
<div id="68e5aced" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># python version used</span></span>
<span id="cb5-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> sys</span>
<span id="cb5-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(sys.version)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3.12.7 (main, Oct 16 2024, 09:10:10) [Clang 18.1.8 ]</code></pre>
</div>
</div>
<div id="5f0fa845" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load R magic</span></span>
<span id="cb7-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>load_ext rpy2.ipython</span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb7-5"></span>
<span id="cb7-6">df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.read_csv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"df_ml.csv"</span>)</span>
<span id="cb7-7">df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df.rename(columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"QED Weighted"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"QED"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Polar Surface Area"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PSA"</span>})</span>
<span id="cb7-8">df.head()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The rpy2.ipython extension is already loaded. To reload it, use:
  %reload_ext rpy2.ipython</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Max_Phase</th>
<th data-quarto-table-cell-role="th">PSA</th>
<th data-quarto-table-cell-role="th">HBA</th>
<th data-quarto-table-cell-role="th">HBD</th>
<th data-quarto-table-cell-role="th">#RO5 Violations</th>
<th data-quarto-table-cell-role="th">QED</th>
<th data-quarto-table-cell-role="th">CX LogP</th>
<th data-quarto-table-cell-role="th">CX LogD</th>
<th data-quarto-table-cell-role="th">Heavy Atoms</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>66.81</td>
<td>4</td>
<td>1</td>
<td>0</td>
<td>0.47</td>
<td>3.94</td>
<td>3.94</td>
<td>32</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0</td>
<td>62.55</td>
<td>3</td>
<td>1</td>
<td>0</td>
<td>0.93</td>
<td>3.38</td>
<td>3.38</td>
<td>25</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0</td>
<td>73.86</td>
<td>5</td>
<td>1</td>
<td>2</td>
<td>0.12</td>
<td>9.34</td>
<td>9.34</td>
<td>40</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0</td>
<td>84.22</td>
<td>4</td>
<td>2</td>
<td>0</td>
<td>0.76</td>
<td>2.01</td>
<td>-0.19</td>
<td>26</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0</td>
<td>40.46</td>
<td>4</td>
<td>0</td>
<td>0</td>
<td>0.62</td>
<td>4.00</td>
<td>4.00</td>
<td>26</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="f584b099" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rpy2.robjects <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> conversion, default_converter</span>
<span id="cb9-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> conversion.localconverter(default_converter):</span>
<span id="cb9-3"></span>
<span id="cb9-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># R version</span></span>
<span id="cb9-5">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>R <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(R.version.string)</span>
<span id="cb9-6"></span>
<span id="cb9-7">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Importing ggplot2</span></span>
<span id="cb9-8">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>R require(ggplot2)</span>
<span id="cb9-9"></span>
<span id="cb9-10">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Take name of input variable df and assign it to an R variable of the same name</span></span>
<span id="cb9-11">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>R <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>i df</span>
<span id="cb9-12"></span>
<span id="cb9-13">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the df</span></span>
<span id="cb9-14">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>R <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(ggplot(df, aes(PSA, QED, colour <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Max_Phase)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> geom_point())</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "R version 4.5.1 (2025-06-13)"</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>In addition: Warning message:
In (function (mapping = NULL, data = NULL, stat = "identity", position = "identity",  :
  All aesthetics have length 1, but the data has 5670 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://jhylin.github.io/Data_in_life_blog/posts/22_Back_to_basics/1_Using_r_in_python_rpy2_files/figure-html/cell-5-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="dataframe-libraries-in-r-and-python" class="level5">
<h5 class="anchored" data-anchor-id="dataframe-libraries-in-r-and-python"><strong>Dataframe libraries in R and Python</strong></h5>
<p>There may be frequent debates about which programming language to use for data cleaning and manipulations. I’m open to use either whenever it suits really. As far as I’m aware, R has <a href="https://dplyr.tidyverse.org/">dyplr</a> package (part of the core tidyverse packages) that is equivalent to pandas in Python (depending on personal preference and habits, different users will have different opinions about “equivalence” here). There is <a href="https://docs.pola.rs/api/python/stable/reference/index.html">Polars</a> as well that’s available to use in Python and R (<a href="https://pola-rs.github.io/r-polars/index.html">R Polars</a>). I think there’s also a more conventional base R code available that can be used to wrangle dataframes (e.g.&nbsp;a R package called <a href="https://github.com/Rdatatable/data.table">data.table</a> that is based on base R’s data.frame, it appears that it may be harder to learn than dyplr due to syntax but it’ll be great for large datasets). There is a useful <a href="https://atrebas.github.io/post/2019-03-03-datatable-dplyr/">post</a> suggested by R users online that introduces and explains data.table’s differences from dyplr.</p>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <category>Notes</category>
  <category>R</category>
  <category>Python</category>
  <guid>https://jhylin.github.io/Data_in_life_blog/posts/22_Back_to_basics/1_Using_r_in_python_rpy2.html</guid>
  <pubDate>Sat, 08 Nov 2025 11:00:00 GMT</pubDate>
</item>
<item>
  <title>Shiny app in R</title>
  <dc:creator>Jennifer HY Lin</dc:creator>
  <link>https://jhylin.github.io/Data_in_life_blog/posts/12_Shiny_app_chembl/ShinyAppChembl.html</link>
  <description><![CDATA[ 






<section id="back-story" class="level5">
<h5 class="anchored" data-anchor-id="back-story"><strong>Back story</strong></h5>
<p>It has been a long while since I’ve used R in my projects. Last year during the time when I bravely embraced the role of rotating curator for <span class="citation" data-cites="WeAreRLadies">@WeAreRLadies</span> on Twitter around end of October, I did mention that I wanted to learn Shiny. I haven’t forgotten about this actually. So as promised, here it is, my first Shiny app in R, which is really a very simple interactive web app about small molecules from ChEMBL database. The URL to reach this app, <a href="https://jhylin.shinyapps.io/ShinyAppChembl/">ShinyAppChembl</a>, is at: https://jhylin.shinyapps.io/ShinyAppChembl/. It shows a selected set of physicochemical properties for the curated small molecules in different max phases in boxplot formats. <strong><em>Note: it may take a few minutes to load the plot when first opening the app.</em></strong></p>
<p><br></p>
</section>
<section id="the-process" class="level5">
<h5 class="anchored" data-anchor-id="the-process"><strong>The process</strong></h5>
<p>Since I haven’t been using a lot of R lately, I just wanted to document how I approached this Shiny app framework, as part of my self-directed learning for R that started around mid-2022. The first place I went to was not Google’s Bard or OpenAI’s ChatGPT, as I was trying to preempt a scenario where if both of these options were temporarily down, what would I do to learn a new tool. So I visited the <a href="https://shiny.rstudio.com/">Shiny website</a> first, and literally started from the “Get Started” section there, then tried to read through the lessons provided. I gathered a quick overview about the core components within a Shiny app, which were the user interface, server logic and the call to run or create app in the end, and thought to get started from there.</p>
<p>One of the most helpful online books called, “<a href="https://mastering-shiny.org/index.html">Mastering Shiny</a>” had clarified a few coding issues for me. The reactivity section in the book was very useful as well to help with understanding the interactivity concept in the app. The best and also the hardest thing at this stage after reading some of the information was to actually start coding for the app in RStudio IDE, which I did soon after.</p>
<p><br></p>
</section>
<section id="trials-and-errors" class="level5">
<h5 class="anchored" data-anchor-id="trials-and-errors"><strong>Trials-and-errors</strong></h5>
<p>Initially, I’ve noticed in the gallery section from the Shiny website that some of the basic Shiny apps had plots produced with R code using S3 method - the type with class ‘formula’, such as boxplot(formula e.g.&nbsp;y ~ group, data, and so on). So I started with this first and ended up with a draft version shown below:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jhylin.github.io/Data_in_life_blog/posts/12_Shiny_app_chembl/Draft_app_error_1.jpg" class="img-fluid figure-img"></p>
<figcaption>First draft app using S3 method in R code to plot boxplots - screenshot taken by author</figcaption>
</figure>
</div>
<p><br></p>
<p>I then tried the ggplot2 version, which I preferred to use. However, I kept on hitting a roadblock repeatedly (as shown in the image below):</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jhylin.github.io/Data_in_life_blog/posts/12_Shiny_app_chembl/Draft_app_error_2.jpg" class="img-fluid figure-img"></p>
<figcaption>Second draft app using ggplot2 boxplot format - screenshot taken by author</figcaption>
</figure>
</div>
<p>I ended up working through this issue of not being able to display the boxplots properly over at least two days, where I tried to figure out how to change the code so that the boxplots would appear as the output in the app. I actually wrote a plot function code (as shown below) before working on the app.R file, in order to trial plotting the boxplots, making sure that the code worked before using it in the app.R file.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">```{r}</span></span>
<span id="cb1-2">dfBoxplot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(var) {</span>
<span id="cb1-3">  label <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rlang<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">englue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"{{var}} vs. Max Phases of small molecules"</span>)</span>
<span id="cb1-4">  </span>
<span id="cb1-5">  chembl <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Max Phase</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, {{ var }}) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Max Phase</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> {{ var }})) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut_width</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Max Phase</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>), </span>
<span id="cb1-9">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Max Phase</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>), </span>
<span id="cb1-10">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outlier.alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-11">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> label)</span>
<span id="cb1-12">}</span>
<span id="cb1-13"><span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">```</span></span></code></pre></div>
<p>Once I made sure this code worked, I transplanted the code into the server section of the app.R file, however it wasn’t that simple obviously. Through the process of more trials-and-errors, I managed to figure out the code for the plot output in the final version, which was not the same as the function code above, but more like this.</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb2-1"><span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">```{r}</span></span>
<span id="cb2-2">  output<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>BPlot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">renderPlot</span>({ </span>
<span id="cb2-3">    </span>
<span id="cb2-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(chembl, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Max Phase</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, .data[[input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>variable]])) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-5">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut_width</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Max Phase</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>), </span>
<span id="cb2-6">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Max Phase</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outlier.alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-7">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distributions of physicochemical properties against max phases"</span>,</span>
<span id="cb2-8">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"(based on ChEMBL database version 31)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-9">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span>
<span id="cb2-10">    </span>
<span id="cb2-11">    }, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">res =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">96</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bindCache</span>(chembl<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Max Phase</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>variable)</span>
<span id="cb2-12"><span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">```</span></span></code></pre></div>
<p>I then read about the section on “Tidy evaluation” in the “Mastering Shiny” book, which had thoroughly described the problems I’ve encountered (and which I wished I had actually read this section before and not after hitting the roadblock…). So I’d highly recommend new users to read this section and also the rest of the book if Shiny’s also new to you.</p>
<p><br></p>
</section>
<section id="final-app" class="level5">
<h5 class="anchored" data-anchor-id="final-app"><strong>Final app</strong></h5>
<p>The final app now looks like this:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jhylin.github.io/Data_in_life_blog/posts/12_Shiny_app_chembl/Final_app.jpg" class="img-fluid figure-img"></p>
<figcaption>Screenshot taken by author</figcaption>
</figure>
</div>
<p><br></p>
</section>
<section id="app-deployment" class="level5">
<h5 class="anchored" data-anchor-id="app-deployment"><strong>App deployment</strong></h5>
<p>After I got the app working, I looked into where I could deploy the app, since my main goal was to learn and share my work. At first, I went to the <a href="https://quarto.org/docs/interactive/shiny/index.html">Shiny section</a> on the Quarto website to see if it was possible to deploy the app in Quarto. However, after reading through several questions and answers in relation to Shiny apps and Quarto website, it was obvious that it was still not possible yet to deploy the app in an interactive way on Quarto websites (but it was mentioned in Posit community that this was being looked into, so I’m looking forward to the day when we can do exactly that in the future). This means that currently, there will only be an app image showing up in a Quarto document at most. I ended up choosing shinyapp.io to deploy my first Shiny app for now.</p>
<p><br></p>
</section>
<section id="about-the-boxplots" class="level5">
<h5 class="anchored" data-anchor-id="about-the-boxplots"><strong>About the boxplots</strong></h5>
<p>Since the main goal of this post is more on the process of producing a simple Shiny app for a new comer, I won’t go into the fine details to describe how these boxplots differ between different max phases. Also as a side note, I’m aware that some experts in data visualisations might not really like boxplots in general, but for my case, I’ve got molecules in different max phases where a boxplot is presented for each max phase lining up next to each other. Therefore, in a way, some relative comparisons or differences could be drawn visually in the first glance, although other graph types such as density plots or heat maps might be better options.</p>
<p>I’ll focus on the “QED Weighted” variable here, as it’s a physicochemical property that has combined several molecular features together as a score (please refer to <a href="https://jhylin.github.io/Data_in_life_blog/posts/08_ML1_Small_molecules_in_ChEMBL_database/ML1_chembl_cpds.html">this post - section: “Some exploratory data analysis”</a> for details about this QED weighted score). For all the boxplots shown when “QED Weighted” is selected from the drop-down box, max phase 4 molecules obviously have higher QED weighted scores in general than all of the other max phases. This is especially clear when comparing the medians between them, with max phase 4 small molecules having a median QED weighted score of more than 0.5, and the rest of the other max phases had 0.5 or below. The higher the QED weighted scores, the more druglike the molecules will be, and for max phase 4 molecules, they are mostly prescription medicines that have already reached approval and are already being widely prescribed. So this makes sense as this is being reflected in the boxplots for these ChEMBL small molecules.</p>
<p><br></p>
</section>
<section id="final-words" class="level5">
<h5 class="anchored" data-anchor-id="final-words"><strong>Final words</strong></h5>
<p>Finally, I’m quite pleasantly surprised that there is also a Shiny in Python version, which has a Shinylive option to deploy Shiny app interactively in GitHub Gist and so on… I’ll most likely need to read further into this and make this as my next project. This is also a nice break from my recent machine learning projects, which I’ll try to return to once I’ve had enough fun with Shiny!</p>
<p>Thanks for reading.</p>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <category>R</category>
  <category>Shiny</category>
  <category>ChEMBL database</category>
  <category>Cheminformatics</category>
  <guid>https://jhylin.github.io/Data_in_life_blog/posts/12_Shiny_app_chembl/ShinyAppChembl.html</guid>
  <pubDate>Thu, 06 Apr 2023 12:00:00 GMT</pubDate>
</item>
<item>
  <title>Long COVID - an update</title>
  <dc:creator>Jennifer HY Lin</dc:creator>
  <link>https://jhylin.github.io/Data_in_life_blog/posts/06_Long_COVID_update/Long_COVID_update.html</link>
  <description><![CDATA[ 






<section id="background" class="level4">
<h4 class="anchored" data-anchor-id="background"><strong>Background</strong></h4>
<p>This was another update on the current long COVID saga around the world that I thought to follow up from my earlier work (details in the <a href="https://jhylin.github.io/Data-analytics-and-research-blog/posts/2.%20Long%20COVID%20data%20in%20SQL/LongCOVIDSQL.html">SQL</a> and <a href="https://jhylin.github.io/Data-analytics-and-research-blog/posts/3.%20Long%20COVID%20dashboard/TableauDashboard.html">Tableau</a> projects). This time the dataset was obtained from another journal paper, which had data collected until July 2021 (the previous paper was only until March 2021). I’ve used Python to extract a table from the PDF of the paper and also Excel to assist with data cleaning. This was followed by using R to analyse and visualise all the data.</p>
</section>
<section id="source-of-dataset" class="level4">
<h4 class="anchored" data-anchor-id="source-of-dataset"><strong>Source of dataset</strong></h4>
<p>Journal paper by Healey Q, Sheikh A, Daines L, Vasileiou E. Symptoms and signs of long COVID: A rapid review and meta-analysis. J Glob Health 2022;12:05014. <em>Creative Commons Attribution 4.0 International Public License</em></p>
</section>
<section id="data-scraping-from-pdf" class="level4">
<h4 class="anchored" data-anchor-id="data-scraping-from-pdf"><strong>Data scraping from PDF</strong></h4>
<p>The dataset was scraped from a PDF obtained via PubMed (journal paper source as shown above) by using tabula-py (<em>for details please see this post, “<a href="https://jhylin.github.io/Data_in_life_blog/posts/6.%20Long%20COVID%20update/ExtractTableFromPDF.html">Table scraping from PDF</a>”</em>). Unfortunately I had trouble installing a similar R package remotely after it was archived (tabulizer package with known issues in its GitHub repository) so I trialled tabula-py instead. It worked for scraping all the data from the target table, but the downside was that the scraped data did not inherit the original tabular format on PDF, with columns and rows all jumbled. I’ve discussed a little bit more on the likely reason for this in the blog post link above. So in short, the final scraped table was cleaned in Excel and saved as .csv file, which was then imported as shown below.</p>
</section>
<section id="data-inspection-and-wrangling" class="level4">
<h4 class="anchored" data-anchor-id="data-inspection-and-wrangling"><strong>Data inspection and wrangling</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Uncomment below if requiring installations of packages</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># install.packages("wordcloud")</span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># install.packages("RColorBrewer")</span></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># install.packages("tidytext")</span></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># install.packages("leaflet")</span></span></code></pre></div>
</div>
<p>Loading all the required libraries below. Install libraries needed as shown in code above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(knitr)</span>
<span id="cb2-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(leaflet)</span>
<span id="cb2-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidytext)</span>
<span id="cb2-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(wordcloud)</span>
<span id="cb2-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(RColorBrewer)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Full_table.csv"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
Rows: 75 Columns: 9
── Column specification
──────────────────────────────────────────────────────── Delimiter: "," chr
(5): Author (country), Hospital (%) {ICU (%)}, Comorbidities, Body syste... dbl
(2): Age (years), Follow-up time (days) lgl (2): ...8, ...9
ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
Specify the column types or set `show_col_types = FALSE` to quiet this message.
• `` -&gt; `...8`
• `` -&gt; `...9`</code></pre>
</div>
</div>
<p>Here’s a quick overview on the hospitalisation rates across all the studies from this paper.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">df_hosp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Author (country)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Hospital (%) {ICU (%)}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>)</span>
<span id="cb5-3">df_hosp</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 75 × 2
   `Author (country)` `Hospital (%) {ICU (%)}`
   &lt;chr&gt;              &lt;chr&gt;                   
 1 Bellan (Italy)     100 {12}                
 2 Bellan (Italy)     &lt;NA&gt;                    
 3 Bellan (Italy)     &lt;NA&gt;                    
 4 Bellan (Italy)     &lt;NA&gt;                    
 5 Bellan (Italy)     &lt;NA&gt;                    
 6 Bliddal (Denmark)  0                       
 7 Bliddal (Denmark)  &lt;NA&gt;                    
 8 Bliddal (Denmark)  &lt;NA&gt;                    
 9 Bliddal (Denmark)  &lt;NA&gt;                    
10 Bliddal (Denmark)  &lt;NA&gt;                    
# … with 65 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
<section id="separating-columns-and-change-column-type" class="level5">
<h5 class="anchored" data-anchor-id="separating-columns-and-change-column-type"><strong>Separating columns and change column type</strong></h5>
<p>The table column of Hospital (%) {ICU (%)} was separated into two separate columns to allow clearer differentiation between hospital and ICU rates within each study. The data type for Hospital (%) column was also changed from character to numeric so we can plot a bar graph later on (otherwise the x-axis may not be accurate or properly shown).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">df_hosp_icu <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df_hosp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-2">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># separate column into two columns</span></span>
<span id="cb7-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Hospital (%) {ICU (%)}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hospital (%)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ICU (%)"</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># change column type</span></span>
<span id="cb7-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Hospital (%)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, as.numeric))</span>
<span id="cb7-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># show the first 10 rows as example</span></span>
<span id="cb7-7">c <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(df_hosp_icu, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb7-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(c)</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Author (country)</th>
<th style="text-align: right;">Hospital (%)</th>
<th style="text-align: left;">ICU (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Bellan (Italy)</td>
<td style="text-align: right;">100</td>
<td style="text-align: left;">12</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bellan (Italy)</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bellan (Italy)</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bellan (Italy)</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bellan (Italy)</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bliddal (Denmark)</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bliddal (Denmark)</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bliddal (Denmark)</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bliddal (Denmark)</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bliddal (Denmark)</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="separating-rows" class="level5">
<h5 class="anchored" data-anchor-id="separating-rows"><strong>Separating rows</strong></h5>
<p>The listed co-morbidities for each study were separated into separate rows, rather than into columns, to avoid adding too many columns all at once.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">df_new <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate_rows</span>(Comorbidities, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", "</span>)</span>
<span id="cb8-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Show the first 10 rows as example</span></span>
<span id="cb8-4">e <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(df_new, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb8-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(e)</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 15%">
<col style="width: 8%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 10%">
<col style="width: 19%">
<col style="width: 3%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Author (country)</th>
<th style="text-align: left;">Hospital (%) {ICU (%)}</th>
<th style="text-align: right;">Age (years)</th>
<th style="text-align: left;">Comorbidities</th>
<th style="text-align: right;">Follow-up time (days)</th>
<th style="text-align: left;">Body system</th>
<th style="text-align: left;">Results</th>
<th style="text-align: left;">…8</th>
<th style="text-align: left;">…9</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Bellan (Italy)</td>
<td style="text-align: left;">100 {12}</td>
<td style="text-align: right;">61</td>
<td style="text-align: left;">41% hypertension</td>
<td style="text-align: right;">107</td>
<td style="text-align: left;">Generalised/MSK</td>
<td style="text-align: left;">5.9% myalgia, 5.9% arthralgia</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bellan (Italy)</td>
<td style="text-align: left;">100 {12}</td>
<td style="text-align: right;">61</td>
<td style="text-align: left;">15% diabetes</td>
<td style="text-align: right;">107</td>
<td style="text-align: left;">Generalised/MSK</td>
<td style="text-align: left;">5.9% myalgia, 5.9% arthralgia</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bellan (Italy)</td>
<td style="text-align: left;">100 {12}</td>
<td style="text-align: right;">61</td>
<td style="text-align: left;">11% obesity</td>
<td style="text-align: right;">107</td>
<td style="text-align: left;">Generalised/MSK</td>
<td style="text-align: left;">5.9% myalgia, 5.9% arthralgia</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bellan (Italy)</td>
<td style="text-align: left;">100 {12}</td>
<td style="text-align: right;">61</td>
<td style="text-align: left;">11% endocrine disease</td>
<td style="text-align: right;">107</td>
<td style="text-align: left;">Generalised/MSK</td>
<td style="text-align: left;">5.9% myalgia, 5.9% arthralgia</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bellan (Italy)</td>
<td style="text-align: left;">100 {12}</td>
<td style="text-align: right;">61</td>
<td style="text-align: left;">10% malignancy</td>
<td style="text-align: right;">107</td>
<td style="text-align: left;">Generalised/MSK</td>
<td style="text-align: left;">5.9% myalgia, 5.9% arthralgia</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bellan (Italy)</td>
<td style="text-align: left;">100 {12}</td>
<td style="text-align: right;">61</td>
<td style="text-align: left;">9% IHD</td>
<td style="text-align: right;">107</td>
<td style="text-align: left;">Generalised/MSK</td>
<td style="text-align: left;">5.9% myalgia, 5.9% arthralgia</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bellan (Italy)</td>
<td style="text-align: left;">100 {12}</td>
<td style="text-align: right;">61</td>
<td style="text-align: left;">8% dyslipidaemia</td>
<td style="text-align: right;">107</td>
<td style="text-align: left;">Generalised/MSK</td>
<td style="text-align: left;">5.9% myalgia, 5.9% arthralgia</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bellan (Italy)</td>
<td style="text-align: left;">100 {12}</td>
<td style="text-align: right;">61</td>
<td style="text-align: left;">7% AF</td>
<td style="text-align: right;">107</td>
<td style="text-align: left;">Generalised/MSK</td>
<td style="text-align: left;">5.9% myalgia, 5.9% arthralgia</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bellan (Italy)</td>
<td style="text-align: left;">100 {12}</td>
<td style="text-align: right;">61</td>
<td style="text-align: left;">6% COPD</td>
<td style="text-align: right;">107</td>
<td style="text-align: left;">Generalised/MSK</td>
<td style="text-align: left;">5.9% myalgia, 5.9% arthralgia</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bellan (Italy)</td>
<td style="text-align: left;">100 {12}</td>
<td style="text-align: right;">61</td>
<td style="text-align: left;">6% CKD</td>
<td style="text-align: right;">107</td>
<td style="text-align: left;">Generalised/MSK</td>
<td style="text-align: left;">5.9% myalgia, 5.9% arthralgia</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="a-frequency-count-showing-types-of-comorbidities-in-long-covid" class="level5">
<h5 class="anchored" data-anchor-id="a-frequency-count-showing-types-of-comorbidities-in-long-covid"><strong>A frequency count showing types of comorbidities in long COVID</strong></h5>
<p>I then noticed how the comorbidities for each study were listed with different percentages and to gather a quick initial overall picture of the data, I started by removing these digits and percentage symbols. Obviously since I was still quite new to R (started using R in July), I soon ran into a problem as I kept on getting stuck with not having the count() function to actually count unique elements under the co-morbidities column.</p>
<p>By looking at the magnified circle on the right in the image below, you would notice a subtle difference in spacing, so yes the culprit was the <strong>space</strong><sup>1</sup> and once it was removed, count() worked nicely as how it should be. One small downside was that it would also remove the space between the co-morbidity terms e.g.&nbsp;“liver disease” became “liverdisease”, but since it achieved the aim intended to do unique counts on all the co-morbidities, I left it as it was.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jhylin.github.io/Data_in_life_blog/posts/06_Long_COVID_update/Zoom-in shot.jpg" class="img-fluid figure-img"></p>
<figcaption>Screenshot of the extra space(s) in dataframe</figcaption>
</figure>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">df_new <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb9-2">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove % symbol, numbers and don't forget to remove spaces as well in the column! </span></span>
<span id="cb9-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Comorbidities =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_remove_all</span>(Comorbidities, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[:digit:]|[%]|[ ]"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add this line to filter out all the "NA"s</span></span>
<span id="cb9-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(Comorbidities)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb9-6">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Count the comorbidities in descending order</span></span>
<span id="cb9-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(Comorbidities, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sort =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 37 × 2
   Comorbidities     n
   &lt;chr&gt;         &lt;int&gt;
 1 diabetes         14
 2 hypertension     13
 3 IHD              10
 4 asthma            9
 5 COPD              9
 6 obesity           9
 7 CKD               6
 8 malignancy        5
 9 dyslipidaemia     4
10 liverdisease      4
# … with 27 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
<p>Now we could observe the top 3 frequency of all co-morbidities listed were: diabetes, hypertension and IHD<sup>2</sup>. These were followed by, unsurprisingly, common respiratory illnesses such as asthma, COPD<sup>3</sup>, then obesity, and also CKD<sup>4</sup>, malignancy, dyslipidaemia and so on. These would be considered as high risk factors of developing long COVID symptoms if someone had these co-morbidities present before being infected by the coronoviruses.</p>
</section>
</section>
<section id="data-visualisations" class="level4">
<h4 class="anchored" data-anchor-id="data-visualisations"><strong>Data visualisations</strong></h4>
<section id="bar-graph-for-hospitalisation-rate" class="level5">
<h5 class="anchored" data-anchor-id="bar-graph-for-hospitalisation-rate"><strong>Bar graph for hospitalisation rate</strong></h5>
<p>Then a line of code to filter out the results of “NA” under the column of Hospital (%) was added. Most of the cells with “NA” were there to fill the multiple empty row entries for other variables and not for the Hospital (%) column, therefore these “NA”s were removed in this instance. The horizontal bar graph below showed the COVID-19 hospitalisation rate for studies in different countries, presenting a very diverse results between 0% and 100% hospitalisations across all 19 cohort studies.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">df_hosp_icu <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb11-2">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># filter out all NAs</span></span>
<span id="cb11-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Hospital (%)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb11-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot the bar graph</span></span>
<span id="cb11-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Author (country)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Hospital (%)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb11-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_flip</span>()</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jhylin.github.io/Data_in_life_blog/posts/06_Long_COVID_update/Long_COVID_update_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>COVID-19 hospitalisation rate across different countries</figcaption>
</figure>
</div>
</div>
</div>
<p><em>Note</em>: two of the studies were removed from above, these studies were by Chiesa-Estomba (Italy) and Mahmud (Bangladesh), which had “Not stated” recorded under Hospital (%) {ICU (%)} column. When the Hospital (%) column was converted from character to numeric, these two rows were converted to “NA” automatically.</p>
</section>
<section id="interactive-map-for-long-covid-results" class="level5">
<h5 class="anchored" data-anchor-id="interactive-map-for-long-covid-results"><strong>Interactive map for long COVID results</strong></h5>
<section id="preparing-dataframe-for-map" class="level6">
<h6 class="anchored" data-anchor-id="preparing-dataframe-for-map"><strong>Preparing dataframe for map</strong></h6>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">df_new_a <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb12-2">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># separate Author (country) column into two columns </span></span>
<span id="cb12-3">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># note: rename country as region - needed for joining data later on</span></span>
<span id="cb12-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Author (country)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Author"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"region"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb12-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print only the columns as selected</span></span>
<span id="cb12-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">region</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, Results)</span>
<span id="cb12-7"></span>
<span id="cb12-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The study author name, Fernandez-de-Las-Penas (Spain), got separated as above</span></span>
<span id="cb12-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># so replace "de" under Country column with the actual country name of Spain</span></span>
<span id="cb12-10">df_new_a[df_new_a <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"de"</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Spain"</span> </span>
<span id="cb12-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Show first 10 rows as example</span></span>
<span id="cb12-12">d <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(df_new_a, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb12-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(d)</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 8%">
<col style="width: 91%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">region</th>
<th style="text-align: left;">Results</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">5.9% myalgia, 5.9% arthralgia</td>
</tr>
<tr class="even">
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">5.5% dyspnoea, 2.5% cough, 0.4% chest pain, 51.6% reduced DLCO, normal spirometry</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">43% PTSD symptoms</td>
</tr>
<tr class="even">
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">5% gustatory dysfunction, 4.6% olfactory dysfunction</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Italy</td>
<td style="text-align: left;">1.3% diarrhoea</td>
</tr>
<tr class="even">
<td style="text-align: left;">Denmark</td>
<td style="text-align: left;">fatigue, myalgia, arthralgia, chills, fever</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Denmark</td>
<td style="text-align: left;">dyspnoea, cough, chest pain, sputum production</td>
</tr>
<tr class="even">
<td style="text-align: left;">Denmark</td>
<td style="text-align: left;">memory issues, concentration issues, headache</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Denmark</td>
<td style="text-align: left;">olfactory dysfunction, gustatory dysfunction, sore throat, rhinorrhoea, sneezing</td>
</tr>
<tr class="even">
<td style="text-align: left;">Denmark</td>
<td style="text-align: left;">diarrhoea, anorexia, abdominal pain, nausea</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">df1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df_new_a <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb13-2">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># re-group dataframe based on region column</span></span>
<span id="cb13-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">region</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb13-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># merge all rows under Results column into one string</span></span>
<span id="cb13-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">everything</span>(), <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">toString</span>(.)))</span>
<span id="cb13-6">df1</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 2
   region     Results                                                           
   &lt;chr&gt;      &lt;chr&gt;                                                             
 1 Australia  50% fatigue, 35.7% arthralgia, 21.4% myalgia, 28.6% cough, 25% dy…
 2 Austria    24% night sweats, 0% fever, 63% abnormal chest CT: ground-glass o…
 3 Bangladesh 33% fatigue, 1.4% arthralgia, 0.6% myalgia, 8.5% cough, 7% dyspno…
 4 Belgium    25% fatigue, abnormal chest CT: 67% ground glass opacities, 44% r…
 5 China      62% abnormal chest CT: 35% fibrotic-like changes, 27% ground glas…
 6 Denmark    fatigue, myalgia, arthralgia, chills, fever, dyspnoea, cough, che…
 7 Estomba    51% olfactory dysfunction                                         
 8 France     16.8% olfactory dysfunction, 9.6% gustatory dysfunction, fatigue,…
 9 Germany    45% fatigue, 15% myalgia, 3% fever, slight pain/discomfort, 33% d…
10 Italy      5.9% myalgia, 5.9% arthralgia, 5.5% dyspnoea, 2.5% cough, 0.4% ch…
11 Spain      61.2% fatigue, 23.3% dyspnoea, 6.5% chest pain, 2.5% cough        
12 UK         fatigue, myalgia, fever, dyspnoea, cough, chest pain, headache, p…
13 USA        44.8% fatigue, 21.3% myalgia, 15.8% arthralgia, 1.1% fever, 1.1% …</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># grab the world map data from ggplot</span></span>
<span id="cb15-2">mapdata <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"world"</span>) </span>
<span id="cb15-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># view full dataset in separate tab </span></span>
<span id="cb15-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">view</span>(mapdata)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># combine mapdata dataframe (contains longitudes &amp; latitudes of each country) </span></span>
<span id="cb16-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># with df_new_a dataframe (contains country info)</span></span>
<span id="cb16-3">mapdata <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(mapdata, df1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"region"</span>)</span>
<span id="cb16-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(mapdata)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       long      lat group order region subregion Results
1 -69.89912 12.45200     1     1  Aruba      &lt;NA&gt;    &lt;NA&gt;
2 -69.89571 12.42300     1     2  Aruba      &lt;NA&gt;    &lt;NA&gt;
3 -69.94219 12.43853     1     3  Aruba      &lt;NA&gt;    &lt;NA&gt;
4 -70.00415 12.50049     1     4  Aruba      &lt;NA&gt;    &lt;NA&gt;
5 -70.06612 12.54697     1     5  Aruba      &lt;NA&gt;    &lt;NA&gt;
6 -70.05088 12.59707     1     6  Aruba      &lt;NA&gt;    &lt;NA&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># filter out all the empty or "NA" cells</span></span>
<span id="cb18-2">mapdata_new <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mapdata <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(mapdata<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Results))</span>
<span id="cb18-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(mapdata_new)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      long       lat group order    region                   subregion
1 123.5945 -12.42568   133  7115 Australia Ashmore and Cartier Islands
2 123.5952 -12.43594   133  7116 Australia Ashmore and Cartier Islands
3 123.5732 -12.43418   133  7117 Australia Ashmore and Cartier Islands
4 123.5725 -12.42393   133  7118 Australia Ashmore and Cartier Islands
5 123.5945 -12.42568   133  7119 Australia Ashmore and Cartier Islands
6 158.8788 -54.70976   139  7267 Australia            Macquarie Island
                                                                                                                                                                      Results
1 50% fatigue, 35.7% arthralgia, 21.4% myalgia, 28.6% cough, 25% dyspnoea, 3.6% chest pain, 10.7% headache, 28.6% olfactory dysfunction, 14.3% rhinorrhoea, no abdominal pain
2 50% fatigue, 35.7% arthralgia, 21.4% myalgia, 28.6% cough, 25% dyspnoea, 3.6% chest pain, 10.7% headache, 28.6% olfactory dysfunction, 14.3% rhinorrhoea, no abdominal pain
3 50% fatigue, 35.7% arthralgia, 21.4% myalgia, 28.6% cough, 25% dyspnoea, 3.6% chest pain, 10.7% headache, 28.6% olfactory dysfunction, 14.3% rhinorrhoea, no abdominal pain
4 50% fatigue, 35.7% arthralgia, 21.4% myalgia, 28.6% cough, 25% dyspnoea, 3.6% chest pain, 10.7% headache, 28.6% olfactory dysfunction, 14.3% rhinorrhoea, no abdominal pain
5 50% fatigue, 35.7% arthralgia, 21.4% myalgia, 28.6% cough, 25% dyspnoea, 3.6% chest pain, 10.7% headache, 28.6% olfactory dysfunction, 14.3% rhinorrhoea, no abdominal pain
6 50% fatigue, 35.7% arthralgia, 21.4% myalgia, 28.6% cough, 25% dyspnoea, 3.6% chest pain, 10.7% headache, 28.6% olfactory dysfunction, 14.3% rhinorrhoea, no abdominal pain</code></pre>
</div>
</div>
<p>I realised that map_data(“world”) showed all the longitudes and latitudes for subregions of each country, which might not be required for the map I wanted. So after trialling the map visualisation several times, I opted to use centroids of each country instead, to leave the map in a cleaner and easy-to-see state. Otherwise one of the maps I tested before ended up with countless blobs of circles marking the boundaries of each country, looking like a 5-year-old’s map drawing!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1">mapdata_final <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mapdata_new <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb20-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(region) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb20-3">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Using centroids of countries = means of longitudes and latitudes for each country</span></span>
<span id="cb20-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">long =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(long), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lat =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(lat))</span>
<span id="cb20-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(mapdata_final)</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">region</th>
<th style="text-align: right;">long</th>
<th style="text-align: right;">lat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Australia</td>
<td style="text-align: right;">136.998543</td>
<td style="text-align: right;">-25.18300</td>
</tr>
<tr class="even">
<td style="text-align: left;">Austria</td>
<td style="text-align: right;">13.473366</td>
<td style="text-align: right;">47.57973</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bangladesh</td>
<td style="text-align: right;">90.506118</td>
<td style="text-align: right;">23.50905</td>
</tr>
<tr class="even">
<td style="text-align: left;">Belgium</td>
<td style="text-align: right;">4.732104</td>
<td style="text-align: right;">50.59063</td>
</tr>
<tr class="odd">
<td style="text-align: left;">China</td>
<td style="text-align: right;">106.847575</td>
<td style="text-align: right;">35.08244</td>
</tr>
<tr class="even">
<td style="text-align: left;">Denmark</td>
<td style="text-align: right;">10.731255</td>
<td style="text-align: right;">55.70473</td>
</tr>
<tr class="odd">
<td style="text-align: left;">France</td>
<td style="text-align: right;">3.226979</td>
<td style="text-align: right;">46.16686</td>
</tr>
<tr class="even">
<td style="text-align: left;">Germany</td>
<td style="text-align: right;">10.401156</td>
<td style="text-align: right;">51.20461</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Italy</td>
<td style="text-align: right;">11.752853</td>
<td style="text-align: right;">42.16598</td>
</tr>
<tr class="even">
<td style="text-align: left;">Spain</td>
<td style="text-align: right;">-2.906821</td>
<td style="text-align: right;">40.67995</td>
</tr>
<tr class="odd">
<td style="text-align: left;">UK</td>
<td style="text-align: right;">-4.098750</td>
<td style="text-align: right;">55.55813</td>
</tr>
<tr class="even">
<td style="text-align: left;">USA</td>
<td style="text-align: right;">-121.625310</td>
<td style="text-align: right;">48.74333</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># join above mapdata_final with the df1 which contains countries and long COVID results</span></span>
<span id="cb21-2">df1_mapdata <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(mapdata_final, df1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"region"</span>)</span>
<span id="cb21-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(df1_mapdata)</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 96%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">region</th>
<th style="text-align: right;">long</th>
<th style="text-align: right;">lat</th>
<th style="text-align: left;">Results</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Australia</td>
<td style="text-align: right;">136.998543</td>
<td style="text-align: right;">-25.18300</td>
<td style="text-align: left;">50% fatigue, 35.7% arthralgia, 21.4% myalgia, 28.6% cough, 25% dyspnoea, 3.6% chest pain, 10.7% headache, 28.6% olfactory dysfunction, 14.3% rhinorrhoea, no abdominal pain</td>
</tr>
<tr class="even">
<td style="text-align: left;">Austria</td>
<td style="text-align: right;">13.473366</td>
<td style="text-align: right;">47.57973</td>
<td style="text-align: left;">24% night sweats, 0% fever, 63% abnormal chest CT: ground-glass opacities, reticular lesions, consolidations, bronchial dilation. 36% dyspnoea, abnormal spirometry: 22% reduced FVC, 22% reduced FEV1, normal FEV1/FVC. 21% reduced DLCO, 17% cough, 22% sleep disorders, 19% olfactory dysfunction, 9% diarrhoea/vomiting, 97% normal LVEF, 55% diastolic dysfunction on echo, 23% raised NT-proBNP, 10% pulmonary hypertension, 1% pericardial effusion, raised D-dimer, potentially raised ferritin, normal CRP, normal procalcitonin, normal IL-6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bangladesh</td>
<td style="text-align: right;">90.506118</td>
<td style="text-align: right;">23.50905</td>
<td style="text-align: left;">33% fatigue, 1.4% arthralgia, 0.6% myalgia, 8.5% cough, 7% dyspnoea, 0.8% chest pain, 3.9% circadian rhythm disorders, 3.4% headache, 2.3% sleep disturbance, 1.4% adjustment disorder, 2.3% vertigo, 2% olfactory dysfunction, 1.4% palpitation</td>
</tr>
<tr class="even">
<td style="text-align: left;">Belgium</td>
<td style="text-align: right;">4.732104</td>
<td style="text-align: right;">50.59063</td>
<td style="text-align: left;">25% fatigue, abnormal chest CT: 67% ground glass opacities, 44% reticulations, 20% fibrotic lesions/traction bronchiectasis, 7% consolidations. 46% reduced DLCO, 35% dyspnoea, 10% dry cough, 4% chest tightness, normal spirometry</td>
</tr>
<tr class="odd">
<td style="text-align: left;">China</td>
<td style="text-align: right;">106.847575</td>
<td style="text-align: right;">35.08244</td>
<td style="text-align: left;">62% abnormal chest CT: 35% fibrotic-like changes, 27% ground glass opacities/interstitial thickening, nodules/masses, interlobar pleural traction, pulmonary atelectasis and bronchiectasis. 26% reduced DLCO, 14% mild dyspnoea, 10% sputum production, 6.1% dry cough</td>
</tr>
<tr class="even">
<td style="text-align: left;">Denmark</td>
<td style="text-align: right;">10.731255</td>
<td style="text-align: right;">55.70473</td>
<td style="text-align: left;">fatigue, myalgia, arthralgia, chills, fever, dyspnoea, cough, chest pain, sputum production, memory issues, concentration issues, headache, olfactory dysfunction, gustatory dysfunction, sore throat, rhinorrhoea, sneezing, diarrhoea, anorexia, abdominal pain, nausea, red runny eyes, 63% fatigue, 35% myalgia, 53% dyspnoea, 24% cough, 20% chest pain, 12% sputum production, 45% concentration issues, 27% headache, 27% paraesthesia, 31% gustatory dysfunction, 27% olfactory dysfunction, 10% sore throat, 10% abdominal pain, 8% diarrhoea, 8% nausea, 4% anorexia</td>
</tr>
<tr class="odd">
<td style="text-align: left;">France</td>
<td style="text-align: right;">3.226979</td>
<td style="text-align: right;">46.16686</td>
<td style="text-align: left;">16.8% olfactory dysfunction, 9.6% gustatory dysfunction, fatigue, arthralgia, myalgia, dyspnoea, cough, headache, rhinorrhoea, olfactory dysfunction, gustatory dysfunction, sore throat</td>
</tr>
<tr class="even">
<td style="text-align: left;">Germany</td>
<td style="text-align: right;">10.401156</td>
<td style="text-align: right;">51.20461</td>
<td style="text-align: left;">45% fatigue, 15% myalgia, 3% fever, slight pain/discomfort, 33% dyspnoea, 33% cough. Normal spirometry, normal ABG, reduced DLCO, reduced distance on 6MWT, 18% cognitive issues, 15% headache, mild depression, subthreshold anxiety, 12% olfactory dysfunction, 12% rhinorrhoea, 9% gustatory dysfunction, 9% sore throat, 9% diarrhoea, 6% nausea, 3% abdominal pain, normal LFTs, 18% angina, normal left ventricular function, normal right ventricular function, normal cardiac biomarkers, normal FBC, normal coagulation screen, raised ferritin, potentially raised D-dimer, normal U&amp;Es, normal CRP, normal procalcitonin, normal TFTs, normal IL-6, 17% fatigue, depression, concentration issues, 27% olfactory/gustatory dysfunction, alopecia, 42.3% subjective olfactory dysfunction, 26.9% objective olfactory dysfunction (discrimination and identification issues)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Italy</td>
<td style="text-align: right;">11.752853</td>
<td style="text-align: right;">42.16598</td>
<td style="text-align: left;">5.9% myalgia, 5.9% arthralgia, 5.5% dyspnoea, 2.5% cough, 0.4% chest pain, 51.6% reduced DLCO, normal spirometry, 43% PTSD symptoms, 5% gustatory dysfunction, 4.6% olfactory dysfunction, 1.3% diarrhoea, 13.1% fatigue, 8.2% rheumatological issues, 6% dyspnoea, 2% cough, 0.8% chest pain, 9.6% neurological disorders, 4.9% psychiatric disorders, 2.7% headache, 10.4% olfactory/gustatory dysfunction, 1.5% gastrointestinal disorders, 3.7% alopecia, 3.4% cutaneous manifestations, 0.3% ocular symptoms, 21% olfactory dysfunction, 7.9% gustatory dysfunction</td>
</tr>
<tr class="even">
<td style="text-align: left;">Spain</td>
<td style="text-align: right;">-2.906821</td>
<td style="text-align: right;">40.67995</td>
<td style="text-align: left;">61.2% fatigue, 23.3% dyspnoea, 6.5% chest pain, 2.5% cough</td>
</tr>
<tr class="odd">
<td style="text-align: left;">UK</td>
<td style="text-align: right;">-4.098750</td>
<td style="text-align: right;">55.55813</td>
<td style="text-align: left;">fatigue, myalgia, fever, dyspnoea, cough, chest pain, headache, paraesthesia, numbness, concentration/ memory issues, olfactory dysfunction, sore throat, hoarse voice, tinnitus, earache, diarrhoea, abdominal pain, palpitations/tachycardia</td>
</tr>
<tr class="even">
<td style="text-align: left;">USA</td>
<td style="text-align: right;">-121.625310</td>
<td style="text-align: right;">48.74333</td>
<td style="text-align: left;">44.8% fatigue, 21.3% myalgia, 15.8% arthralgia, 1.1% fever, 1.1% ulcer, 31.7% dyspnoea, 25.1% cough, 14.8% sputum production, 12.6% headache, 8.7% cognitive issues, 9.8% gustatory dysfunction, 9.3% olfactory dysfunction, 3.8% diarrhoea, 8.2% eye irritation, 1.1% ulcer</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prepare pop up information</span></span>
<span id="cb22-2">df1_mapdata <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df1_mapdata <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb22-3">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># paste region and Results columns into popup_info and add it as a new column into dataset</span></span>
<span id="cb22-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># bold texts and add break lines by using html tags as shown</span></span>
<span id="cb22-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">popup_info =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;b&gt;"</span>,region,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;/b&gt;"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;br/&gt;"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;b&gt;"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Long COVID symptoms:"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;/b&gt;"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;br/&gt;"</span>, Results))</span>
<span id="cb22-6">df1_mapdata</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 5
   region        long   lat Results                                      popup…¹
   &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;                                        &lt;chr&gt;  
 1 Australia   137.   -25.2 50% fatigue, 35.7% arthralgia, 21.4% myalgi… &lt;b&gt; Au…
 2 Austria      13.5   47.6 24% night sweats, 0% fever, 63% abnormal ch… &lt;b&gt; Au…
 3 Bangladesh   90.5   23.5 33% fatigue, 1.4% arthralgia, 0.6% myalgia,… &lt;b&gt; Ba…
 4 Belgium       4.73  50.6 25% fatigue, abnormal chest CT: 67% ground … &lt;b&gt; Be…
 5 China       107.    35.1 62% abnormal chest CT: 35% fibrotic-like ch… &lt;b&gt; Ch…
 6 Denmark      10.7   55.7 fatigue, myalgia, arthralgia, chills, fever… &lt;b&gt; De…
 7 France        3.23  46.2 16.8% olfactory dysfunction, 9.6% gustatory… &lt;b&gt; Fr…
 8 Germany      10.4   51.2 45% fatigue, 15% myalgia, 3% fever, slight … &lt;b&gt; Ge…
 9 Italy        11.8   42.2 5.9% myalgia, 5.9% arthralgia, 5.5% dyspnoe… &lt;b&gt; It…
10 Spain        -2.91  40.7 61.2% fatigue, 23.3% dyspnoea, 6.5% chest p… &lt;b&gt; Sp…
11 UK           -4.10  55.6 fatigue, myalgia, fever, dyspnoea, cough, c… &lt;b&gt; UK…
12 USA        -122.    48.7 44.8% fatigue, 21.3% myalgia, 15.8% arthral… &lt;b&gt; US…
# … with abbreviated variable name ¹​popup_info</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">leaflet</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb24-2">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># initialising the graphics environment for map</span></span>
<span id="cb24-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">addTiles</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb24-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add circle markers to map</span></span>
<span id="cb24-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># use the df1_mapdata dataset containing countries, longitudes, latitudes and long COVID results</span></span>
<span id="cb24-6">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add data, latitudes, longitudes, radius of circles, pop up information</span></span>
<span id="cb24-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">addCircleMarkers</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df1_mapdata, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lat =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>lat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lng =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>long, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">radius =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">popup =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>popup_info)</span></code></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-6e7b029f5abdf20926fb" style="width:100%;height:464px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-6e7b029f5abdf20926fb">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addCircleMarkers","args":[[-25.1829968212449,47.5797318991493,23.5090516557296,50.5906272841377,35.082435437586,55.7047330613104,46.166861050188,51.2046085478554,42.1659824923549,40.6799529790878,55.5581316630046,48.7433333759119],[136.998543415789,13.4733656855191,90.5061180392901,4.73210363007762,106.847574829439,10.731254580837,3.22697920310042,10.4011560552557,11.7528526644143,-2.90682090616818,-4.09875010597435,-121.625310071961],3,null,null,{"interactive":true,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"#03F","fillOpacity":0.2},null,null,["<b> Australia <\/b> <br/> <b> Long COVID symptoms: <\/b> <br/> 50% fatigue, 35.7% arthralgia, 21.4% myalgia, 28.6% cough, 25% dyspnoea, 3.6% chest pain, 10.7% headache, 28.6% olfactory dysfunction, 14.3% rhinorrhoea, no abdominal pain","<b> Austria <\/b> <br/> <b> Long COVID symptoms: <\/b> <br/> 24% night sweats, 0% fever, 63% abnormal chest CT: ground-glass opacities, reticular lesions, consolidations, bronchial dilation. 36% dyspnoea, abnormal spirometry: 22% reduced FVC, 22% reduced FEV1, normal FEV1/FVC. 21% reduced DLCO, 17% cough, 22% sleep disorders, 19% olfactory dysfunction, 9% diarrhoea/vomiting, 97% normal LVEF, 55% diastolic dysfunction on echo, 23% raised NT-proBNP, 10% pulmonary hypertension, 1% pericardial effusion, raised D-dimer, potentially raised ferritin, normal CRP, normal procalcitonin, normal IL-6","<b> Bangladesh <\/b> <br/> <b> Long COVID symptoms: <\/b> <br/> 33% fatigue, 1.4% arthralgia, 0.6% myalgia, 8.5% cough, 7% dyspnoea, 0.8% chest pain, 3.9% circadian rhythm disorders, 3.4% headache, 2.3% sleep disturbance, 1.4% adjustment disorder, 2.3% vertigo, 2% olfactory dysfunction, 1.4% palpitation","<b> Belgium <\/b> <br/> <b> Long COVID symptoms: <\/b> <br/> 25% fatigue, abnormal chest CT: 67% ground glass opacities, 44% reticulations, 20% fibrotic lesions/traction bronchiectasis, 7% consolidations. 46% reduced DLCO, 35% dyspnoea, 10% dry cough, 4% chest tightness, normal spirometry","<b> China <\/b> <br/> <b> Long COVID symptoms: <\/b> <br/> 62% abnormal chest CT: 35% fibrotic-like changes, 27% ground glass opacities/interstitial thickening, nodules/masses, interlobar pleural traction, pulmonary atelectasis and bronchiectasis. 26% reduced DLCO, 14% mild dyspnoea, 10% sputum production, 6.1% dry cough","<b> Denmark <\/b> <br/> <b> Long COVID symptoms: <\/b> <br/> fatigue, myalgia, arthralgia, chills, fever, dyspnoea, cough, chest pain, sputum production, memory issues, concentration issues, headache, olfactory dysfunction, gustatory dysfunction, sore throat, rhinorrhoea, sneezing, diarrhoea, anorexia, abdominal pain, nausea, red runny eyes, 63% fatigue, 35% myalgia, 53% dyspnoea, 24% cough, 20% chest pain, 12% sputum production, 45% concentration issues, 27% headache, 27% paraesthesia, 31% gustatory dysfunction, 27% olfactory dysfunction, 10% sore throat, 10% abdominal pain, 8% diarrhoea, 8% nausea, 4% anorexia","<b> France <\/b> <br/> <b> Long COVID symptoms: <\/b> <br/> 16.8% olfactory dysfunction, 9.6% gustatory dysfunction, fatigue, arthralgia, myalgia, dyspnoea, cough, headache, rhinorrhoea, olfactory dysfunction, gustatory dysfunction, sore throat","<b> Germany <\/b> <br/> <b> Long COVID symptoms: <\/b> <br/> 45% fatigue, 15% myalgia, 3% fever, slight pain/discomfort, 33% dyspnoea, 33% cough. Normal spirometry, normal ABG, reduced DLCO, reduced distance on 6MWT, 18% cognitive issues, 15% headache, mild depression, subthreshold anxiety, 12% olfactory dysfunction, 12% rhinorrhoea, 9% gustatory dysfunction, 9% sore throat, 9% diarrhoea, 6% nausea, 3% abdominal pain, normal LFTs, 18% angina, normal left ventricular function, normal right ventricular function, normal cardiac biomarkers, normal FBC, normal coagulation screen, raised ferritin, potentially raised D-dimer, normal U&Es, normal CRP, normal procalcitonin, normal TFTs, normal IL-6, 17% fatigue, depression, concentration issues, 27% olfactory/gustatory dysfunction, alopecia, 42.3% subjective olfactory dysfunction, 26.9% objective olfactory  dysfunction (discrimination and identification issues)","<b> Italy <\/b> <br/> <b> Long COVID symptoms: <\/b> <br/> 5.9% myalgia, 5.9% arthralgia, 5.5% dyspnoea, 2.5% cough, 0.4% chest pain, 51.6% reduced DLCO, normal spirometry, 43% PTSD symptoms, 5% gustatory dysfunction, 4.6% olfactory dysfunction, 1.3% diarrhoea, 13.1% fatigue, 8.2% rheumatological issues, 6% dyspnoea, 2% cough, 0.8% chest pain, 9.6% neurological disorders, 4.9% psychiatric disorders, 2.7% headache, 10.4% olfactory/gustatory dysfunction, 1.5% gastrointestinal disorders, 3.7% alopecia, 3.4% cutaneous manifestations, 0.3% ocular symptoms, 21% olfactory dysfunction, 7.9% gustatory dysfunction","<b> Spain <\/b> <br/> <b> Long COVID symptoms: <\/b> <br/> 61.2% fatigue, 23.3% dyspnoea, 6.5% chest pain, 2.5% cough","<b> UK <\/b> <br/> <b> Long COVID symptoms: <\/b> <br/> fatigue, myalgia, fever, dyspnoea, cough, chest pain, headache, paraesthesia, numbness, concentration/ memory issues, olfactory dysfunction, sore throat, hoarse voice, tinnitus, earache, diarrhoea, abdominal pain, palpitations/tachycardia","<b> USA <\/b> <br/> <b> Long COVID symptoms: <\/b> <br/> 44.8% fatigue, 21.3% myalgia, 15.8% arthralgia, 1.1% fever, 1.1% ulcer, 31.7% dyspnoea, 25.1% cough, 14.8% sputum production, 12.6% headache, 8.7% cognitive issues, 9.8% gustatory dysfunction, 9.3% olfactory dysfunction, 3.8% diarrhoea, 8.2% eye irritation, 1.1% ulcer"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[-25.1829968212449,55.7047330613104],"lng":[-121.625310071961,136.998543415789]}},"evals":[],"jsHooks":[]}</script>
<p>Interactive map for long COVID symptoms</p>
</div>
</div>
<p><em>ABG = arterial blood gas, CT = computed tomography, CRP = c-reactive protein, DLCO = diffusing capacity for carbon monoxide, FBC = full blood count, FEV1 = forced expiratory volume in one second, FVC = forced vital capacity, IL-6 = interleukin-6, LFT = liver function test, LVEF = left ventricular ejection fraction, NT-proBNP = N-terminal pro B-type natriuretic peptide, PTSD = posttraumatic stress disorder, 6MWT = 6-min walk test, U&amp;E = urea and electrolyte, TFT = thyroid function test</em></p>
</section>
</section>
<section id="text-mining-for-word-cloud" class="level5">
<h5 class="anchored" data-anchor-id="text-mining-for-word-cloud"><strong>Text mining for word cloud</strong></h5>
<p>When skimming through the Results column, it appeared some of the terms recorded were repetitive, so a wordcloud might be another interesting way to see if it could highlight any particular long COVID symptoms from this meta-analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Select the results column</span></span>
<span id="cb25-2">text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Results</span>
<span id="cb25-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove numbers from the texts so that the digits won't appear in the wordcloud</span></span>
<span id="cb25-4">text1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace_all</span>(text, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[:digit:]"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb25-5">text1</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] ".% myalgia, .% arthralgia"                                                                                                                                                                                                                                
 [2] ".% dyspnoea, .% cough, .% chest pain, .% reduced DLCO, normal spirometry"                                                                                                                                                                                 
 [3] "% PTSD symptoms"                                                                                                                                                                                                                                          
 [4] "% gustatory dysfunction, .% olfactory dysfunction"                                                                                                                                                                                                        
 [5] ".% diarrhoea"                                                                                                                                                                                                                                             
 [6] "fatigue, myalgia, arthralgia, chills, fever"                                                                                                                                                                                                              
 [7] "dyspnoea, cough, chest pain, sputum production"                                                                                                                                                                                                           
 [8] "memory issues, concentration issues, headache"                                                                                                                                                                                                            
 [9] "olfactory dysfunction, gustatory dysfunction, sore throat, rhinorrhoea, sneezing"                                                                                                                                                                         
[10] "diarrhoea, anorexia, abdominal pain, nausea"                                                                                                                                                                                                              
[11] "red runny eyes"                                                                                                                                                                                                                                           
[12] "% olfactory dysfunction"                                                                                                                                                                                                                                  
[13] ".% olfactory dysfunction, .% gustatory dysfunction"                                                                                                                                                                                                       
[14] "% fatigue, % myalgia, % fever, slight pain/discomfort"                                                                                                                                                                                                    
[15] "% dyspnoea, % cough. Normal spirometry, normal ABG, reduced DLCO, reduced distance on MWT"                                                                                                                                                                
[16] "% cognitive issues, % headache, mild depression, subthreshold anxiety"                                                                                                                                                                                    
[17] "% olfactory dysfunction, % rhinorrhoea, % gustatory dysfunction, % sore throat"                                                                                                                                                                           
[18] "% diarrhoea, % nausea, % abdominal pain, normal LFTs"                                                                                                                                                                                                     
[19] "% angina, normal left ventricular function, normal right ventricular function, normal cardiac biomarkers"                                                                                                                                                 
[20] "normal FBC, normal coagulation screen, raised ferritin, potentially raised D-dimer, normal U&amp;Es, normal CRP, normal procalcitonin, normal TFTs, normal IL-"                                                                                               
[21] ".% fatigue"                                                                                                                                                                                                                                               
[22] ".% dyspnoea, .% chest pain, .% cough"                                                                                                                                                                                                                     
[23] "% fatigue"                                                                                                                                                                                                                                                
[24] "abnormal chest CT: % ground glass opacities, % reticulations, % fibrotic lesions/traction bronchiectasis, % consolidations. % reduced DLCO, % dyspnoea, % dry cough, % chest tightness, normal spirometry"                                                
[25] "% fatigue"                                                                                                                                                                                                                                                
[26] "depression, concentration issues"                                                                                                                                                                                                                         
[27] "% olfactory/gustatory dysfunction"                                                                                                                                                                                                                        
[28] "alopecia"                                                                                                                                                                                                                                                 
[29] "fatigue, arthralgia, myalgia"                                                                                                                                                                                                                             
[30] "dyspnoea, cough"                                                                                                                                                                                                                                          
[31] "headache"                                                                                                                                                                                                                                                 
[32] "rhinorrhoea, olfactory dysfunction, gustatory dysfunction, sore throat"                                                                                                                                                                                   
[33] "% abnormal chest CT: % fibrotic-like changes, % ground glass opacities/interstitial thickening, nodules/masses, interlobar pleural traction, pulmonary atelectasis and bronchiectasis. % reduced DLCO, % mild dyspnoea, % sputum production, .% dry cough"
[34] "% fatigue, .% arthralgia, .% myalgia"                                                                                                                                                                                                                     
[35] ".% cough, % dyspnoea, .% chest pain"                                                                                                                                                                                                                      
[36] ".% headache"                                                                                                                                                                                                                                              
[37] ".% olfactory dysfunction, .% rhinorrhoea"                                                                                                                                                                                                                 
[38] "no abdominal pain"                                                                                                                                                                                                                                        
[39] ".% fatigue, .% myalgia, .% arthralgia, .% fever, .% ulcer"                                                                                                                                                                                                
[40] ".% dyspnoea, .% cough, .% sputum production"                                                                                                                                                                                                              
[41] ".% headache, .% cognitive issues"                                                                                                                                                                                                                         
[42] ".% gustatory dysfunction, .% olfactory dysfunction"                                                                                                                                                                                                       
[43] ".% diarrhoea"                                                                                                                                                                                                                                             
[44] ".% eye irritation, .% ulcer"                                                                                                                                                                                                                              
[45] "% fatigue, % myalgia"                                                                                                                                                                                                                                     
[46] "% dyspnoea, % cough, % chest pain, % sputum production"                                                                                                                                                                                                   
[47] "% concentration issues, % headache, % paraesthesia"                                                                                                                                                                                                       
[48] "% gustatory dysfunction, % olfactory dysfunction, % sore throat"                                                                                                                                                                                          
[49] "% abdominal pain, % diarrhoea, % nausea, % anorexia"                                                                                                                                                                                                      
[50] "% fatigue, .% arthralgia, .% myalgia"                                                                                                                                                                                                                     
[51] ".% cough, % dyspnoea, .% chest pain"                                                                                                                                                                                                                      
[52] ".% circadian rhythm disorders, .% headache, .% sleep disturbance, .% adjustment disorder"                                                                                                                                                                 
[53] ".% vertigo, % olfactory dysfunction"                                                                                                                                                                                                                      
[54] ".% palpitation"                                                                                                                                                                                                                                           
[55] ".% subjective olfactory dysfunction, .% objective olfactory  dysfunction (discrimination and identification issues)"                                                                                                                                      
[56] ".% fatigue, .% rheumatological issues"                                                                                                                                                                                                                    
[57] "% dyspnoea, % cough, .% chest pain"                                                                                                                                                                                                                       
[58] ".% neurological disorders, .% psychiatric disorders, .% headache"                                                                                                                                                                                         
[59] ".% olfactory/gustatory dysfunction"                                                                                                                                                                                                                       
[60] ".% gastrointestinal disorders"                                                                                                                                                                                                                            
[61] ".% alopecia, .% cutaneous manifestations, .% ocular symptoms"                                                                                                                                                                                             
[62] "% night sweats, % fever"                                                                                                                                                                                                                                  
[63] "% abnormal chest CT: ground-glass opacities, reticular lesions, consolidations, bronchial dilation. % dyspnoea, abnormal spirometry: % reduced FVC, % reduced FEV, normal FEV/FVC. % reduced DLCO, % cough"                                               
[64] "% sleep disorders"                                                                                                                                                                                                                                        
[65] "% olfactory dysfunction"                                                                                                                                                                                                                                  
[66] "% diarrhoea/vomiting"                                                                                                                                                                                                                                     
[67] "% normal LVEF, % diastolic dysfunction on echo, % raised NT-proBNP, % pulmonary hypertension, % pericardial effusion"                                                                                                                                     
[68] "raised D-dimer, potentially raised ferritin, normal CRP, normal procalcitonin, normal IL-"                                                                                                                                                                
[69] "fatigue, myalgia, fever"                                                                                                                                                                                                                                  
[70] "dyspnoea, cough, chest pain"                                                                                                                                                                                                                              
[71] "headache, paraesthesia, numbness, concentration/ memory issues"                                                                                                                                                                                           
[72] "olfactory dysfunction, sore throat, hoarse voice, tinnitus, earache"                                                                                                                                                                                      
[73] "diarrhoea, abdominal pain"                                                                                                                                                                                                                                
[74] "palpitations/tachycardia"                                                                                                                                                                                                                                 
[75] "% olfactory dysfunction, .% gustatory dysfunction"                                                                                                                                                                                                        </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Change the text into a tibble</span></span>
<span id="cb27-2">text_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">line =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> text1)</span>
<span id="cb27-3">text_df</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 75 × 2
    line text                                                                   
   &lt;int&gt; &lt;chr&gt;                                                                  
 1     1 .% myalgia, .% arthralgia                                              
 2     2 .% dyspnoea, .% cough, .% chest pain, .% reduced DLCO, normal spiromet…
 3     3 % PTSD symptoms                                                        
 4     4 % gustatory dysfunction, .% olfactory dysfunction                      
 5     5 .% diarrhoea                                                           
 6     6 fatigue, myalgia, arthralgia, chills, fever                            
 7     7 dyspnoea, cough, chest pain, sputum production                         
 8     8 memory issues, concentration issues, headache                          
 9     9 olfactory dysfunction, gustatory dysfunction, sore throat, rhinorrhoea…
10    10 diarrhoea, anorexia, abdominal pain, nausea                            
# … with 65 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tokenise the texts in the selected column</span></span>
<span id="cb29-2">text_df1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> text_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb29-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unnest_tokens</span>(word, text)</span>
<span id="cb29-4">text_df1</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 399 × 2
    line word      
   &lt;int&gt; &lt;chr&gt;     
 1     1 myalgia   
 2     1 arthralgia
 3     2 dyspnoea  
 4     2 cough     
 5     2 chest     
 6     2 pain      
 7     2 reduced   
 8     2 dlco      
 9     2 normal    
10     2 spirometry
# … with 389 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1">text_df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb31-2">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove stop_words</span></span>
<span id="cb31-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anti_join</span>(stop_words) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb31-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Count the frequency of appearance of each word</span></span>
<span id="cb31-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(word) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb31-6">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Then create a wordcloud</span></span>
<span id="cb31-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">with</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wordcloud</span>(word, n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colors =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">brewer.pal</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dark2"</span>)))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://jhylin.github.io/Data_in_life_blog/posts/06_Long_COVID_update/Long_COVID_update_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># display.brewer.all to display all colour palettes if wanting to use different colours</span></span></code></pre></div>
</div>
<p>A known drawback of wordcloud was that the length of a word might influence how big it might appear in the wordcloud, so it was not completely dependent on the word frequencies in a set of texts. Nevertheless, it was one of the ways to get a rough idea about the most common terms cropping up in collected texts. This last part was more like a small exercise for me and also for anyone who might want to try this but did not where to start.</p>
</section>
</section>
<section id="summary" class="level4">
<h4 class="anchored" data-anchor-id="summary"><strong>Summary</strong></h4>
<p>Long COVID had shown a very versatile and diverse range of signs and symptoms, often resembling other known post-viral illnesses such as myalgic encephalomyelitis and chronic fatigue syndrome, the interactive map above would enable readers to see specific long COVID symptoms for selected countries. People with diabetes, hypertension and IHD might have higher risk of suffering from long COVID if they were infected with the coronoviruses. The types of co-morbidities were not limited to these three unfortunately and several other chronic illnesses mentioned above might also contribute to similar risk. The most affected body systems in long COVID were in respiratory tract, ear, nose and throat areas, musculoskeletal parts, gastrointestinal tract and last, but not the least, neuropsychiatric systems which could bring fatigue and memory/concentration issue, or more widely known as the “brain fog”. All of these outcomes also did not vary widely from earlier meta-analyses on long COVID, reiterating the wide health ramifications that COVID-19 could inflict upon global populations.</p>
<section id="acknowledgement" class="level5">
<h5 class="anchored" data-anchor-id="acknowledgement"><strong>Acknowledgement</strong></h5>
<p>I have to thank several online resources when I was trying to build the interactive map. Most notably, I’ve adapted my code based on these two useful online resources:</p>
<ol type="1">
<li><p><a href="https://www.youtube.com/watch?v=AgWgPSZ7Gp0">R tutorial: Creating Maps and mapping data with ggplot2</a> by Dr Paul Christiansen</p></li>
<li><p><a href="https://www.youtube.com/watch?v=dx3khWsUO1Y">Creating interactive maps in R</a> by A&amp;G Statworks</p></li>
</ol>
<p>I also have to thank all the package creators for all the packages used here and all the authors of the journal paper (as mentioned under “Source of dataset”) which provided the long COVID data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sessionInfo</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.2.0 (2022-04-22)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Catalina 10.15.7

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] wordcloud_2.6      RColorBrewer_1.1-3 tidytext_0.3.4     leaflet_2.1.1     
 [5] knitr_1.39         forcats_0.5.1      stringr_1.4.0      dplyr_1.0.9       
 [9] purrr_0.3.4        readr_2.1.2        tidyr_1.2.0        tibble_3.1.8      
[13] ggplot2_3.3.6      tidyverse_1.3.2   

loaded via a namespace (and not attached):
 [1] httr_1.4.3          maps_3.4.0          bit64_4.0.5        
 [4] vroom_1.6.1         jsonlite_1.8.0      modelr_0.1.8       
 [7] assertthat_0.2.1    highr_0.9           googlesheets4_1.0.0
[10] cellranger_1.1.0    yaml_2.3.5          pillar_1.8.0       
[13] backports_1.4.1     lattice_0.20-45     glue_1.6.2         
[16] digest_0.6.29       rvest_1.0.2         colorspace_2.0-3   
[19] htmltools_0.5.5     Matrix_1.4-1        pkgconfig_2.0.3    
[22] broom_1.0.0         haven_2.5.0         scales_1.2.0       
[25] tzdb_0.3.0          googledrive_2.0.0   farver_2.1.1       
[28] generics_0.1.3      ellipsis_0.3.2      withr_2.5.0        
[31] cli_3.4.1           magrittr_2.0.3      crayon_1.5.1       
[34] readxl_1.4.0        evaluate_0.15       tokenizers_0.2.1   
[37] janeaustenr_1.0.0   fs_1.5.2            fansi_1.0.3        
[40] SnowballC_0.7.0     xml2_1.3.3          tools_4.2.0        
[43] hms_1.1.1           gargle_1.2.0        lifecycle_1.0.3    
[46] munsell_0.5.0       reprex_2.0.1        compiler_4.2.0     
[49] rlang_1.1.0         grid_4.2.0          rstudioapi_0.13    
[52] htmlwidgets_1.5.4   crosstalk_1.2.0     labeling_0.4.2     
[55] rmarkdown_2.21      gtable_0.3.0        DBI_1.1.3          
[58] R6_2.5.1            lubridate_1.8.0     fastmap_1.1.0      
[61] bit_4.0.4           utf8_1.2.2          stringi_1.7.8      
[64] parallel_4.2.0      Rcpp_1.0.9          vctrs_0.4.1        
[67] dbplyr_2.2.1        tidyselect_1.1.2    xfun_0.38          </code></pre>
</div>
</div>


</section>
</section>


<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>It took probably at least half an hour to figure this out… eventually I thought to look at the column itself long enough to see if I’d missed anything… then voila!↩︎</p></li>
<li id="fn2"><p>ischaemic heart disease↩︎</p></li>
<li id="fn3"><p>chronic obstructive pulmonary disease↩︎</p></li>
<li id="fn4"><p>chronic kidney disease↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Data analytics projects</category>
  <category>R</category>
  <category>Python</category>
  <category>Long COVID</category>
  <guid>https://jhylin.github.io/Data_in_life_blog/posts/06_Long_COVID_update/Long_COVID_update.html</guid>
  <pubDate>Sun, 18 Sep 2022 12:00:00 GMT</pubDate>
</item>
<item>
  <title>Phenotypes associated with rare diseases</title>
  <dc:creator>Jennifer HY Lin</dc:creator>
  <link>https://jhylin.github.io/Data_in_life_blog/posts/05_Phenotypes_associated_with_rare_diseases/Phenotypes_rare_diseases.html</link>
  <description><![CDATA[ 






<section id="initial-data-wrangling" class="level3">
<h3 class="anchored" data-anchor-id="initial-data-wrangling"><strong>Initial data wrangling</strong></h3>
<p>This dataset was also derived and downloaded from Orphanet, as another part in the “rare diseases” series. It contained 37 columns with 112,243 rows originally, which took quite a long time to load on RStudio (or could be due to my laptop capacity…). It loaded relatively faster on Jupyter notebook from Anaconda, so I then decided to clean it up first using Python<sup>1</sup> there. Some columns were removed which reduced the total number of columns from 37 to 13, while not changing any of the rows at all. The columns were also renamed to make it easier to read.</p>
</section>
<section id="source-of-dataset" class="level3">
<h3 class="anchored" data-anchor-id="source-of-dataset"><strong>Source of dataset</strong></h3>
<p>Orphadata: Free access data from Orphanet. © INSERM 1999. Available on <a href="http://www.orphadata.org/cgi-bin/index.php">http://www.orphadata.org</a>. Data version (XML data version). Dataset (.xml file) from http://www.orphadata.org/cgi-bin/epidemio.html. Latest date of update for the dataset: 14/6/2022 (last accessed 24/7/2022). Creative Commons Attribution 4.0 International.</p>
<p><img src="https://jhylin.github.io/Data_in_life_blog/posts/05_Phenotypes_associated_with_rare_diseases/Genes.jpg" class="img-fluid"></p>
<p><em>Photo by</em> <a href="https://unsplash.com/@sangharsh_l?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Sangharsh Lohakare</a> on <a href="https://unsplash.com/s/photos/genes?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></p>
<p>The following libraries were used for the exploratory data analysis:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(lubridate)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(knitr)</span></code></pre></div>
</div>
<p>Read imported .csv file after data cleaning in Python.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rare_disease_phenotypes.csv"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 112243 Columns: 13
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (10): Disorder group, Disorder type, Diagnostic criteria, HPO frequency...
dbl   (2): HPO disorder &amp; clinical entity association count, Disorder Orphacode
dttm  (1): Validation date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>Note: HPO = human phenotype ontology</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">spec</span>(df)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>cols(
  `Disorder group` = col_character(),
  `Disorder type` = col_character(),
  `HPO disorder &amp; clinical entity association count` = col_double(),
  `Diagnostic criteria` = col_character(),
  `HPO frequency` = col_character(),
  `HPO ID` = col_character(),
  `Preferred HPO term` = col_character(),
  `Disorder name` = col_character(),
  `Disorder Orphacode` = col_double(),
  Online = col_character(),
  Source = col_character(),
  `Validation date` = col_datetime(format = ""),
  `Validation status` = col_character()
)</code></pre>
</div>
</div>
</section>
<section id="exploratory-data-analysis" class="level3">
<h3 class="anchored" data-anchor-id="exploratory-data-analysis"><strong>Exploratory data analysis</strong></h3>
<p>Since I wasn’t intending for this project<sup>2</sup> to be extremely long (as most people would likely lose interests by then), I’d like to first ask a question about the dataset, in order to keep it at a reasonably short but informative length. So, here’s the question: what are the most common rare disorders and their associated phenotypic features?</p>
<p>To answer it, let’s observe the spread of the disorder groups and types first by formulating a contingency table.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">df_type <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Disorder group</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Disorder type</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb6-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Number =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>())</span>
<span id="cb6-4">df_type</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 3
# Groups:   Disorder group [3]
   `Disorder group`    `Disorder type`                                    Number
   &lt;chr&gt;               &lt;chr&gt;                                               &lt;int&gt;
 1 Disorder            Biological anomaly                                     41
 2 Disorder            Clinical syndrome                                     661
 3 Disorder            Disease                                             57920
 4 Disorder            Malformation syndrome                               37634
 5 Disorder            Morphological anomaly                                2644
 6 Disorder            Particular clinical situation in a disease or syn…    418
 7 Group of disorders  Category                                              479
 8 Group of disorders  Clinical group                                        952
 9 Subtype of disorder Clinical subtype                                     7394
10 Subtype of disorder Etiological subtype                                  4060
11 Subtype of disorder Histopathological subtype                              40</code></pre>
</div>
</div>
<p>After a quick view on the column of “Disorder group”, it mainly provided different disorder types a group label for each, which to a certain extent, was not necessary at this early stage. So this column was removed for now from the contingency table, in order to focus solely on, “Disorder type” with the number of counts (or times it appeared in the dataset).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">df_type <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Disorder type</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Number =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>())</span>
<span id="cb8-4">df_type</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 2
   `Disorder type`                                        Number
   &lt;chr&gt;                                                   &lt;int&gt;
 1 Biological anomaly                                         41
 2 Category                                                  479
 3 Clinical group                                            952
 4 Clinical subtype                                         7394
 5 Clinical syndrome                                         661
 6 Disease                                                 57920
 7 Etiological subtype                                      4060
 8 Histopathological subtype                                  40
 9 Malformation syndrome                                   37634
10 Morphological anomaly                                    2644
11 Particular clinical situation in a disease or syndrome    418</code></pre>
</div>
</div>
<p>Then to visualise this in a graphic way, a lollypop chart was built horizontally, with different types of rare disorders on the y-axis and the number of each type on the x-axis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df_type, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Disorder type</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Number</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_segment</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Disorder type</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Disorder type</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Number</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dark blue"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dark green"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_light</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_flip</span>() </span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://jhylin.github.io/Data_in_life_blog/posts/05_Phenotypes_associated_with_rare_diseases/Phenotypes_rare_diseases_files/figure-html/lollypop chart-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Two disorder types stood out the most, with “Disease” type appeared 57,920 times and “Malformation syndrome” at 37,634 times. To understand further what each of these two disorder types were, a direct reference<sup>3</sup> was used. According to the source of the dataset:</p>
<p>The definition of “Disease” in the rare disorder context was “a disorder with homogeneous therapeutic possibilities and an identified physiopathological mechanism…”, one thing also worth noting was that this type did not include any developmental anomalies.</p>
<p>For “Malformation syndrome”, this was defined as, “A disorder resulting from a developmental anomaly involving more than one morphogenetic field. Malformative sequences and associations are included.”</p>
<p>To demonstrate this in a tabular form, with corresponding proportions of each disorder type in the dataset, the following code were used:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">df1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb11-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Disorder type</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb11-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb11-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prop =</span> n<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(n))</span>
<span id="cb11-5">df1</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 3
   `Disorder type`                                            n     prop
   &lt;chr&gt;                                                  &lt;int&gt;    &lt;dbl&gt;
 1 Biological anomaly                                        41 0.000365
 2 Category                                                 479 0.00427 
 3 Clinical group                                           952 0.00848 
 4 Clinical subtype                                        7394 0.0659  
 5 Clinical syndrome                                        661 0.00589 
 6 Disease                                                57920 0.516   
 7 Etiological subtype                                     4060 0.0362  
 8 Histopathological subtype                                 40 0.000356
 9 Malformation syndrome                                  37634 0.335   
10 Morphological anomaly                                   2644 0.0236  
11 Particular clinical situation in a disease or syndrome   418 0.00372 </code></pre>
</div>
</div>
<p>The table was then rearranged with proportions in descending order (from highest to lowest). It also showed the top two were “Disease” (51.6%) and “Malformation syndrome” (33.5%).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(prop))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 3
   `Disorder type`                                            n     prop
   &lt;chr&gt;                                                  &lt;int&gt;    &lt;dbl&gt;
 1 Disease                                                57920 0.516   
 2 Malformation syndrome                                  37634 0.335   
 3 Clinical subtype                                        7394 0.0659  
 4 Etiological subtype                                     4060 0.0362  
 5 Morphological anomaly                                   2644 0.0236  
 6 Clinical group                                           952 0.00848 
 7 Clinical syndrome                                        661 0.00589 
 8 Category                                                 479 0.00427 
 9 Particular clinical situation in a disease or syndrome   418 0.00372 
10 Biological anomaly                                        41 0.000365
11 Histopathological subtype                                 40 0.000356</code></pre>
</div>
</div>
<section id="distributions-of-hpo-frequency" class="level5">
<h5 class="anchored" data-anchor-id="distributions-of-hpo-frequency"><strong>Distributions of HPO frequency</strong></h5>
<p>This was followed by checking out the distributions of HPO frequency to see which categories had the most and least number of counts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">df_freq <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb15-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">HPO frequency</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb15-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(n))</span>
<span id="cb15-4">df_freq</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 2
  `HPO frequency`            n
  &lt;chr&gt;                  &lt;int&gt;
1 Occasional (29-5%)     41140
2 Frequent (79-30%)      37480
3 Very frequent (99-80%) 25892
4 Very rare (&lt;4-1%)       6414
5 Excluded (0%)            705
6 Obligate (100%)          610
7 &lt;NA&gt;                       2</code></pre>
</div>
</div>
<p>Results for rare disorders with obligate or 100% frequency in patient’s populations were then filtered, showing disorder type, HPO frequency and disorder name. Specifically, I wanted to find out the disorder names associated with the “Disease” disorder type with HPO frequency of “Obligate (100%)”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">df_freq_ob <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb17-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Disorder type</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Disease"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">HPO frequency</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Obligate (100%)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb17-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Disorder type</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">HPO frequency</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Disorder name</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>)</span>
<span id="cb17-4">df_freq_ob</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 404 × 3
   `Disorder type` `HPO frequency` `Disorder name`                              
   &lt;chr&gt;           &lt;chr&gt;           &lt;chr&gt;                                        
 1 Disease         Obligate (100%) Retinoblastoma                               
 2 Disease         Obligate (100%) Parathyroid carcinoma                        
 3 Disease         Obligate (100%) Pituitary carcinoma                          
 4 Disease         Obligate (100%) Familial hypocalciuric hypercalcemia         
 5 Disease         Obligate (100%) Familial hypocalciuric hypercalcemia         
 6 Disease         Obligate (100%) Ravine syndrome                              
 7 Disease         Obligate (100%) Ravine syndrome                              
 8 Disease         Obligate (100%) Interstitial granulomatous dermatitis with a…
 9 Disease         Obligate (100%) Interstitial granulomatous dermatitis with a…
10 Disease         Obligate (100%) PLIN1-related familial partial lipodystrophy 
# … with 394 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
<p>I’d then like to look into associated counts of appearance of each disorder name. When I cross-checked with the full dataset in table view, I’ve noted that the number of appearance of each disorder name is linked to the number of preferred HPO phenotype terms for each of these disorder types.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">df2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df_freq_ob <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb19-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Disorder name</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>) </span>
<span id="cb19-3">df2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(n))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 239 × 2
   `Disorder name`                                                             n
   &lt;chr&gt;                                                                   &lt;int&gt;
 1 Autosomal recessive complex spastic paraplegia due to Kennedy pathway …    10
 2 STT3A-CDG                                                                   9
 3 STT3B-CDG                                                                   9
 4 Spastic paraplegia-Paget disease of bone syndrome                           8
 5 Oculocutaneous albinism type 5                                              7
 6 PLIN1-related familial partial lipodystrophy                                7
 7 Plummer-Vinson syndrome                                                     5
 8 SSR4-CDG                                                                    5
 9 Cholesterol-ester transfer protein deficiency                               4
10 Isolated follicle stimulating hormone deficiency                            4
# … with 229 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
<p>To show this, let’s link preferred HPO terms to a disorder name such as this one, “Autosomal recessive complex spastic paraplegia due to Kennedy pathway dysfunction”, which had the “Disease” disorder type with obligate or 100% HPO frequency.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1">df_disease <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb21-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Disorder type</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Disease"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">HPO frequency</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Obligate (100%)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Disorder name</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Autosomal recessive complex spastic paraplegia due to Kennedy pathway dysfunction"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb21-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Disorder type</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">HPO frequency</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Disorder name</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Preferred HPO term</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>)</span>
<span id="cb21-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(df_disease)</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 55%">
<col style="width: 24%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Disorder type</th>
<th style="text-align: left;">HPO frequency</th>
<th style="text-align: left;">Disorder name</th>
<th style="text-align: left;">Preferred HPO term</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Disease</td>
<td style="text-align: left;">Obligate (100%)</td>
<td style="text-align: left;">Autosomal recessive complex spastic paraplegia due to Kennedy pathway dysfunction</td>
<td style="text-align: left;">Progressive spastic paraplegia</td>
</tr>
<tr class="even">
<td style="text-align: left;">Disease</td>
<td style="text-align: left;">Obligate (100%)</td>
<td style="text-align: left;">Autosomal recessive complex spastic paraplegia due to Kennedy pathway dysfunction</td>
<td style="text-align: left;">Microcephaly</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Disease</td>
<td style="text-align: left;">Obligate (100%)</td>
<td style="text-align: left;">Autosomal recessive complex spastic paraplegia due to Kennedy pathway dysfunction</td>
<td style="text-align: left;">Moderately short stature</td>
</tr>
<tr class="even">
<td style="text-align: left;">Disease</td>
<td style="text-align: left;">Obligate (100%)</td>
<td style="text-align: left;">Autosomal recessive complex spastic paraplegia due to Kennedy pathway dysfunction</td>
<td style="text-align: left;">Nasal, dysarthic speech</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Disease</td>
<td style="text-align: left;">Obligate (100%)</td>
<td style="text-align: left;">Autosomal recessive complex spastic paraplegia due to Kennedy pathway dysfunction</td>
<td style="text-align: left;">Delayed gross motor development</td>
</tr>
<tr class="even">
<td style="text-align: left;">Disease</td>
<td style="text-align: left;">Obligate (100%)</td>
<td style="text-align: left;">Autosomal recessive complex spastic paraplegia due to Kennedy pathway dysfunction</td>
<td style="text-align: left;">Progressive spasticity</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Disease</td>
<td style="text-align: left;">Obligate (100%)</td>
<td style="text-align: left;">Autosomal recessive complex spastic paraplegia due to Kennedy pathway dysfunction</td>
<td style="text-align: left;">Lower limb hyperreflexia</td>
</tr>
<tr class="even">
<td style="text-align: left;">Disease</td>
<td style="text-align: left;">Obligate (100%)</td>
<td style="text-align: left;">Autosomal recessive complex spastic paraplegia due to Kennedy pathway dysfunction</td>
<td style="text-align: left;">Ankle clonus</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Disease</td>
<td style="text-align: left;">Obligate (100%)</td>
<td style="text-align: left;">Autosomal recessive complex spastic paraplegia due to Kennedy pathway dysfunction</td>
<td style="text-align: left;">Retinal pigment epithelial mottling</td>
</tr>
<tr class="even">
<td style="text-align: left;">Disease</td>
<td style="text-align: left;">Obligate (100%)</td>
<td style="text-align: left;">Autosomal recessive complex spastic paraplegia due to Kennedy pathway dysfunction</td>
<td style="text-align: left;">Progressive spastic paraparesis</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>As shown in the dataframe above, under the column name, “Preferred HPO term”, there were a total of ten different HPO phenotype terms associated with this particular rare disease with 100% HPO frequency within the patient population for this specific type of spastic paraplegia.</p>
<p>By using similar filtering method, we could quickly narrow down any particular rare disease of interest to find out specific phenotype or clinical features, along with associated HPO phenotype frequency, for further investigations.</p>
<p>For “Malformation syndrome”, a similar search process was used to find out what was the most common phenotypes associated with it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1">df_freq_ma <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb22-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Disorder type</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Malformation syndrome"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">HPO frequency</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Obligate (100%)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Disorder type</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">HPO frequency</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Disorder name</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>)</span>
<span id="cb22-4">df_freq_ma</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 125 × 3
   `Disorder type`       `HPO frequency` `Disorder name`                  
   &lt;chr&gt;                 &lt;chr&gt;           &lt;chr&gt;                            
 1 Malformation syndrome Obligate (100%) CLAPO syndrome                   
 2 Malformation syndrome Obligate (100%) CLAPO syndrome                   
 3 Malformation syndrome Obligate (100%) Weaver-Williams syndrome         
 4 Malformation syndrome Obligate (100%) Weaver-Williams syndrome         
 5 Malformation syndrome Obligate (100%) Weaver-Williams syndrome         
 6 Malformation syndrome Obligate (100%) Weaver-Williams syndrome         
 7 Malformation syndrome Obligate (100%) Weaver-Williams syndrome         
 8 Malformation syndrome Obligate (100%) Weaver-Williams syndrome         
 9 Malformation syndrome Obligate (100%) Lethal recessive chondrodysplasia
10 Malformation syndrome Obligate (100%) Lethal recessive chondrodysplasia
# … with 115 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
<p>Count() was used to find out the number of appearance of each disorder name in descending order.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1">df3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df_freq_ma <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb24-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Disorder name</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>)</span>
<span id="cb24-3">df3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(n))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 2
   `Disorder name`                                                             n
   &lt;chr&gt;                                                                   &lt;int&gt;
 1 Hydrocephalus-obesity-hypogonadism syndrome                                12
 2 Pelviscapular dysplasia                                                    11
 3 46,XX disorder of sex development-skeletal anomalies syndrome               9
 4 X-linked microcephaly-growth retardation-prognathism-cryptorchidism sy…     9
 5 Severe intellectual disability-hypotonia-strabismus-coarse face-planov…     7
 6 Lethal recessive chondrodysplasia                                           6
 7 Weaver-Williams syndrome                                                    6
 8 SERKAL syndrome                                                             5
 9 Patent ductus arteriosus-bicuspid aortic valve-hand anomalies syndrome      4
10 46,XX gonadal dysgenesis                                                    3
# … with 30 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
<p>To show one of the examples of the most common malformation syndrome with the most associated phenotypic features (with a total of 12 different phenotypic descriptions):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1">df_mal_syn <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Disorder type</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Malformation syndrome"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">HPO frequency</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Obligate (100%)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Disorder name</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hydrocephalus-obesity-hypogonadism syndrome"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb26-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Disorder type</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">HPO frequency</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Disorder name</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Preferred HPO term</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>)</span>
<span id="cb26-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(df_mal_syn)</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 14%">
<col style="width: 38%">
<col style="width: 27%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Disorder type</th>
<th style="text-align: left;">HPO frequency</th>
<th style="text-align: left;">Disorder name</th>
<th style="text-align: left;">Preferred HPO term</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Malformation syndrome</td>
<td style="text-align: left;">Obligate (100%)</td>
<td style="text-align: left;">Hydrocephalus-obesity-hypogonadism syndrome</td>
<td style="text-align: left;">Hydrocephalus</td>
</tr>
<tr class="even">
<td style="text-align: left;">Malformation syndrome</td>
<td style="text-align: left;">Obligate (100%)</td>
<td style="text-align: left;">Hydrocephalus-obesity-hypogonadism syndrome</td>
<td style="text-align: left;">Short neck</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Malformation syndrome</td>
<td style="text-align: left;">Obligate (100%)</td>
<td style="text-align: left;">Hydrocephalus-obesity-hypogonadism syndrome</td>
<td style="text-align: left;">Gynecomastia</td>
</tr>
<tr class="even">
<td style="text-align: left;">Malformation syndrome</td>
<td style="text-align: left;">Obligate (100%)</td>
<td style="text-align: left;">Hydrocephalus-obesity-hypogonadism syndrome</td>
<td style="text-align: left;">Hypergonadotropic hypogonadism</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Malformation syndrome</td>
<td style="text-align: left;">Obligate (100%)</td>
<td style="text-align: left;">Hydrocephalus-obesity-hypogonadism syndrome</td>
<td style="text-align: left;">Intellectual disability, mild</td>
</tr>
<tr class="even">
<td style="text-align: left;">Malformation syndrome</td>
<td style="text-align: left;">Obligate (100%)</td>
<td style="text-align: left;">Hydrocephalus-obesity-hypogonadism syndrome</td>
<td style="text-align: left;">Obesity</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Malformation syndrome</td>
<td style="text-align: left;">Obligate (100%)</td>
<td style="text-align: left;">Hydrocephalus-obesity-hypogonadism syndrome</td>
<td style="text-align: left;">Mitral valve prolapse</td>
</tr>
<tr class="even">
<td style="text-align: left;">Malformation syndrome</td>
<td style="text-align: left;">Obligate (100%)</td>
<td style="text-align: left;">Hydrocephalus-obesity-hypogonadism syndrome</td>
<td style="text-align: left;">Low posterior hairline</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Malformation syndrome</td>
<td style="text-align: left;">Obligate (100%)</td>
<td style="text-align: left;">Hydrocephalus-obesity-hypogonadism syndrome</td>
<td style="text-align: left;">High, narrow palate</td>
</tr>
<tr class="even">
<td style="text-align: left;">Malformation syndrome</td>
<td style="text-align: left;">Obligate (100%)</td>
<td style="text-align: left;">Hydrocephalus-obesity-hypogonadism syndrome</td>
<td style="text-align: left;">Cubitus valgus</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Malformation syndrome</td>
<td style="text-align: left;">Obligate (100%)</td>
<td style="text-align: left;">Hydrocephalus-obesity-hypogonadism syndrome</td>
<td style="text-align: left;">Short stature</td>
</tr>
<tr class="even">
<td style="text-align: left;">Malformation syndrome</td>
<td style="text-align: left;">Obligate (100%)</td>
<td style="text-align: left;">Hydrocephalus-obesity-hypogonadism syndrome</td>
<td style="text-align: left;">Short 4th metacarpal</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="explore-rare-disease-validation-date" class="level5">
<h5 class="anchored" data-anchor-id="explore-rare-disease-validation-date"><strong>Explore rare disease validation date</strong></h5>
<p>Now, to add one more piece of work towards this exploratory data analysis, I thought to check out the Validation date column. “Validation date” in this context meant the dates when the annotations of HPO terms were made for each rare disorder, which were based on the source articles listed (as shown in the Source column).</p>
<p>Firstly, I started with the “Disease” disorder type and singled out the year component from the Validation date column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1">df_val_date <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb27-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">year</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Validation date</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">abbr =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb27-3">df_val_date</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 112,243 × 16
   Disorder gr…¹ Disor…² HPO d…³ Diagn…⁴ HPO f…⁵ HPO I…⁶ Prefe…⁷ Disor…⁸ Disor…⁹
   &lt;chr&gt;         &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt;
 1 Disorder      Disease      59 Diagno… Very f… HP:000… Pectus… Marfan…     558
 2 Disorder      Disease      59 Diagno… Very f… HP:000… Striae… Marfan…     558
 3 Disorder      Disease      59 Diagno… Very f… HP:000… Arachn… Marfan…     558
 4 Disorder      Disease      59 Diagno… Very f… HP:000… Dispro… Marfan…     558
 5 Disorder      Disease      59 Diagno… Very f… HP:000… Pes pl… Marfan…     558
 6 Disorder      Disease      59 Diagno… Very f… HP:000… Sponta… Marfan…     558
 7 Disorder      Disease      59 Diagno… Very f… HP:000… Dilata… Marfan…     558
 8 Disorder      Disease      59 Diagno… Freque… HP:000… Myopia  Marfan…     558
 9 Disorder      Disease      59 Diagno… Freque… HP:000… Dental… Marfan…     558
10 Disorder      Disease      59 Diagno… Freque… HP:000… Pectus… Marfan…     558
# … with 112,233 more rows, 7 more variables: Online &lt;chr&gt;, Source &lt;chr&gt;,
#   `Validation date` &lt;dttm&gt;, `Validation status` &lt;chr&gt;, year &lt;dbl&gt;,
#   label &lt;lgl&gt;, abbr &lt;lgl&gt;, and abbreviated variable names ¹​`Disorder group`,
#   ²​`Disorder type`, ³​`HPO disorder &amp; clinical entity association count`,
#   ⁴​`Diagnostic criteria`, ⁵​`HPO frequency`, ⁶​`HPO ID`, ⁷​`Preferred HPO term`,
#   ⁸​`Disorder name`, ⁹​`Disorder Orphacode`
# ℹ Use `print(n = ...)` to see more rows, and `colnames()` to see all variable names</code></pre>
</div>
</div>
<p>To show this in a dataframe, observations for “Disease” disorder type were shown by using a filter:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1">df_val_date_d <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df_val_date <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb29-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Disorder type</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, year) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb29-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Disorder type</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Disease"</span>)</span>
<span id="cb29-4">df_val_date_d</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 57,920 × 2
   `Disorder type`  year
   &lt;chr&gt;           &lt;dbl&gt;
 1 Disease          2016
 2 Disease          2016
 3 Disease          2016
 4 Disease          2016
 5 Disease          2016
 6 Disease          2016
 7 Disease          2016
 8 Disease          2016
 9 Disease          2016
10 Disease          2016
# … with 57,910 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
<p>Then to make it easier to visualise, the year counts were plotted in a bar graph. Interestingly, 2016 seemed to be the year for rare disorders to be annotated with the most phenotypic features (if referring back to the original dataset, each observation or row was present for a unique “Preferred HPO term” or phenotypic abnormality).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1">df_val_date_d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb31-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> year)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb31-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 49 rows containing non-finite values (stat_count).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://jhylin.github.io/Data_in_life_blog/posts/05_Phenotypes_associated_with_rare_diseases/Phenotypes_rare_diseases_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>It was also worth noting that there were 49 rows of non-finite values excluded from the bar graph above. To look into this, a count on the year column of the dataframe df_val_date_d was done, which confirmed that these were the “NA” or missing values in the validation date column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1">df_val_date_d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb33-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(year)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 2
   year     n
  &lt;dbl&gt; &lt;int&gt;
1  2015   567
2  2016 14193
3  2017  5419
4  2018  6297
5  2019 10525
6  2020  9402
7  2021 11468
8    NA    49</code></pre>
</div>
</div>
</section>
</section>
<section id="summary" class="level3">
<h3 class="anchored" data-anchor-id="summary"><strong>Summary</strong></h3>
<p>To quickly summarise key findings from this work<sup>4</sup> regarding phenotypes associated with rare diseases:</p>
<ul>
<li><strong>Autosomal recessive complex spastic paraplegia due to Kennedy pathway dysfunction</strong> was one of the most common rare diseases under the Disease disorder type with the most phenotypic abnormalities recorded, which were:</li>
</ul>
<ol type="1">
<li>progressive spastic paraplegia</li>
<li>microcephaly</li>
<li>moderately short stature</li>
<li>nasal, dysarthic speech</li>
<li>delayed gross motor development</li>
<li>progressive spasticity</li>
<li>lower limb hyperreflexia</li>
<li>ankle clonus</li>
<li>retinal pigment epithelial mottling</li>
<li>progressive spastic paraparesis</li>
</ol>
<ul>
<li>For malformation syndrome of the rare disorder type, <strong>Hydrocephalus-obesity-hypogonadism syndrome</strong> was found to be one of the most common rare diseases with the most phenotypic abnormalities recorded, which were:</li>
</ul>
<ol type="1">
<li>hydrocephalus</li>
<li>short neck</li>
<li>gynecomastia</li>
<li>hypergonadotropic hypogonadism</li>
<li>intellectual disability, mild</li>
<li>obesity</li>
<li>mitral valve prolapse</li>
<li>low posterior hairline</li>
<li>high, narrow palate</li>
<li>cubitus valgus</li>
<li>short stature</li>
<li>short 4th metacarpal</li>
</ol>
<ul>
<li>The year of 2016 had the highest number of HPO terms or phenotypic abnormalities annotated to rare disorders from specific named source articles, and on the contrary, 2015 had the lowest counts from the dataset</li>
</ul>


</section>


<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Used only for initial data cleaning stage - please see this <a href="https://github.com/jhylin/Portfolio-projects/blob/main/Phenotypes%20associated%20with%20rare%20diseases%20-%20initial%20data%20cleaning.ipynb">GitHub link</a> for details. R was used for the rest of the analysis↩︎</p></li>
<li id="fn2"><p>This work is under <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0 International License</a> if anyone is interested in exploring the dataset further↩︎</p></li>
<li id="fn3"><p>“Orphadata: Free access products description” - April 2020. http://www.orphadata.org/cgi-bin/img/PDF/OrphadataFreeAccessProductsDescription.pdf. Version 2↩︎</p></li>
<li id="fn4"><p>It’s possible to dig further into the dataset e.g.&nbsp;diagnostic criterion and perhaps even bring back some of the columns removed initially, however due to time constraints (due to being a one-person team and also I’d like to start on the COVID-19 antiviral work soon), I’ll leave some room here for the interested to work on the data↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Data analytics projects</category>
  <category>R</category>
  <category>Python</category>
  <category>Rare diseases</category>
  <guid>https://jhylin.github.io/Data_in_life_blog/posts/05_Phenotypes_associated_with_rare_diseases/Phenotypes_rare_diseases.html</guid>
  <pubDate>Mon, 01 Aug 2022 12:00:00 GMT</pubDate>
</item>
<item>
  <title>Drugs in rare diseases</title>
  <dc:creator>Jennifer HY Lin</dc:creator>
  <link>https://jhylin.github.io/Data_in_life_blog/posts/01_Drugs_in_rare_diseases/Rare_diseases_drugs.html</link>
  <description><![CDATA[ 






<section id="introduction" class="level3">
<h3 class="anchored" data-anchor-id="introduction"><strong>Introduction</strong></h3>
<p>Since it is common knowledge that it takes a very long time to discover and develop novel therpapeutic drugs. I’ve also often wondered about drugs for rare diseases and how they’re often for the minorities in the diseased populations. So here is the initial Python and R projects<sup>1</sup> about rare disease drugs by using data extracted from FDA’s <a href="https://www.accessdata.fda.gov/scripts/opdlisting/oopd/index.cfm#Search_param_field%23Search_param_field">Orphan Drug Product designation database</a>. I also have to acknowledge “<a href="https://www.data-is-plural.com">Data Is Plural</a>” website, which has inspired me to look into this dataset.</p>
<p>Unfortunately this particular dataset I’ve obtained does not contain information on incentives for pharmaceutical companies (from US’s Orphan Drug Act of 1983), which could mean that I might be able to draw some preliminary, basic or raw correlations between incentives and rare disease drug marketing approvals (this might lead to other controversial discussions about this area, which was not my initial aim for this project as I just wanted to explore a dataset on rare disease drugs at the moment).</p>
<p>The datatset was for the period from 1983 till present, for approved rare disease drugs only.</p>
</section>
<section id="python-project" class="level3">
<h3 class="anchored" data-anchor-id="python-project"><strong>Python project</strong></h3>
<p>For Python project<sup>2</sup>, there was one question in mind to answer:</p>
<p>How long did it take on average for a rare disease drug to reach marketing approval?</p>
<p><strong>Python version of the data analysis</strong>: <a href="https://github.com/jhylin/Portfolio-projects/blob/main/Rare%20disease%20drugs%20-%20approved%20only.ipynb">link</a></p>
<p><strong>Short summary of findings from this dataset using Python</strong>:</p>
<ul>
<li><p>The orphan designation for rare disease drug that had the highest counts between 1983 till present was for the treatment of multiple myeloma</p></li>
<li><p>The highest counts of final approved indication for rare disease drugs spanned across several different clinical indications – it often ended up with more indication details than the initial orphan designation phase</p></li>
<li><p>The average time required for a rare disease drug to progress from the initial designation phase to the final approval for marketing was about 1932 days (~5 years)</p></li>
<li><p>The horizontal bar graph (access from link above) showed the top ten rare disease drugs with the longest time taken to reach the market Tiopronin was the one that took the longest time of 12,215 days (~33 years)</p></li>
<li><p>The data for Tiopronin appeared to be duplicates, but note that the two were formulated differently as one of them was the enteric-coated (EC) version (marketed as delayed-release tablets under the actual trade name of “Thiola EC”, but recorded in the dataset as “Thiola” only), while the other one was the immediate-release form (Thiola)</p></li>
</ul>
<p><img src="https://jhylin.github.io/Data_in_life_blog/posts/01_Drugs_in_rare_diseases/Pills.jpg" class="img-fluid"> <em>Image: Rawpixel.com</em></p>
</section>
<section id="r-project" class="level3">
<h3 class="anchored" data-anchor-id="r-project"><strong>R project</strong></h3>
<p>For R project<sup>3</sup>, there were two questions in mind to answer:</p>
<ol type="1">
<li><p>What countries were involved in rare disease drug developments?</p></li>
<li><p>How would the time from designation to approval be displayed in timeline style for selected rare disease drugs?</p></li>
</ol>
<p><strong>R versions of the data analysis</strong>:</p>
<ul>
<li><p>base R methods via Jupyter notebook with <a href="https://github.com/jhylin/Portfolio-projects/blob/main/Rare%20disease%20drugs%20(base%20R%20methods).ipynb">link</a></p></li>
<li><p>Tidyverse version via RStudio with <a href="https://github.com/jhylin/Portfolio-projects/blob/main/Rare_diseases_drugs_RStudio.md">link</a> - done using RMarkdown</p></li>
</ul>
<p><strong>Short summary of findings from this dataset using R</strong>:</p>
<ul>
<li><p>US was the country that had the most involvement in rare disease drug developments, which was followed by Ireland and the UK, and also a number of other countries</p></li>
<li><p>More work could possibly go into looking at the duplicates of brand names of the same generic drug e.g.&nbsp;cannabidiol with trade name as Epidiolex that had 5 repeated timelines (shown in link above), which appeared to be different clinical indications for each of these entries after further checks</p></li>
<li><p>The timelines have also implied that drug discovery and development is a very timely process, which could span many years, such as 10 – 20 years or more, before a drug actually reaches the market for public use</p></li>
</ul>


</section>


<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>This work is under <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0 International License</a> for anyone interested in exploring the topic further.↩︎</p></li>
<li id="fn2"><p>The published date of this project would be based on the last day I’ve worked on associated file, prior to the blog move↩︎</p></li>
<li id="fn3"><p>The R versions, base R and Tidyverse projects, were done after the Python one was completed↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Data analytics projects</category>
  <category>R</category>
  <category>Python</category>
  <category>Rare diseases</category>
  <guid>https://jhylin.github.io/Data_in_life_blog/posts/01_Drugs_in_rare_diseases/Rare_diseases_drugs.html</guid>
  <pubDate>Fri, 27 May 2022 12:00:00 GMT</pubDate>
</item>
</channel>
</rss>
