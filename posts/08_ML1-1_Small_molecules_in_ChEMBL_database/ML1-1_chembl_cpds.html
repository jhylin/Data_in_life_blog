<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jennifer HY Lin">
<meta name="dcterms.date" content="2023-01-04">

<title>Small molecules in ChEMBL database (old) – Home</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-8ef56b68f8fa1e9d2ba328e99e439f80.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-6bdd2aebeb936dcddaa5f935a5de481c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-ccd81253fefb92e9cd3f9eb5b5d87b54.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/bootstrap/bootstrap-6bdd2aebeb936dcddaa5f935a5de481c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/quarto-contrib/fontawesome6-1.2.0/all.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-1.2.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-5CHVP3K63C"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-5CHVP3K63C', { 'anonymize_ip': true});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Home</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About me</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../past_projects.html"> 
<span class="menu-text">Past projects</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jhylin"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://bsky.app/profile/jhylin.bsky.social"> 
<span class="menu-text"><i class="fa-brands fa-bluesky" aria-label="bluesky"></i></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://fosstodon.org/@jhylin"> <i class="bi bi-mastodon" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/jenhylin"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/jennifer-hy-lin-a9b86981/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://jhylin.github.io/CV_resume_quarto/"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Small molecules in ChEMBL database (old)</h1>
            <p class="subtitle lead">Series 1.1 - Polars dataframe library and machine learning in <em>scikit-learn</em></p>
                                <div class="quarto-categories">
                <div class="quarto-category">Machine learning projects</div>
                <div class="quarto-category">Scikit-learn</div>
                <div class="quarto-category">Polars</div>
                <div class="quarto-category">Python</div>
                <div class="quarto-category">Jupyter</div>
                <div class="quarto-category">ChEMBL database</div>
                <div class="quarto-category">Cheminformatics</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Jennifer HY Lin </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 4, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#machine-learning-in-drug-discovery---series-1.1" id="toc-machine-learning-in-drug-discovery---series-1.1" class="nav-link active" data-scroll-target="#machine-learning-in-drug-discovery---series-1.1"><strong><em>Machine learning in drug discovery - series 1.1</em></strong></a></li>
  <li><a href="#background" id="toc-background" class="nav-link" data-scroll-target="#background"><strong>Background</strong></a></li>
  <li><a href="#install-polars" id="toc-install-polars" class="nav-link" data-scroll-target="#install-polars"><strong>Install Polars</strong></a></li>
  <li><a href="#download-dataset" id="toc-download-dataset" class="nav-link" data-scroll-target="#download-dataset"><strong>Download dataset</strong></a></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling"><strong>Data wrangling</strong></a></li>
  <li><a href="#some-exploratory-data-analysis" id="toc-some-exploratory-data-analysis" class="nav-link" data-scroll-target="#some-exploratory-data-analysis"><strong>Some exploratory data analysis</strong></a></li>
  <li><a href="#prepare-dataframe-prior-to-running-machine-learning-model" id="toc-prepare-dataframe-prior-to-running-machine-learning-model" class="nav-link" data-scroll-target="#prepare-dataframe-prior-to-running-machine-learning-model"><strong>Prepare dataframe prior to running machine learning model</strong></a>
  <ul>
  <li><a href="#re-sampling-via-under-sampling" id="toc-re-sampling-via-under-sampling" class="nav-link" data-scroll-target="#re-sampling-via-under-sampling"><strong>Re-sampling via under-sampling</strong></a></li>
  </ul></li>
  <li><a href="#import-libraries-for-machine-learning" id="toc-import-libraries-for-machine-learning" class="nav-link" data-scroll-target="#import-libraries-for-machine-learning"><strong>Import libraries for machine learning</strong></a></li>
  <li><a href="#logistic-regression-with-scikit-learn" id="toc-logistic-regression-with-scikit-learn" class="nav-link" data-scroll-target="#logistic-regression-with-scikit-learn"><strong>Logistic regression with <em>scikit-learn</em></strong></a>
  <ul>
  <li><a href="#defining-x-and-y-variables" id="toc-defining-x-and-y-variables" class="nav-link" data-scroll-target="#defining-x-and-y-variables"><strong>Defining X and y variables</strong></a></li>
  <li><a href="#training-and-testing-sets" id="toc-training-and-testing-sets" class="nav-link" data-scroll-target="#training-and-testing-sets"><strong>Training and testing sets</strong></a></li>
  <li><a href="#preprocessing-data" id="toc-preprocessing-data" class="nav-link" data-scroll-target="#preprocessing-data"><strong>Preprocessing data</strong></a></li>
  <li><a href="#fitting-lr-classifier-on-training-set" id="toc-fitting-lr-classifier-on-training-set" class="nav-link" data-scroll-target="#fitting-lr-classifier-on-training-set"><strong>Fitting LR classifier on training set</strong></a></li>
  <li><a href="#applying-lr-classifier-on-testing-set-for-prediction" id="toc-applying-lr-classifier-on-testing-set-for-prediction" class="nav-link" data-scroll-target="#applying-lr-classifier-on-testing-set-for-prediction"><strong>Applying LR classifier on testing set for prediction</strong></a></li>
  <li><a href="#converting-predicted-values-into-a-dataframe" id="toc-converting-predicted-values-into-a-dataframe" class="nav-link" data-scroll-target="#converting-predicted-values-into-a-dataframe"><strong>Converting predicted values into a dataframe</strong></a></li>
  <li><a href="#converting-predicted-probabilities-into-a-dataframe" id="toc-converting-predicted-probabilities-into-a-dataframe" class="nav-link" data-scroll-target="#converting-predicted-probabilities-into-a-dataframe"><strong>Converting predicted probabilities into a dataframe</strong></a></li>
  <li><a href="#pipeline-method-for-lr" id="toc-pipeline-method-for-lr" class="nav-link" data-scroll-target="#pipeline-method-for-lr"><strong>Pipeline method for LR</strong></a></li>
  </ul></li>
  <li><a href="#evaluation-of-the-logistic-regression-model" id="toc-evaluation-of-the-logistic-regression-model" class="nav-link" data-scroll-target="#evaluation-of-the-logistic-regression-model"><strong>Evaluation of the logistic regression model</strong></a>
  <ul>
  <li><a href="#accuracy-scores" id="toc-accuracy-scores" class="nav-link" data-scroll-target="#accuracy-scores"><strong>Accuracy scores</strong></a></li>
  <li><a href="#confusion-matrix" id="toc-confusion-matrix" class="nav-link" data-scroll-target="#confusion-matrix"><strong>Confusion matrix</strong></a></li>
  <li><a href="#classification-report" id="toc-classification-report" class="nav-link" data-scroll-target="#classification-report"><strong>Classification report</strong></a></li>
  <li><a href="#log-loss" id="toc-log-loss" class="nav-link" data-scroll-target="#log-loss"><strong>Log loss</strong></a></li>
  </ul></li>
  <li><a href="#discussions-and-conclusion" id="toc-discussions-and-conclusion" class="nav-link" data-scroll-target="#discussions-and-conclusion"><strong>Discussions and conclusion</strong></a></li>
  <li><a href="#final-words" id="toc-final-words" class="nav-link" data-scroll-target="#final-words"><strong>Final words</strong></a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><strong>References</strong></a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jhylin/Data_in_life_blog/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">






<p>This post has been updated since October 2024 (separated into four shorter posts) using only Polars dataframe library (the older version uses both Polars and Pandas):</p>
<p>1<sup>st</sup> post - <a href="https://jhylin.github.io/Data_in_life_blog/posts/21_ML1-1_Small_mols_in_chembl_update/ML1-1-1_chembl_cpds_parquet_new.html">Parquet file in Polars dataframe library</a></p>
<p>2<sup>nd</sup> post - <a href="https://jhylin.github.io/Data_in_life_blog/posts/21_ML1-1_Small_mols_in_chembl_update/ML1-1-2_chembl_cpds_prep.html">Preprocessing data in Polars dataframe library</a></p>
<p>3<sup>rd</sup> post - <a href="https://jhylin.github.io/Data_in_life_blog/posts/21_ML1-1_Small_mols_in_chembl_update/ML1-1-3_chembl_cpds_ml_model.html">Building logistic regression model using scikit-learn</a></p>
<p>4<sup>th</sup> post - <a href="https://jhylin.github.io/Data_in_life_blog/posts/21_ML1-1_Small_mols_in_chembl_update/ML1-1-4_chembl_cpds_evaluate.html">Evaluating logistic regression model in scikit-learn</a></p>
<p><br></p>
<section id="machine-learning-in-drug-discovery---series-1.1" class="level5">
<h5 class="anchored" data-anchor-id="machine-learning-in-drug-discovery---series-1.1"><strong><em>Machine learning in drug discovery - series 1.1</em></strong></h5>
<p><br></p>
<p>*Latest update from 19th April 2024 - Polars is currently more integrated with Scikit-learn from version 1.4 (since January 2024), see this link re. <a href="https://scikit-learn.org/stable/auto_examples/release_highlights/plot_release_highlights_1_4_0.html#polars-output-in-set-output">Polars output in set_output</a> for Polars dataframe outputs in Scikit-learn, and also a few other Polars enhancements from release <a href="https://scikit-learn.org/dev/whats_new/v1.4.html#">version 1.4 changelog</a>.</p>
<p><em>Previous post update was on 16th August 2023 - some code updates only, please always refer to <a href="https://docs.pola.rs/py-polars/html/reference/index.html">Polars API reference</a> documentations for most up-to-date code.</em></p>
<p><br></p>
</section>
<section id="background" class="level5">
<h5 class="anchored" data-anchor-id="background"><strong>Background</strong></h5>
<p>As my interests gradually grew for Rust, I realised why so many people said it might be a hard programming language to learn. My head was spinning after reading the Rust programming language book and watching a few online teaching videos about it. I then decided to start from something I was more familiar with, and somehow through various online ventures and searching, I’ve managed to start two projects in parallel. The first one was where I used Polars dataframe library, and the second one would be about using Rust through an interactive user interface such as Jupyter notebook. I’ve anticipated that the second project would take much longer time for me to finish, so I would be tackling the first project for now.</p>
<p>This project was about using Polars, a blazingly fast dataframe library that was written completely in Rust with a very light Python binding that was available for use via Python or Rust, so I started using Polars via Python on Jupyter Lab initially, which involved data wrangling, some exploratory data analysis (EDA), and a reasonably larger section on using machine learning (ML) through <em>scikit-learn</em>. The editing and publishing of this post was mainly achieved via RStudio IDE.</p>
<p><br></p>
</section>
<section id="install-polars" class="level5">
<h5 class="anchored" data-anchor-id="install-polars"><strong>Install Polars</strong></h5>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To install Polars dataframe library</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Uncomment below to download and install Polars</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#!pip install polars</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Update Polars version</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Uncomment the line below to update Polars</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#!pip install --upgrade polars</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once Polars was installed, the next step was to import it for use.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show version of Polars</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Uncomment line below to check version of Polars installed/updated</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#pl.show_versions()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
</section>
<section id="download-dataset" class="level5">
<h5 class="anchored" data-anchor-id="download-dataset"><strong>Download dataset</strong></h5>
<p>The dataset, which was purely about small molecules and their physicochemical properties, was downloaded from <a href="https://www.ebi.ac.uk/chembl/">ChEMBL database</a> and saved as a .csv file. I’ve decided not to upload the “chembl_mols.csv” file due to its sheer size (around 0.6 GB), and also I’d like to stay using free open-source resources (including GitHub) at this stage. I’ve looked into the Git large file system, but for the free version it only provides 2 GB, which at this stage, I think by adding this larger than usual .csv file along with my portfolio blog repository may exceed this limit in no time.</p>
<p>For anyone who would like to use the same dataset, the file I used would be equivalent to a straight download from the home page of ChEMBL database, via clicking on the “Distinct compounds” (please see the circled area in the image below). Options were available to download the files as .csv, .tsv or .sdf formats (located at the top right of the page).</p>
<p><br></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ChEMBL_cpds.jpg" class="img-fluid figure-img"></p>
<figcaption>Image adapted from ChEMBL database website</figcaption>
</figure>
</div>
<p><br></p>
<p>Once we’ve had the file ready, it would be read via the usual read_csv() method.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pl.read_csv(<span class="st">"chembl_mols.csv"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df.head() <span class="co">#read first 5 rows</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#df #read full dataset</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 1)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">ChEMBL ID";"Name";"Synonyms";"Type";"Max Phase";"Molecular Weight";"Targets";"Bioactivities";"AlogP";"Polar Surface Area";"HBA";"HBD";"#RO5 Violations";"#Rotatable Bonds";"Passes Ro3";"QED Weighted";"CX Acidic pKa";"CX Basic pKa";"CX LogP";"CX LogD";"Aromatic Rings";"Structure Type";"Inorganic Flag";"Heavy Atoms";"HBA (Lipinski)";"HBD (Lipinski)";"#RO5 Violations (Lipinski)";"Molecular Weight (Monoisotopic)";"Molecular Species";"Molecular Formula";"Smiles";"Inchi Key</th>
</tr>
<tr class="even">
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"CHEMBL1206185;";";Small molecu…</td>
</tr>
<tr class="even">
<td>"CHEMBL539070;";";Small molecul…</td>
</tr>
<tr class="odd">
<td>"CHEMBL3335528;";";Small molecu…</td>
</tr>
<tr class="even">
<td>"CHEMBL2419030;";";Small molecu…</td>
</tr>
<tr class="odd">
<td>"CHEMBL4301448;";";Small molecu…</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="data-wrangling" class="level5">
<h5 class="anchored" data-anchor-id="data-wrangling"><strong>Data wrangling</strong></h5>
<p>Now, since this dataset was downloaded as a .csv file, this meant it was likely to have a certain delimiter between each variable. So the whole dataset was presented as strings where each string represented each compound in each row. Each variable was separated by semicolons. To read it properly, I’ve added a delimiter term in the code to transform the dataframe into a more readable format.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># By referring to Polars documentation, </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># *use "sep" to set the delimiter of the file</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># which was semicolons in this case</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># *please note this has been updated to "separator" </span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># due to updates in Polars since the published date of this post</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pl.read_csv(<span class="st">"chembl_mols.csv"</span>, separator <span class="op">=</span> <span class="st">";"</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the first 10 rows of data</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#df.head(10)</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># or full dataset</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (2_331_700, 32)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">ChEMBL ID</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Synonyms</th>
<th data-quarto-table-cell-role="th">Type</th>
<th data-quarto-table-cell-role="th">Max Phase</th>
<th data-quarto-table-cell-role="th">Molecular Weight</th>
<th data-quarto-table-cell-role="th">Targets</th>
<th data-quarto-table-cell-role="th">Bioactivities</th>
<th data-quarto-table-cell-role="th">AlogP</th>
<th data-quarto-table-cell-role="th">Polar Surface Area</th>
<th data-quarto-table-cell-role="th">HBA</th>
<th data-quarto-table-cell-role="th">HBD</th>
<th data-quarto-table-cell-role="th">#RO5 Violations</th>
<th data-quarto-table-cell-role="th">#Rotatable Bonds</th>
<th data-quarto-table-cell-role="th">Passes Ro3</th>
<th data-quarto-table-cell-role="th">QED Weighted</th>
<th data-quarto-table-cell-role="th">CX Acidic pKa</th>
<th data-quarto-table-cell-role="th">CX Basic pKa</th>
<th data-quarto-table-cell-role="th">CX LogP</th>
<th data-quarto-table-cell-role="th">CX LogD</th>
<th data-quarto-table-cell-role="th">Aromatic Rings</th>
<th data-quarto-table-cell-role="th">Structure Type</th>
<th data-quarto-table-cell-role="th">Inorganic Flag</th>
<th data-quarto-table-cell-role="th">Heavy Atoms</th>
<th data-quarto-table-cell-role="th">HBA (Lipinski)</th>
<th data-quarto-table-cell-role="th">HBD (Lipinski)</th>
<th data-quarto-table-cell-role="th">#RO5 Violations (Lipinski)</th>
<th data-quarto-table-cell-role="th">Molecular Weight (Monoisotopic)</th>
<th data-quarto-table-cell-role="th">Molecular Species</th>
<th data-quarto-table-cell-role="th">Molecular Formula</th>
<th data-quarto-table-cell-role="th">Smiles</th>
<th data-quarto-table-cell-role="th">Inchi Key</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>i64</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>i64</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"CHEMBL1206185"</td>
<td>""</td>
<td>""</td>
<td>"Small molecule"</td>
<td>0</td>
<td>"607.88"</td>
<td>""</td>
<td>""</td>
<td>"9.46"</td>
<td>"89.62"</td>
<td>"5"</td>
<td>"2"</td>
<td>"2"</td>
<td>"17"</td>
<td>"N"</td>
<td>"0.09"</td>
<td>"-1.91"</td>
<td>"8.38"</td>
<td>"9.40"</td>
<td>"9.36"</td>
<td>"3"</td>
<td>"MOL"</td>
<td>-1</td>
<td>"42"</td>
<td>"5"</td>
<td>"3"</td>
<td>"2"</td>
<td>"607.2790"</td>
<td>"ACID"</td>
<td>"C35H45NO4S2"</td>
<td>"CCCCCCCCCCC#CC(N)c1ccccc1-c1cc…</td>
<td>"UFBLKYIDZFRLPR-UHFFFAOYSA-N"</td>
</tr>
<tr class="even">
<td>"CHEMBL539070"</td>
<td>""</td>
<td>""</td>
<td>"Small molecule"</td>
<td>0</td>
<td>"286.79"</td>
<td>"1"</td>
<td>"1"</td>
<td>"2.28"</td>
<td>"73.06"</td>
<td>"6"</td>
<td>"2"</td>
<td>"0"</td>
<td>"5"</td>
<td>"N"</td>
<td>"0.63"</td>
<td>"13.84"</td>
<td>"3.64"</td>
<td>"2.57"</td>
<td>"2.57"</td>
<td>"2"</td>
<td>"MOL"</td>
<td>-1</td>
<td>"17"</td>
<td>"5"</td>
<td>"3"</td>
<td>"0"</td>
<td>"250.0888"</td>
<td>"NEUTRAL"</td>
<td>"C11H15ClN4OS"</td>
<td>"CCCOc1ccccc1-c1nnc(NN)s1.Cl"</td>
<td>"WPEWNRKLKLNLSO-UHFFFAOYSA-N"</td>
</tr>
<tr class="odd">
<td>"CHEMBL3335528"</td>
<td>""</td>
<td>""</td>
<td>"Small molecule"</td>
<td>0</td>
<td>"842.80"</td>
<td>"2"</td>
<td>"6"</td>
<td>"0.18"</td>
<td>"269.57"</td>
<td>"18"</td>
<td>"5"</td>
<td>"2"</td>
<td>"17"</td>
<td>"N"</td>
<td>"0.09"</td>
<td>"3.20"</td>
<td>"None"</td>
<td>"3.31"</td>
<td>"-0.14"</td>
<td>"3"</td>
<td>"MOL"</td>
<td>-1</td>
<td>"60"</td>
<td>"19"</td>
<td>"5"</td>
<td>"2"</td>
<td>"842.2633"</td>
<td>"ACID"</td>
<td>"C41H46O19"</td>
<td>"COC(=O)[C@H](O[C@@H]1O[C@@H](C…</td>
<td>"KGUJQZWYZPYYRZ-LWEWUKDVSA-N"</td>
</tr>
<tr class="even">
<td>"CHEMBL2419030"</td>
<td>""</td>
<td>""</td>
<td>"Small molecule"</td>
<td>0</td>
<td>"359.33"</td>
<td>"4"</td>
<td>"4"</td>
<td>"3.94"</td>
<td>"85.13"</td>
<td>"6"</td>
<td>"1"</td>
<td>"0"</td>
<td>"3"</td>
<td>"N"</td>
<td>"0.66"</td>
<td>"None"</td>
<td>"None"</td>
<td>"3.66"</td>
<td>"3.66"</td>
<td>"2"</td>
<td>"MOL"</td>
<td>-1</td>
<td>"24"</td>
<td>"6"</td>
<td>"1"</td>
<td>"0"</td>
<td>"359.0551"</td>
<td>"NEUTRAL"</td>
<td>"C14H12F3N3O3S"</td>
<td>"O=c1nc(NC2CCCC2)sc2c([N+](=O)[…</td>
<td>"QGDMYSDFCXOKML-UHFFFAOYSA-N"</td>
</tr>
<tr class="odd">
<td>"CHEMBL4301448"</td>
<td>""</td>
<td>""</td>
<td>"Small molecule"</td>
<td>0</td>
<td>"465.55"</td>
<td>""</td>
<td>""</td>
<td>"5.09"</td>
<td>"105.28"</td>
<td>"6"</td>
<td>"4"</td>
<td>"1"</td>
<td>"10"</td>
<td>"N"</td>
<td>"0.15"</td>
<td>"None"</td>
<td>"12.14"</td>
<td>"4.41"</td>
<td>"2.00"</td>
<td>"4"</td>
<td>"MOL"</td>
<td>-1</td>
<td>"33"</td>
<td>"7"</td>
<td>"5"</td>
<td>"1"</td>
<td>"465.1635"</td>
<td>"BASE"</td>
<td>"C24H24FN5O2S"</td>
<td>"N=C(N)NCCCOc1ccc(CNc2nc3ccc(Oc…</td>
<td>"RXTJPHLPHOZLFS-UHFFFAOYSA-N"</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>"CHEMBL2017916"</td>
<td>""</td>
<td>""</td>
<td>"Small molecule"</td>
<td>0</td>
<td>"312.35"</td>
<td>"3"</td>
<td>"3"</td>
<td>"2.86"</td>
<td>"77.00"</td>
<td>"6"</td>
<td>"1"</td>
<td>"0"</td>
<td>"4"</td>
<td>"N"</td>
<td>"0.80"</td>
<td>"8.13"</td>
<td>"3.49"</td>
<td>"2.17"</td>
<td>"2.10"</td>
<td>"3"</td>
<td>"MOL"</td>
<td>-1</td>
<td>"22"</td>
<td>"6"</td>
<td>"1"</td>
<td>"0"</td>
<td>"312.0681"</td>
<td>"NEUTRAL"</td>
<td>"C15H12N4O2S"</td>
<td>"COc1ccc(-c2nnc(NC(=O)c3cccnc3)…</td>
<td>"XIZUJGDKNPVNQA-UHFFFAOYSA-N"</td>
</tr>
<tr class="even">
<td>"CHEMBL374652"</td>
<td>""</td>
<td>""</td>
<td>"Small molecule"</td>
<td>0</td>
<td>"403.83"</td>
<td>"1"</td>
<td>"1"</td>
<td>"5.98"</td>
<td>"36.02"</td>
<td>"2"</td>
<td>"2"</td>
<td>"1"</td>
<td>"4"</td>
<td>"N"</td>
<td>"0.42"</td>
<td>"13.65"</td>
<td>"None"</td>
<td>"5.36"</td>
<td>"5.36"</td>
<td>"3"</td>
<td>"MOL"</td>
<td>-1</td>
<td>"26"</td>
<td>"2"</td>
<td>"2"</td>
<td>"1"</td>
<td>"403.0421"</td>
<td>"NEUTRAL"</td>
<td>"C18H14ClF4NOS"</td>
<td>"CC(O)(CSc1ccc(F)cc1)c1cc2cc(Cl…</td>
<td>"CRPQTBRTHURKII-UHFFFAOYSA-N"</td>
</tr>
<tr class="odd">
<td>"CHEMBL1416264"</td>
<td>""</td>
<td>""</td>
<td>"Small molecule"</td>
<td>0</td>
<td>"380.41"</td>
<td>"6"</td>
<td>"8"</td>
<td>"3.06"</td>
<td>"85.07"</td>
<td>"7"</td>
<td>"1"</td>
<td>"0"</td>
<td>"5"</td>
<td>"N"</td>
<td>"0.54"</td>
<td>"13.85"</td>
<td>"3.86"</td>
<td>"2.47"</td>
<td>"2.47"</td>
<td>"4"</td>
<td>"MOL"</td>
<td>-1</td>
<td>"27"</td>
<td>"7"</td>
<td>"1"</td>
<td>"0"</td>
<td>"380.0856"</td>
<td>"NEUTRAL"</td>
<td>"C18H13FN6OS"</td>
<td>"O=C(CSc1ccc2nnc(-c3cccnc3)n2n1…</td>
<td>"QVYIEKHEJKFNAT-UHFFFAOYSA-N"</td>
</tr>
<tr class="even">
<td>"CHEMBL213734"</td>
<td>""</td>
<td>""</td>
<td>"Small molecule"</td>
<td>0</td>
<td>"288.26"</td>
<td>"2"</td>
<td>"3"</td>
<td>"2.32"</td>
<td>"101.70"</td>
<td>"5"</td>
<td>"2"</td>
<td>"0"</td>
<td>"5"</td>
<td>"N"</td>
<td>"0.50"</td>
<td>"7.20"</td>
<td>"None"</td>
<td>"2.36"</td>
<td>"1.95"</td>
<td>"2"</td>
<td>"MOL"</td>
<td>-1</td>
<td>"21"</td>
<td>"7"</td>
<td>"2"</td>
<td>"0"</td>
<td>"288.0746"</td>
<td>"NEUTRAL"</td>
<td>"C14H12N2O5"</td>
<td>"O=C(COc1ccccc1)Nc1ccc([N+](=O)…</td>
<td>"PZTWAHGBGTWVEB-UHFFFAOYSA-N"</td>
</tr>
<tr class="odd">
<td>"CHEMBL1531634"</td>
<td>""</td>
<td>""</td>
<td>"Small molecule"</td>
<td>0</td>
<td>"320.16"</td>
<td>"19"</td>
<td>"21"</td>
<td>"4.40"</td>
<td>"29.10"</td>
<td>"2"</td>
<td>"1"</td>
<td>"0"</td>
<td>"4"</td>
<td>"N"</td>
<td>"0.67"</td>
<td>"None"</td>
<td>"None"</td>
<td>"4.04"</td>
<td>"4.04"</td>
<td>"2"</td>
<td>"MOL"</td>
<td>-1</td>
<td>"19"</td>
<td>"2"</td>
<td>"1"</td>
<td>"0"</td>
<td>"319.0008"</td>
<td>"NEUTRAL"</td>
<td>"C15H11BrFNO"</td>
<td>"O=C(/C=C/Nc1ccc(F)cc1)c1ccc(Br…</td>
<td>"DKPWCCDDKFLKEC-MDZDMXLPSA-N"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><br></p>
<p>Initially, I only wanted to download around 24 compounds from the ChEMBL database first. Unknowingly, I ended up downloading the whole curated set of 2,331,700 small molecules (!), and I found this out when I loaded the dataframe after setting up the delimiter for the csv file, which later led to the file size problem mentioned earlier.</p>
<p>Loading these 2,331,700 rows of data was fast, which occurred within a few seconds without exaggeration. This echoed many users’ experiences with Polars, so this was another nice surprise, and once again confirmed that Rust, and also Apache arrow, which was used as Polars’ foundation, were solid in speed.</p>
<p>Now I had the full dataframe, and I wanted to find out what types of physicochemical properties were there for the compounds.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print all column names and data types </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.glimpse())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 2331700
Columns: 32
$ ChEMBL ID                       &lt;str&gt; 'CHEMBL1206185', 'CHEMBL539070', 'CHEMBL3335528', 'CHEMBL2419030', 'CHEMBL4301448', 'CHEMBL3827271', 'CHEMBL1969944', 'CHEMBL3465961', 'CHEMBL587495', 'CHEMBL3824158'
$ Name                            &lt;str&gt; '', '', '', '', '', '', '', '', '', ''
$ Synonyms                        &lt;str&gt; '', '', '', '', '', '', '', '', '', ''
$ Type                            &lt;str&gt; 'Small molecule', 'Small molecule', 'Small molecule', 'Small molecule', 'Small molecule', 'Small molecule', 'Small molecule', 'Small molecule', 'Small molecule', 'Small molecule'
$ Max Phase                       &lt;i64&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
$ Molecular Weight                &lt;str&gt; '607.88', '286.79', '842.80', '359.33', '465.55', '712.85', '', '319.42', '478.54', '422.48'
$ Targets                         &lt;str&gt; '', '1', '2', '4', '', '1', '56', '16', '', '2'
$ Bioactivities                   &lt;str&gt; '', '1', '6', '4', '', '1', '56', '22', '', '4'
$ AlogP                           &lt;str&gt; '9.46', '2.28', '0.18', '3.94', '5.09', '-2.84', '', '2.22', '6.85', '5.09'
$ Polar Surface Area              &lt;str&gt; '89.62', '73.06', '269.57', '85.13', '105.28', '319.06', '', '50.50', '66.73', '109.54'
$ HBA                             &lt;str&gt; '5', '6', '18', '6', '6', '10', '', '4', '4', '6'
$ HBD                             &lt;str&gt; '2', '2', '5', '1', '4', '11', '', '1', '3', '2'
$ #RO5 Violations                 &lt;str&gt; '2', '0', '2', '0', '1', '2', '', '0', '1', '1'
$ #Rotatable Bonds                &lt;str&gt; '17', '5', '17', '3', '10', '16', '', '6', '6', '10'
$ Passes Ro3                      &lt;str&gt; 'N', 'N', 'N', 'N', 'N', 'N', '', 'N', 'N', 'N'
$ QED Weighted                    &lt;str&gt; '0.09', '0.63', '0.09', '0.66', '0.15', '0.07', '', '0.87', '0.23', '0.31'
$ CX Acidic pKa                   &lt;str&gt; '-1.91', '13.84', '3.20', 'None', 'None', '4.08', '', 'None', '10.67', '4.59'
$ CX Basic pKa                    &lt;str&gt; '8.38', '3.64', 'None', 'None', '12.14', '10.49', '', '9.38', '8.47', '7.99'
$ CX LogP                         &lt;str&gt; '9.40', '2.57', '3.31', '3.66', '4.41', '-6.88', '', '2.13', '6.04', '2.49'
$ CX LogD                         &lt;str&gt; '9.36', '2.57', '-0.14', '3.66', '2.00', '-8.95', '', '-0.44', '4.93', '2.42'
$ Aromatic Rings                  &lt;str&gt; '3', '2', '3', '2', '4', '0', '', '1', '5', '2'
$ Structure Type                  &lt;str&gt; 'MOL', 'MOL', 'MOL', 'MOL', 'MOL', 'MOL', 'NONE', 'MOL', 'MOL', 'MOL'
$ Inorganic Flag                  &lt;i64&gt; -1, -1, -1, -1, -1, -1, -1, -1, -1, -1
$ Heavy Atoms                     &lt;str&gt; '42', '17', '60', '24', '33', '50', '', '23', '34', '31'
$ HBA (Lipinski)                  &lt;str&gt; '5', '5', '19', '6', '7', '19', '', '4', '4', '7'
$ HBD (Lipinski)                  &lt;str&gt; '3', '3', '5', '1', '5', '14', '', '1', '4', '2'
$ #RO5 Violations (Lipinski)      &lt;str&gt; '2', '0', '2', '0', '1', '3', '', '0', '1', '1'
$ Molecular Weight (Monoisotopic) &lt;str&gt; '607.2790', '250.0888', '842.2633', '359.0551', '465.1635', '712.4232', '', '319.2060', '478.1439', '422.1842'
$ Molecular Species               &lt;str&gt; 'ACID', 'NEUTRAL', 'ACID', 'NEUTRAL', 'BASE', 'ZWITTERION', '', 'BASE', 'NEUTRAL', 'ACID'
$ Molecular Formula               &lt;str&gt; 'C35H45NO4S2', 'C11H15ClN4OS', 'C41H46O19', 'C14H12F3N3O3S', 'C24H24FN5O2S', 'C31H56N10O9', '', 'C18H26FN3O', 'C26H21F3N4S', 'C24H26N2O5'
$ Smiles                          &lt;str&gt; 'CCCCCCCCCCC#CC(N)c1ccccc1-c1ccc(Sc2ccc(OCCCC)cc2)c(S(=O)(=O)O)c1', 'CCCOc1ccccc1-c1nnc(NN)s1.Cl', 'COC(=O)[C@H](O[C@@H]1O[C@@H](C)[C@@H](O)[C@@H](O)[C@@H]1O)[C@@H](O[C@@H]1O[C@H](CO)[C@H](OC(=O)c2ccccc2)[C@H](O[C@H](Cc2ccccc2)C(=O)O)[C@H]1OC(=O)c1ccccc1)C(=O)OC', 'O=c1nc(NC2CCCC2)sc2c([N+](=O)[O-])cc(C(F)(F)F)cc12', 'N=C(N)NCCCOc1ccc(CNc2nc3ccc(Oc4ccc(F)cc4)cc3s2)cc1', 'CC(C)C[C@@H]1NC(=O)[C@H](CCCNC(N)=O)NC(=O)[C@H](CCCCN)NC(=O)[C@H](CC(=O)O)NC(=O)[C@H](CCCCN)NC(=O)CCNC1=O', '', 'CC(O)CN1CCC(CN(C)Cc2cc(C#N)ccc2F)CC1', 'Nc1cccc(CNCc2ccc(-c3ccc(-c4nc5cc(C(F)(F)F)ccc5[nH]4)s3)cc2)c1', 'CCCCCCCNC(C1=C(O)C(=O)c2ccccc2C1=O)c1ccc([N+](=O)[O-])cc1'
$ Inchi Key                       &lt;str&gt; 'UFBLKYIDZFRLPR-UHFFFAOYSA-N', 'WPEWNRKLKLNLSO-UHFFFAOYSA-N', 'KGUJQZWYZPYYRZ-LWEWUKDVSA-N', 'QGDMYSDFCXOKML-UHFFFAOYSA-N', 'RXTJPHLPHOZLFS-UHFFFAOYSA-N', 'QJQNNLICZLLPMB-VUBDRERZSA-N', '', 'FZEVYCHTADTXPM-UHFFFAOYSA-N', 'KZOHKPSNJBXTRJ-UHFFFAOYSA-N', 'AXOVDUYYBUYLPC-UHFFFAOYSA-N'

None</code></pre>
</div>
</div>
<p>There were a few terms where I wasn’t sure of their exact meanings, so I went through the ChEMBL_31 schema documentation and ChEMBL database website to find out. This took a while and was an important step to take so that I would know what to do when reaching the ML phase.</p>
<p>I have selected a few physicochemical properties down below so that readers and I could gather some reasonable understandings for each term. The explanations for each term were adapted from ChEMBL_31 schema documentation (available as “Release notes” on the website), or if definitions for certain terms were not available from the documentation, I resorted to interpret them myself by going into “Dinstict compounds” section on the ChEMBL database, where I would click on, e.g.&nbsp;bioactivities, for a random compound in there to see what results showed up and then described them below.</p>
<p>The definitions for some of the listed physicochemical properties were:</p>
<p><strong>Max Phase</strong> - Maximum phase of development reached for the compound (where 4 = approved). Null was where max phase has not yet been assigned.</p>
<p><strong>Bioactivities</strong> - Various biological assays used for the compounds e.g.&nbsp;IC<sub>50</sub>, GI<sub>50</sub>, potency tests etc.</p>
<p><strong>AlogP</strong> - Calculated partition coefficient</p>
<p><strong>HBA</strong> - Number of hydrogen bond acceptors</p>
<p><strong>HBD</strong> - Number of hydrogen bond donors</p>
<p><strong>#RO5 Violations</strong> - Number of violations of Lipinski’s rule-of-five, using HBA and HBD definitions</p>
<p><strong>Passes Ro3</strong> - Indicated whether the compound passed the rule-of-three (MW &lt; 300, logP &lt; 3 etc)</p>
<p><strong>QED Weighted</strong> - Weighted quantitative estimate of drug likeness (as defined by Bickerton <em>et al.</em>, Nature Chem 2012)</p>
<p><strong>Inorganic flag</strong> - Indicated whether the molecule was inorganic (i.e., containing only metal atoms and &lt;2 carbon atoms), where 1 = inorganic compound and -1 = not inorganic compound (assuming 0 meant it was neither case or yet to be assigned)</p>
<p><strong>Heavy Atoms</strong> - Number of heavy (non-hydrogen) atoms</p>
<p><strong>CX Acidic pKa</strong> - The most acidic pKa calculated using ChemAxon v17.29.0</p>
<p><strong>CX Basic pKa</strong> - The most basic pKa calculated using ChemAxon v17.29.0</p>
<p><strong>CX LogP</strong> - The calculated octanol/water partition coefficient using ChemAxon v17.29.0</p>
<p><strong>CX LogD</strong> - The calculated octanol/water distribution coefficient at pH = 7.4 using ChemAxon v17.29.0</p>
<p><strong>Structure Type</strong> - based on compound_structures table, where SEQ indicated an entry in the protein_therapeutics table instead, NONE indicated an entry in neither tables, e.g.&nbsp;structure unknown</p>
<p><strong>Inchi Key</strong> - the IUPAC international chemical identifier key</p>
<p>From the df.glimpse() method previously, there were a lot of columns with the data type of “Utf8”, which meant they were strings. There were only two columns that had “Int64”, which meant they were integers. A lot of these columns were actually storing numbers as strings. So to make my life easier, I went on to convert these data types into the more appropriate ones for selected columns.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert data types for multiple selected columns</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: only takes two positional arguments, </span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># so needed to use [] in code to allow more than two</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple columns all at once - with_columns()</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># *Single column - with_column() </span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># *this only worked at the time of writing the post (around published date), </span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># this is not going to work currently as Polars has been updated, </span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># please use with_columns() for single or multiple columns instead*</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Use alias if wanting to keep original data type in column, </span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co"># as it adds a new column under an alias name to dataframe</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>df_new <span class="op">=</span> df.with_columns(</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"Molecular Weight"</span>)).cast(pl.Float64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"Targets"</span>)).cast(pl.Int64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"Bioactivities"</span>)).cast(pl.Int64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"AlogP"</span>)).cast(pl.Float64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"Polar Surface Area"</span>)).cast(pl.Float64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"HBA"</span>)).cast(pl.Int64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"HBD"</span>)).cast(pl.Int64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"#RO5 Violations"</span>)).cast(pl.Int64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"#Rotatable Bonds"</span>)).cast(pl.Int64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"QED Weighted"</span>)).cast(pl.Float64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"CX Acidic pKa"</span>)).cast(pl.Float64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"CX Basic pKa"</span>)).cast(pl.Float64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"CX LogP"</span>)).cast(pl.Float64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"CX LogD"</span>)).cast(pl.Float64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"Aromatic Rings"</span>)).cast(pl.Int64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"Heavy Atoms"</span>)).cast(pl.Int64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"HBA (Lipinski)"</span>)).cast(pl.Int64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"HBD (Lipinski)"</span>)).cast(pl.Int64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"#RO5 Violations (Lipinski)"</span>)).cast(pl.Int64, strict <span class="op">=</span> <span class="va">False</span>),</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>        (pl.col(<span class="st">"Molecular Weight (Monoisotopic)"</span>)).cast(pl.Float64, strict <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>df_new.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 32)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">ChEMBL ID</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Synonyms</th>
<th data-quarto-table-cell-role="th">Type</th>
<th data-quarto-table-cell-role="th">Max Phase</th>
<th data-quarto-table-cell-role="th">Molecular Weight</th>
<th data-quarto-table-cell-role="th">Targets</th>
<th data-quarto-table-cell-role="th">Bioactivities</th>
<th data-quarto-table-cell-role="th">AlogP</th>
<th data-quarto-table-cell-role="th">Polar Surface Area</th>
<th data-quarto-table-cell-role="th">HBA</th>
<th data-quarto-table-cell-role="th">HBD</th>
<th data-quarto-table-cell-role="th">#RO5 Violations</th>
<th data-quarto-table-cell-role="th">#Rotatable Bonds</th>
<th data-quarto-table-cell-role="th">Passes Ro3</th>
<th data-quarto-table-cell-role="th">QED Weighted</th>
<th data-quarto-table-cell-role="th">CX Acidic pKa</th>
<th data-quarto-table-cell-role="th">CX Basic pKa</th>
<th data-quarto-table-cell-role="th">CX LogP</th>
<th data-quarto-table-cell-role="th">CX LogD</th>
<th data-quarto-table-cell-role="th">Aromatic Rings</th>
<th data-quarto-table-cell-role="th">Structure Type</th>
<th data-quarto-table-cell-role="th">Inorganic Flag</th>
<th data-quarto-table-cell-role="th">Heavy Atoms</th>
<th data-quarto-table-cell-role="th">HBA (Lipinski)</th>
<th data-quarto-table-cell-role="th">HBD (Lipinski)</th>
<th data-quarto-table-cell-role="th">#RO5 Violations (Lipinski)</th>
<th data-quarto-table-cell-role="th">Molecular Weight (Monoisotopic)</th>
<th data-quarto-table-cell-role="th">Molecular Species</th>
<th data-quarto-table-cell-role="th">Molecular Formula</th>
<th data-quarto-table-cell-role="th">Smiles</th>
<th data-quarto-table-cell-role="th">Inchi Key</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>i64</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>str</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"CHEMBL1206185"</td>
<td>""</td>
<td>""</td>
<td>"Small molecule"</td>
<td>0</td>
<td>607.88</td>
<td>null</td>
<td>null</td>
<td>9.46</td>
<td>89.62</td>
<td>5</td>
<td>2</td>
<td>2</td>
<td>17</td>
<td>"N"</td>
<td>0.09</td>
<td>-1.91</td>
<td>8.38</td>
<td>9.4</td>
<td>9.36</td>
<td>3</td>
<td>"MOL"</td>
<td>-1</td>
<td>42</td>
<td>5</td>
<td>3</td>
<td>2</td>
<td>607.279</td>
<td>"ACID"</td>
<td>"C35H45NO4S2"</td>
<td>"CCCCCCCCCCC#CC(N)c1ccccc1-c1cc…</td>
<td>"UFBLKYIDZFRLPR-UHFFFAOYSA-N"</td>
</tr>
<tr class="even">
<td>"CHEMBL539070"</td>
<td>""</td>
<td>""</td>
<td>"Small molecule"</td>
<td>0</td>
<td>286.79</td>
<td>1</td>
<td>1</td>
<td>2.28</td>
<td>73.06</td>
<td>6</td>
<td>2</td>
<td>0</td>
<td>5</td>
<td>"N"</td>
<td>0.63</td>
<td>13.84</td>
<td>3.64</td>
<td>2.57</td>
<td>2.57</td>
<td>2</td>
<td>"MOL"</td>
<td>-1</td>
<td>17</td>
<td>5</td>
<td>3</td>
<td>0</td>
<td>250.0888</td>
<td>"NEUTRAL"</td>
<td>"C11H15ClN4OS"</td>
<td>"CCCOc1ccccc1-c1nnc(NN)s1.Cl"</td>
<td>"WPEWNRKLKLNLSO-UHFFFAOYSA-N"</td>
</tr>
<tr class="odd">
<td>"CHEMBL3335528"</td>
<td>""</td>
<td>""</td>
<td>"Small molecule"</td>
<td>0</td>
<td>842.8</td>
<td>2</td>
<td>6</td>
<td>0.18</td>
<td>269.57</td>
<td>18</td>
<td>5</td>
<td>2</td>
<td>17</td>
<td>"N"</td>
<td>0.09</td>
<td>3.2</td>
<td>null</td>
<td>3.31</td>
<td>-0.14</td>
<td>3</td>
<td>"MOL"</td>
<td>-1</td>
<td>60</td>
<td>19</td>
<td>5</td>
<td>2</td>
<td>842.2633</td>
<td>"ACID"</td>
<td>"C41H46O19"</td>
<td>"COC(=O)[C@H](O[C@@H]1O[C@@H](C…</td>
<td>"KGUJQZWYZPYYRZ-LWEWUKDVSA-N"</td>
</tr>
<tr class="even">
<td>"CHEMBL2419030"</td>
<td>""</td>
<td>""</td>
<td>"Small molecule"</td>
<td>0</td>
<td>359.33</td>
<td>4</td>
<td>4</td>
<td>3.94</td>
<td>85.13</td>
<td>6</td>
<td>1</td>
<td>0</td>
<td>3</td>
<td>"N"</td>
<td>0.66</td>
<td>null</td>
<td>null</td>
<td>3.66</td>
<td>3.66</td>
<td>2</td>
<td>"MOL"</td>
<td>-1</td>
<td>24</td>
<td>6</td>
<td>1</td>
<td>0</td>
<td>359.0551</td>
<td>"NEUTRAL"</td>
<td>"C14H12F3N3O3S"</td>
<td>"O=c1nc(NC2CCCC2)sc2c([N+](=O)[…</td>
<td>"QGDMYSDFCXOKML-UHFFFAOYSA-N"</td>
</tr>
<tr class="odd">
<td>"CHEMBL4301448"</td>
<td>""</td>
<td>""</td>
<td>"Small molecule"</td>
<td>0</td>
<td>465.55</td>
<td>null</td>
<td>null</td>
<td>5.09</td>
<td>105.28</td>
<td>6</td>
<td>4</td>
<td>1</td>
<td>10</td>
<td>"N"</td>
<td>0.15</td>
<td>null</td>
<td>12.14</td>
<td>4.41</td>
<td>2.0</td>
<td>4</td>
<td>"MOL"</td>
<td>-1</td>
<td>33</td>
<td>7</td>
<td>5</td>
<td>1</td>
<td>465.1635</td>
<td>"BASE"</td>
<td>"C24H24FN5O2S"</td>
<td>"N=C(N)NCCCOc1ccc(CNc2nc3ccc(Oc…</td>
<td>"RXTJPHLPHOZLFS-UHFFFAOYSA-N"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Once all the columns’ data types have been checked and converted to appropriate types accordingly, I used null_count() to see the distributions of all null entries in the dataset.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for any null or NA or "" entries in the dataset</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative code that worked similarly was df.select(pl.all().null_count())</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>df_new.null_count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (1, 32)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">ChEMBL ID</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Synonyms</th>
<th data-quarto-table-cell-role="th">Type</th>
<th data-quarto-table-cell-role="th">Max Phase</th>
<th data-quarto-table-cell-role="th">Molecular Weight</th>
<th data-quarto-table-cell-role="th">Targets</th>
<th data-quarto-table-cell-role="th">Bioactivities</th>
<th data-quarto-table-cell-role="th">AlogP</th>
<th data-quarto-table-cell-role="th">Polar Surface Area</th>
<th data-quarto-table-cell-role="th">HBA</th>
<th data-quarto-table-cell-role="th">HBD</th>
<th data-quarto-table-cell-role="th">#RO5 Violations</th>
<th data-quarto-table-cell-role="th">#Rotatable Bonds</th>
<th data-quarto-table-cell-role="th">Passes Ro3</th>
<th data-quarto-table-cell-role="th">QED Weighted</th>
<th data-quarto-table-cell-role="th">CX Acidic pKa</th>
<th data-quarto-table-cell-role="th">CX Basic pKa</th>
<th data-quarto-table-cell-role="th">CX LogP</th>
<th data-quarto-table-cell-role="th">CX LogD</th>
<th data-quarto-table-cell-role="th">Aromatic Rings</th>
<th data-quarto-table-cell-role="th">Structure Type</th>
<th data-quarto-table-cell-role="th">Inorganic Flag</th>
<th data-quarto-table-cell-role="th">Heavy Atoms</th>
<th data-quarto-table-cell-role="th">HBA (Lipinski)</th>
<th data-quarto-table-cell-role="th">HBD (Lipinski)</th>
<th data-quarto-table-cell-role="th">#RO5 Violations (Lipinski)</th>
<th data-quarto-table-cell-role="th">Molecular Weight (Monoisotopic)</th>
<th data-quarto-table-cell-role="th">Molecular Species</th>
<th data-quarto-table-cell-role="th">Molecular Formula</th>
<th data-quarto-table-cell-role="th">Smiles</th>
<th data-quarto-table-cell-role="th">Inchi Key</th>
</tr>
<tr class="even">
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>23249</td>
<td>96223</td>
<td>96223</td>
<td>83571</td>
<td>83571</td>
<td>83571</td>
<td>83571</td>
<td>83571</td>
<td>83571</td>
<td>0</td>
<td>83571</td>
<td>1052439</td>
<td>882168</td>
<td>83795</td>
<td>83795</td>
<td>83571</td>
<td>0</td>
<td>0</td>
<td>83571</td>
<td>83571</td>
<td>83571</td>
<td>83571</td>
<td>23252</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop rows with null entries</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df_dn <span class="op">=</span> df_new.drop_nulls()</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>df_dn </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of rows reduced to 736,570</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (736_570, 32)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">ChEMBL ID</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Synonyms</th>
<th data-quarto-table-cell-role="th">Type</th>
<th data-quarto-table-cell-role="th">Max Phase</th>
<th data-quarto-table-cell-role="th">Molecular Weight</th>
<th data-quarto-table-cell-role="th">Targets</th>
<th data-quarto-table-cell-role="th">Bioactivities</th>
<th data-quarto-table-cell-role="th">AlogP</th>
<th data-quarto-table-cell-role="th">Polar Surface Area</th>
<th data-quarto-table-cell-role="th">HBA</th>
<th data-quarto-table-cell-role="th">HBD</th>
<th data-quarto-table-cell-role="th">#RO5 Violations</th>
<th data-quarto-table-cell-role="th">#Rotatable Bonds</th>
<th data-quarto-table-cell-role="th">Passes Ro3</th>
<th data-quarto-table-cell-role="th">QED Weighted</th>
<th data-quarto-table-cell-role="th">CX Acidic pKa</th>
<th data-quarto-table-cell-role="th">CX Basic pKa</th>
<th data-quarto-table-cell-role="th">CX LogP</th>
<th data-quarto-table-cell-role="th">CX LogD</th>
<th data-quarto-table-cell-role="th">Aromatic Rings</th>
<th data-quarto-table-cell-role="th">Structure Type</th>
<th data-quarto-table-cell-role="th">Inorganic Flag</th>
<th data-quarto-table-cell-role="th">Heavy Atoms</th>
<th data-quarto-table-cell-role="th">HBA (Lipinski)</th>
<th data-quarto-table-cell-role="th">HBD (Lipinski)</th>
<th data-quarto-table-cell-role="th">#RO5 Violations (Lipinski)</th>
<th data-quarto-table-cell-role="th">Molecular Weight (Monoisotopic)</th>
<th data-quarto-table-cell-role="th">Molecular Species</th>
<th data-quarto-table-cell-role="th">Molecular Formula</th>
<th data-quarto-table-cell-role="th">Smiles</th>
<th data-quarto-table-cell-role="th">Inchi Key</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>i64</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>str</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"CHEMBL539070"</td>
<td>""</td>
<td>""</td>
<td>"Small molecule"</td>
<td>0</td>
<td>286.79</td>
<td>1</td>
<td>1</td>
<td>2.28</td>
<td>73.06</td>
<td>6</td>
<td>2</td>
<td>0</td>
<td>5</td>
<td>"N"</td>
<td>0.63</td>
<td>13.84</td>
<td>3.64</td>
<td>2.57</td>
<td>2.57</td>
<td>2</td>
<td>"MOL"</td>
<td>-1</td>
<td>17</td>
<td>5</td>
<td>3</td>
<td>0</td>
<td>250.0888</td>
<td>"NEUTRAL"</td>
<td>"C11H15ClN4OS"</td>
<td>"CCCOc1ccccc1-c1nnc(NN)s1.Cl"</td>
<td>"WPEWNRKLKLNLSO-UHFFFAOYSA-N"</td>
</tr>
<tr class="even">
<td>"CHEMBL3827271"</td>
<td>""</td>
<td>""</td>
<td>"Small molecule"</td>
<td>0</td>
<td>712.85</td>
<td>1</td>
<td>1</td>
<td>-2.84</td>
<td>319.06</td>
<td>10</td>
<td>11</td>
<td>2</td>
<td>16</td>
<td>"N"</td>
<td>0.07</td>
<td>4.08</td>
<td>10.49</td>
<td>-6.88</td>
<td>-8.95</td>
<td>0</td>
<td>"MOL"</td>
<td>-1</td>
<td>50</td>
<td>19</td>
<td>14</td>
<td>3</td>
<td>712.4232</td>
<td>"ZWITTERION"</td>
<td>"C31H56N10O9"</td>
<td>"CC(C)C[C@@H]1NC(=O)[C@H](CCCNC…</td>
<td>"QJQNNLICZLLPMB-VUBDRERZSA-N"</td>
</tr>
<tr class="odd">
<td>"CHEMBL3824158"</td>
<td>""</td>
<td>""</td>
<td>"Small molecule"</td>
<td>0</td>
<td>422.48</td>
<td>2</td>
<td>4</td>
<td>5.09</td>
<td>109.54</td>
<td>6</td>
<td>2</td>
<td>1</td>
<td>10</td>
<td>"N"</td>
<td>0.31</td>
<td>4.59</td>
<td>7.99</td>
<td>2.49</td>
<td>2.42</td>
<td>2</td>
<td>"MOL"</td>
<td>-1</td>
<td>31</td>
<td>7</td>
<td>2</td>
<td>1</td>
<td>422.1842</td>
<td>"ACID"</td>
<td>"C24H26N2O5"</td>
<td>"CCCCCCCNC(C1=C(O)C(=O)c2ccccc2…</td>
<td>"AXOVDUYYBUYLPC-UHFFFAOYSA-N"</td>
</tr>
<tr class="even">
<td>"CHEMBL1991010"</td>
<td>""</td>
<td>""</td>
<td>"Small molecule"</td>
<td>0</td>
<td>454.05</td>
<td>60</td>
<td>60</td>
<td>5.18</td>
<td>40.54</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>8</td>
<td>"N"</td>
<td>0.6</td>
<td>13.88</td>
<td>8.48</td>
<td>6.34</td>
<td>5.22</td>
<td>2</td>
<td>"MOL"</td>
<td>-1</td>
<td>31</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>417.2668</td>
<td>"NEUTRAL"</td>
<td>"C28H36ClNO2"</td>
<td>"CCc1ccc(/C=C/C(=O)C2CN(CC)CCC2…</td>
<td>"XJDPAUYFONOZBC-DCPGAFKKSA-N"</td>
</tr>
<tr class="odd">
<td>"CHEMBL195644"</td>
<td>""</td>
<td>""</td>
<td>"Small molecule"</td>
<td>0</td>
<td>375.47</td>
<td>2</td>
<td>3</td>
<td>4.95</td>
<td>70.42</td>
<td>4</td>
<td>2</td>
<td>0</td>
<td>2</td>
<td>"N"</td>
<td>0.73</td>
<td>9.52</td>
<td>3.73</td>
<td>3.92</td>
<td>3.91</td>
<td>2</td>
<td>"MOL"</td>
<td>-1</td>
<td>28</td>
<td>4</td>
<td>2</td>
<td>0</td>
<td>375.1834</td>
<td>"NEUTRAL"</td>
<td>"C24H25NO3"</td>
<td>"C[C@]12CCC3c4ccc(O)cc4CCC3C1CC…</td>
<td>"MOBPUUUBXAHZBM-KSAYNYSMSA-N"</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>"CHEMBL2419480"</td>
<td>""</td>
<td>""</td>
<td>"Small molecule"</td>
<td>0</td>
<td>456.52</td>
<td>3</td>
<td>3</td>
<td>1.56</td>
<td>129.46</td>
<td>8</td>
<td>1</td>
<td>0</td>
<td>8</td>
<td>"N"</td>
<td>0.59</td>
<td>3.99</td>
<td>1.9</td>
<td>2.14</td>
<td>1.2</td>
<td>2</td>
<td>"MOL"</td>
<td>-1</td>
<td>32</td>
<td>9</td>
<td>1</td>
<td>0</td>
<td>456.1467</td>
<td>"ACID"</td>
<td>"C22H24N4O5S"</td>
<td>"CCOC(=O)c1cc(C#N)c(N2CC(C(=O)N…</td>
<td>"TXYSLOQUANFYQS-UHFFFAOYSA-N"</td>
</tr>
<tr class="even">
<td>"CHEMBL540121"</td>
<td>""</td>
<td>""</td>
<td>"Small molecule"</td>
<td>0</td>
<td>540.05</td>
<td>2</td>
<td>3</td>
<td>2.39</td>
<td>147.14</td>
<td>6</td>
<td>4</td>
<td>1</td>
<td>8</td>
<td>"N"</td>
<td>0.22</td>
<td>5.02</td>
<td>11.48</td>
<td>-0.75</td>
<td>-0.78</td>
<td>4</td>
<td>"MOL"</td>
<td>-1</td>
<td>36</td>
<td>9</td>
<td>5</td>
<td>1</td>
<td>503.1627</td>
<td>"ZWITTERION"</td>
<td>"C26H26ClN5O4S"</td>
<td>"Cc1ccn(NS(=O)(=O)c2cccc3ccccc2…</td>
<td>"TZLGWENJAJXWGA-UHFFFAOYSA-N"</td>
</tr>
<tr class="odd">
<td>"CHEMBL374041"</td>
<td>""</td>
<td>""</td>
<td>"Small molecule"</td>
<td>0</td>
<td>504.5</td>
<td>2</td>
<td>4</td>
<td>3.04</td>
<td>144.95</td>
<td>8</td>
<td>3</td>
<td>1</td>
<td>10</td>
<td>"N"</td>
<td>0.28</td>
<td>6.59</td>
<td>4.37</td>
<td>2.17</td>
<td>1.33</td>
<td>3</td>
<td>"MOL"</td>
<td>-1</td>
<td>37</td>
<td>11</td>
<td>3</td>
<td>2</td>
<td>504.1645</td>
<td>"NEUTRAL"</td>
<td>"C26H24N4O7"</td>
<td>"CCOCCC1(Oc2ccc(Oc3ccc(C(=O)Nc4…</td>
<td>"ABCSNHDQYHOLOO-UHFFFAOYSA-N"</td>
</tr>
<tr class="even">
<td>"CHEMBL2017916"</td>
<td>""</td>
<td>""</td>
<td>"Small molecule"</td>
<td>0</td>
<td>312.35</td>
<td>3</td>
<td>3</td>
<td>2.86</td>
<td>77.0</td>
<td>6</td>
<td>1</td>
<td>0</td>
<td>4</td>
<td>"N"</td>
<td>0.8</td>
<td>8.13</td>
<td>3.49</td>
<td>2.17</td>
<td>2.1</td>
<td>3</td>
<td>"MOL"</td>
<td>-1</td>
<td>22</td>
<td>6</td>
<td>1</td>
<td>0</td>
<td>312.0681</td>
<td>"NEUTRAL"</td>
<td>"C15H12N4O2S"</td>
<td>"COc1ccc(-c2nnc(NC(=O)c3cccnc3)…</td>
<td>"XIZUJGDKNPVNQA-UHFFFAOYSA-N"</td>
</tr>
<tr class="odd">
<td>"CHEMBL1416264"</td>
<td>""</td>
<td>""</td>
<td>"Small molecule"</td>
<td>0</td>
<td>380.41</td>
<td>6</td>
<td>8</td>
<td>3.06</td>
<td>85.07</td>
<td>7</td>
<td>1</td>
<td>0</td>
<td>5</td>
<td>"N"</td>
<td>0.54</td>
<td>13.85</td>
<td>3.86</td>
<td>2.47</td>
<td>2.47</td>
<td>4</td>
<td>"MOL"</td>
<td>-1</td>
<td>27</td>
<td>7</td>
<td>1</td>
<td>0</td>
<td>380.0856</td>
<td>"NEUTRAL"</td>
<td>"C18H13FN6OS"</td>
<td>"O=C(CSc1ccc2nnc(-c3cccnc3)n2n1…</td>
<td>"QVYIEKHEJKFNAT-UHFFFAOYSA-N"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check that all rows with null values were dropped</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>df_dn.null_count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (1, 32)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">ChEMBL ID</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Synonyms</th>
<th data-quarto-table-cell-role="th">Type</th>
<th data-quarto-table-cell-role="th">Max Phase</th>
<th data-quarto-table-cell-role="th">Molecular Weight</th>
<th data-quarto-table-cell-role="th">Targets</th>
<th data-quarto-table-cell-role="th">Bioactivities</th>
<th data-quarto-table-cell-role="th">AlogP</th>
<th data-quarto-table-cell-role="th">Polar Surface Area</th>
<th data-quarto-table-cell-role="th">HBA</th>
<th data-quarto-table-cell-role="th">HBD</th>
<th data-quarto-table-cell-role="th">#RO5 Violations</th>
<th data-quarto-table-cell-role="th">#Rotatable Bonds</th>
<th data-quarto-table-cell-role="th">Passes Ro3</th>
<th data-quarto-table-cell-role="th">QED Weighted</th>
<th data-quarto-table-cell-role="th">CX Acidic pKa</th>
<th data-quarto-table-cell-role="th">CX Basic pKa</th>
<th data-quarto-table-cell-role="th">CX LogP</th>
<th data-quarto-table-cell-role="th">CX LogD</th>
<th data-quarto-table-cell-role="th">Aromatic Rings</th>
<th data-quarto-table-cell-role="th">Structure Type</th>
<th data-quarto-table-cell-role="th">Inorganic Flag</th>
<th data-quarto-table-cell-role="th">Heavy Atoms</th>
<th data-quarto-table-cell-role="th">HBA (Lipinski)</th>
<th data-quarto-table-cell-role="th">HBD (Lipinski)</th>
<th data-quarto-table-cell-role="th">#RO5 Violations (Lipinski)</th>
<th data-quarto-table-cell-role="th">Molecular Weight (Monoisotopic)</th>
<th data-quarto-table-cell-role="th">Molecular Species</th>
<th data-quarto-table-cell-role="th">Molecular Formula</th>
<th data-quarto-table-cell-role="th">Smiles</th>
<th data-quarto-table-cell-role="th">Inchi Key</th>
</tr>
<tr class="even">
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To see summary statistics for df_dn dataset</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>df_dn.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (9, 33)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">statistic</th>
<th data-quarto-table-cell-role="th">ChEMBL ID</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Synonyms</th>
<th data-quarto-table-cell-role="th">Type</th>
<th data-quarto-table-cell-role="th">Max Phase</th>
<th data-quarto-table-cell-role="th">Molecular Weight</th>
<th data-quarto-table-cell-role="th">Targets</th>
<th data-quarto-table-cell-role="th">Bioactivities</th>
<th data-quarto-table-cell-role="th">AlogP</th>
<th data-quarto-table-cell-role="th">Polar Surface Area</th>
<th data-quarto-table-cell-role="th">HBA</th>
<th data-quarto-table-cell-role="th">HBD</th>
<th data-quarto-table-cell-role="th">#RO5 Violations</th>
<th data-quarto-table-cell-role="th">#Rotatable Bonds</th>
<th data-quarto-table-cell-role="th">Passes Ro3</th>
<th data-quarto-table-cell-role="th">QED Weighted</th>
<th data-quarto-table-cell-role="th">CX Acidic pKa</th>
<th data-quarto-table-cell-role="th">CX Basic pKa</th>
<th data-quarto-table-cell-role="th">CX LogP</th>
<th data-quarto-table-cell-role="th">CX LogD</th>
<th data-quarto-table-cell-role="th">Aromatic Rings</th>
<th data-quarto-table-cell-role="th">Structure Type</th>
<th data-quarto-table-cell-role="th">Inorganic Flag</th>
<th data-quarto-table-cell-role="th">Heavy Atoms</th>
<th data-quarto-table-cell-role="th">HBA (Lipinski)</th>
<th data-quarto-table-cell-role="th">HBD (Lipinski)</th>
<th data-quarto-table-cell-role="th">#RO5 Violations (Lipinski)</th>
<th data-quarto-table-cell-role="th">Molecular Weight (Monoisotopic)</th>
<th data-quarto-table-cell-role="th">Molecular Species</th>
<th data-quarto-table-cell-role="th">Molecular Formula</th>
<th data-quarto-table-cell-role="th">Smiles</th>
<th data-quarto-table-cell-role="th">Inchi Key</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"count"</td>
<td>"736570"</td>
<td>"736570"</td>
<td>"736570"</td>
<td>"736570"</td>
<td>736570.0</td>
<td>736570.0</td>
<td>736570.0</td>
<td>736570.0</td>
<td>736570.0</td>
<td>736570.0</td>
<td>736570.0</td>
<td>736570.0</td>
<td>736570.0</td>
<td>736570.0</td>
<td>"736570"</td>
<td>736570.0</td>
<td>736570.0</td>
<td>736570.0</td>
<td>736570.0</td>
<td>736570.0</td>
<td>736570.0</td>
<td>"736570"</td>
<td>736570.0</td>
<td>736570.0</td>
<td>736570.0</td>
<td>736570.0</td>
<td>736570.0</td>
<td>736570.0</td>
<td>"736570"</td>
<td>"736570"</td>
<td>"736570"</td>
<td>"736570"</td>
</tr>
<tr class="even">
<td>"null_count"</td>
<td>"0"</td>
<td>"0"</td>
<td>"0"</td>
<td>"0"</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>"0"</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>"0"</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>"0"</td>
<td>"0"</td>
<td>"0"</td>
<td>"0"</td>
</tr>
<tr class="odd">
<td>"mean"</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>0.007937</td>
<td>431.880042</td>
<td>5.520715</td>
<td>8.705471</td>
<td>3.325204</td>
<td>97.58116</td>
<td>5.890221</td>
<td>2.274721</td>
<td>0.489124</td>
<td>6.216262</td>
<td>null</td>
<td>0.510936</td>
<td>9.59944</td>
<td>5.074377</td>
<td>2.815115</td>
<td>2.17363</td>
<td>2.754412</td>
<td>null</td>
<td>-0.929521</td>
<td>30.266113</td>
<td>7.276555</td>
<td>2.497847</td>
<td>0.576319</td>
<td>428.334452</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
</tr>
<tr class="even">
<td>"std"</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>0.164565</td>
<td>135.637543</td>
<td>14.784793</td>
<td>55.537836</td>
<td>1.980414</td>
<td>47.40847</td>
<td>2.459106</td>
<td>1.681943</td>
<td>0.794171</td>
<td>3.894505</td>
<td>null</td>
<td>0.229039</td>
<td>3.583639</td>
<td>3.234099</td>
<td>2.286325</td>
<td>2.645694</td>
<td>1.2009</td>
<td>null</td>
<td>0.255953</td>
<td>9.54406</td>
<td>3.067158</td>
<td>2.081485</td>
<td>0.908719</td>
<td>133.755653</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
</tr>
<tr class="odd">
<td>"min"</td>
<td>"CHEMBL10"</td>
<td>""</td>
<td>""</td>
<td>""</td>
<td>0.0</td>
<td>45.04</td>
<td>1.0</td>
<td>1.0</td>
<td>-12.92</td>
<td>3.24</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>"N"</td>
<td>0.01</td>
<td>-20.03</td>
<td>0.0</td>
<td>-16.71</td>
<td>-26.04</td>
<td>0.0</td>
<td>"BOTH"</td>
<td>-1.0</td>
<td>3.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>45.0215</td>
<td>"ACID"</td>
<td>"C10H10Br2N2O"</td>
<td>"Br.Br.C/C(=N/NC(=N)N)c1ccc(CNC…</td>
<td>"AAAADVYFXUUVEO-UHFFFAOYSA-N"</td>
</tr>
<tr class="even">
<td>"25%"</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>0.0</td>
<td>340.47</td>
<td>1.0</td>
<td>2.0</td>
<td>2.21</td>
<td>68.29</td>
<td>4.0</td>
<td>1.0</td>
<td>0.0</td>
<td>4.0</td>
<td>null</td>
<td>0.34</td>
<td>7.69</td>
<td>2.25</td>
<td>1.64</td>
<td>0.97</td>
<td>2.0</td>
<td>null</td>
<td>-1.0</td>
<td>24.0</td>
<td>5.0</td>
<td>1.0</td>
<td>0.0</td>
<td>339.0582</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
</tr>
<tr class="odd">
<td>"50%"</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>0.0</td>
<td>413.46</td>
<td>2.0</td>
<td>3.0</td>
<td>3.37</td>
<td>88.32</td>
<td>5.0</td>
<td>2.0</td>
<td>0.0</td>
<td>5.0</td>
<td>null</td>
<td>0.51</td>
<td>10.51</td>
<td>4.7</td>
<td>2.97</td>
<td>2.46</td>
<td>3.0</td>
<td>null</td>
<td>-1.0</td>
<td>29.0</td>
<td>7.0</td>
<td>2.0</td>
<td>0.0</td>
<td>410.2066</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
</tr>
<tr class="even">
<td>"75%"</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>0.0</td>
<td>494.57</td>
<td>5.0</td>
<td>8.0</td>
<td>4.53</td>
<td>113.23</td>
<td>7.0</td>
<td>3.0</td>
<td>1.0</td>
<td>8.0</td>
<td>null</td>
<td>0.7</td>
<td>12.45</td>
<td>7.85</td>
<td>4.23</td>
<td>3.79</td>
<td>4.0</td>
<td>null</td>
<td>-1.0</td>
<td>35.0</td>
<td>9.0</td>
<td>3.0</td>
<td>1.0</td>
<td>491.0028</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>null</td>
</tr>
<tr class="odd">
<td>"max"</td>
<td>"CHEMBL99998"</td>
<td>"t-4-AMINOCROTONIC ACID (TACA)"</td>
<td>"trovafloxacin9"</td>
<td>"Unknown"</td>
<td>4.0</td>
<td>1901.51</td>
<td>1334.0</td>
<td>17911.0</td>
<td>16.83</td>
<td>595.22</td>
<td>32.0</td>
<td>25.0</td>
<td>4.0</td>
<td>59.0</td>
<td>"Y"</td>
<td>0.95</td>
<td>14.0</td>
<td>38.8</td>
<td>18.31</td>
<td>18.31</td>
<td>28.0</td>
<td>"MOL"</td>
<td>0.0</td>
<td>76.0</td>
<td>34.0</td>
<td>32.0</td>
<td>4.0</td>
<td>999.4063</td>
<td>"ZWITTERION"</td>
<td>"HNNa2O8S2"</td>
<td>"n1nc2c([nH]1)c1nn[nH]c1c1nn[nH…</td>
<td>"ZZZZEJJXQQRZBH-UHFFFAOYSA-N"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="some-exploratory-data-analysis" class="level5">
<h5 class="anchored" data-anchor-id="some-exploratory-data-analysis"><strong>Some exploratory data analysis</strong></h5>
<p>One of the columns that jumped out from the summary statistics of the df_dn dataset was the “Targets” column. It ranged from 1 to 1334 targets. Out of curiosity, I went through several places on ChEMBL website to find out the exact definition of “Target”. Eventually I settled on an answer which explained that the “Target” column represented the number of targets associated with the particular ChEMBL compound listed. I then singled out the ChEMBL compound with 1334 targets recorded, it turned out to be imatinib, which was marketed as Gleevec, and was a well-known prescription medicine for leukaemia and other selected oncological disorders with many well-documented drug interactions.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This was confirmed via a filter function, which brought up CHEMBL1421, or also known as dasatinib</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>df_dn.<span class="bu">filter</span>(pl.col(<span class="st">"Targets"</span>) <span class="op">==</span> <span class="dv">1334</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (1, 32)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">ChEMBL ID</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Synonyms</th>
<th data-quarto-table-cell-role="th">Type</th>
<th data-quarto-table-cell-role="th">Max Phase</th>
<th data-quarto-table-cell-role="th">Molecular Weight</th>
<th data-quarto-table-cell-role="th">Targets</th>
<th data-quarto-table-cell-role="th">Bioactivities</th>
<th data-quarto-table-cell-role="th">AlogP</th>
<th data-quarto-table-cell-role="th">Polar Surface Area</th>
<th data-quarto-table-cell-role="th">HBA</th>
<th data-quarto-table-cell-role="th">HBD</th>
<th data-quarto-table-cell-role="th">#RO5 Violations</th>
<th data-quarto-table-cell-role="th">#Rotatable Bonds</th>
<th data-quarto-table-cell-role="th">Passes Ro3</th>
<th data-quarto-table-cell-role="th">QED Weighted</th>
<th data-quarto-table-cell-role="th">CX Acidic pKa</th>
<th data-quarto-table-cell-role="th">CX Basic pKa</th>
<th data-quarto-table-cell-role="th">CX LogP</th>
<th data-quarto-table-cell-role="th">CX LogD</th>
<th data-quarto-table-cell-role="th">Aromatic Rings</th>
<th data-quarto-table-cell-role="th">Structure Type</th>
<th data-quarto-table-cell-role="th">Inorganic Flag</th>
<th data-quarto-table-cell-role="th">Heavy Atoms</th>
<th data-quarto-table-cell-role="th">HBA (Lipinski)</th>
<th data-quarto-table-cell-role="th">HBD (Lipinski)</th>
<th data-quarto-table-cell-role="th">#RO5 Violations (Lipinski)</th>
<th data-quarto-table-cell-role="th">Molecular Weight (Monoisotopic)</th>
<th data-quarto-table-cell-role="th">Molecular Species</th>
<th data-quarto-table-cell-role="th">Molecular Formula</th>
<th data-quarto-table-cell-role="th">Smiles</th>
<th data-quarto-table-cell-role="th">Inchi Key</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>i64</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>str</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"CHEMBL941"</td>
<td>"IMATINIB"</td>
<td>"GLAMOX|Gleevec|IMATINIB|Imatin…</td>
<td>"Small molecule"</td>
<td>4</td>
<td>493.62</td>
<td>1334</td>
<td>4359</td>
<td>4.59</td>
<td>86.28</td>
<td>7</td>
<td>2</td>
<td>0</td>
<td>7</td>
<td>"N"</td>
<td>0.39</td>
<td>12.69</td>
<td>7.84</td>
<td>4.38</td>
<td>3.8</td>
<td>4</td>
<td>"MOL"</td>
<td>0</td>
<td>37</td>
<td>8</td>
<td>2</td>
<td>0</td>
<td>493.259</td>
<td>"NEUTRAL"</td>
<td>"C29H31N7O"</td>
<td>"Cc1ccc(NC(=O)c2ccc(CN3CCN(C)CC…</td>
<td>"KTUFNOKKBVMGRW-UHFFFAOYSA-N"</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>To explore other physicochemical and molecular properties in the dataframe, “Max Phase” was one of the first few that drew my interests. So it tagged each ChEMBL compound with a max phase number from 0 to 4, where 4 meant the compound was approved (usually also meant it was already a prescription medicine). Thinking along this line, I thought what about those compounds that had max phase as 0, because they were the ones still pending associations with max phase numbers. By extending on this idea, this could be a good opportunity to introduce some ML to predict whether these zero max phase compounds would enter the approved max phase.</p>
<p>Firstly, I had a look at the overall distribution of the max phase compounds in this dataframe df_dn.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interested in what types of "Max Phase" were recorded </span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># for the curated small molecules in ChEMBL database</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>df_dn.group_by(<span class="st">"Max Phase"</span>, maintain_order <span class="op">=</span> <span class="va">True</span>).agg(pl.count())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/0y/p72zn_cx4vz1lv6zmyd7gkt00000gn/T/ipykernel_2417/3278305966.py:3: DeprecationWarning: `pl.count()` is deprecated. Please use `pl.len()` instead.
  df_dn.group_by("Max Phase", maintain_order = True).agg(pl.count())</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 2)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Max Phase</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
<tr class="even">
<th>i64</th>
<th>u32</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>734633</td>
</tr>
<tr class="even">
<td>3</td>
<td>303</td>
</tr>
<tr class="odd">
<td>4</td>
<td>954</td>
</tr>
<tr class="even">
<td>2</td>
<td>441</td>
</tr>
<tr class="odd">
<td>1</td>
<td>239</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>A quick groupby function showed that there were only 954 small molecules approved. Phase 3 recorded a total of 303 small molecules. For phase 2, there were 441 small molecules, followed by 239 compounds in phase 1. There were, however, a total amount of 734,633 small molecules that had zero as phase number (as per ChEMBL_31 schema documentation). Note: these figures were only for ChEMBL compounds with full documentations in the dataset (excluding entries or compounds with N/A or “” (empty) string cells).</p>
<p>One of the other parameters I was interested in was “QED Weighted”. So I went further into understanding what it meant, as the original reference was conveniently provided in the ChEMBL_31 schema documentation. The reference paper was by <a href="https://doi.org/10.1038/nchem.1243">Bickerton, G., Paolini, G., Besnard, J. et al.&nbsp;Quantifying the chemical beauty of drugs. Nature Chem 4, 90–98 (2012)</a> (note: author’s manuscript was available to view via PubMed link, the Nature Chemistry link only provided abstract with access to article via other means as stated).</p>
<p>In short, it was a measure of druglikeness for small molecules based on the concept of desirability, which was based on a total of 8 different molecular properties. These molecular properties included molecular weight, ALogP, polar surface area, number of hydrogen bond acceptors, number of hydrogen bond donors, number of rotatable bonds, number of aromatic rings and structural alerts. Without going into too much details for this QED Weighted parameter, it was normally recorded as a number that ranged from 0 to 1, with 0 being the least druglike and 1 being the most druglike.</p>
<p><br></p>
</section>
<section id="prepare-dataframe-prior-to-running-machine-learning-model" class="level5">
<h5 class="anchored" data-anchor-id="prepare-dataframe-prior-to-running-machine-learning-model"><strong>Prepare dataframe prior to running machine learning model</strong></h5>
<p>Before I got too carried away with further EDA, I wanted to get started on preparing a dataframe for the ML model. A rough plan at this stage was to filter out Max Phase 4 and 0 compounds. Max phase 0 compounds were the ones that were not assigned with any max phase numbers yet, so they would be ideal for use as the testing set. Another main idea was to use “Max Phase” parameter as the target y variable for a LR model, because ultimately stakeholders would be more interested in knowing which candidate compounds had the most likely chance to reach the final approved phase during a drug discovery and development project or otherwise. This would also provide a chance to potentially reduce the amount of resources and time required in such a complex and sophisticated matter.</p>
<p>The goal of this ML model was to answer this question: which physicochemical parameters would be the most suitable ones to predict whether a compound would enter max phase 4 (approved) or not? (implicitly, this might also help to predict which max phase 0 compounds would likely enter max phase 4 in the end)</p>
<p>I’ve then narrowed down the df_dn dataset to fulfill the following criteria:</p>
<ul>
<li>Only small molecules present</li>
<li>Max phase of 0 and 4 only</li>
</ul>
<p>Another reason behind choosing only small molecules that had max phase of 0 and 4 was that a confusion matrix could be built in the end to see if the parameters selected would give us a reasonably good model for predicting the outcomes of these small molecules.</p>
<p>For now, I’ve chosen the following columns (or physicochemical parameters) to appear in the interim df_0 and df_4 datasets.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecting Max phase 0 small molecules with desired parameters</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>df_0 <span class="op">=</span> df_dn.<span class="bu">filter</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    (pl.col(<span class="st">"Type"</span>) <span class="op">==</span> <span class="st">"Small molecule"</span>) <span class="op">&amp;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    (pl.col(<span class="st">"Max Phase"</span>) <span class="op">==</span> <span class="dv">0</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>).select([<span class="st">"ChEMBL ID"</span>, </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Type"</span>, </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Max Phase"</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>          <span class="st">"#RO5 Violations"</span>, </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>          <span class="st">"QED Weighted"</span>, </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>          <span class="st">"CX LogP"</span>, </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>          <span class="st">"CX LogD"</span>, </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Heavy Atoms"</span>]</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>df_0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (612_795, 8)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">ChEMBL ID</th>
<th data-quarto-table-cell-role="th">Type</th>
<th data-quarto-table-cell-role="th">Max Phase</th>
<th data-quarto-table-cell-role="th">#RO5 Violations</th>
<th data-quarto-table-cell-role="th">QED Weighted</th>
<th data-quarto-table-cell-role="th">CX LogP</th>
<th data-quarto-table-cell-role="th">CX LogD</th>
<th data-quarto-table-cell-role="th">Heavy Atoms</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"CHEMBL539070"</td>
<td>"Small molecule"</td>
<td>0</td>
<td>0</td>
<td>0.63</td>
<td>2.57</td>
<td>2.57</td>
<td>17</td>
</tr>
<tr class="even">
<td>"CHEMBL3827271"</td>
<td>"Small molecule"</td>
<td>0</td>
<td>2</td>
<td>0.07</td>
<td>-6.88</td>
<td>-8.95</td>
<td>50</td>
</tr>
<tr class="odd">
<td>"CHEMBL3824158"</td>
<td>"Small molecule"</td>
<td>0</td>
<td>1</td>
<td>0.31</td>
<td>2.49</td>
<td>2.42</td>
<td>31</td>
</tr>
<tr class="even">
<td>"CHEMBL1991010"</td>
<td>"Small molecule"</td>
<td>0</td>
<td>1</td>
<td>0.6</td>
<td>6.34</td>
<td>5.22</td>
<td>31</td>
</tr>
<tr class="odd">
<td>"CHEMBL195644"</td>
<td>"Small molecule"</td>
<td>0</td>
<td>0</td>
<td>0.73</td>
<td>3.92</td>
<td>3.91</td>
<td>28</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>"CHEMBL2419480"</td>
<td>"Small molecule"</td>
<td>0</td>
<td>0</td>
<td>0.59</td>
<td>2.14</td>
<td>1.2</td>
<td>32</td>
</tr>
<tr class="even">
<td>"CHEMBL540121"</td>
<td>"Small molecule"</td>
<td>0</td>
<td>1</td>
<td>0.22</td>
<td>-0.75</td>
<td>-0.78</td>
<td>36</td>
</tr>
<tr class="odd">
<td>"CHEMBL374041"</td>
<td>"Small molecule"</td>
<td>0</td>
<td>1</td>
<td>0.28</td>
<td>2.17</td>
<td>1.33</td>
<td>37</td>
</tr>
<tr class="even">
<td>"CHEMBL2017916"</td>
<td>"Small molecule"</td>
<td>0</td>
<td>0</td>
<td>0.8</td>
<td>2.17</td>
<td>2.1</td>
<td>22</td>
</tr>
<tr class="odd">
<td>"CHEMBL1416264"</td>
<td>"Small molecule"</td>
<td>0</td>
<td>0</td>
<td>0.54</td>
<td>2.47</td>
<td>2.47</td>
<td>27</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecting Max phase 4 small molecules with desired parameters</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>df_4 <span class="op">=</span> df_dn.<span class="bu">filter</span>(</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    (pl.col(<span class="st">"Type"</span>) <span class="op">==</span> <span class="st">"Small molecule"</span>) <span class="op">&amp;</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    (pl.col(<span class="st">"Max Phase"</span>) <span class="op">==</span> <span class="dv">4</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>).select([<span class="st">"ChEMBL ID"</span>, </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Type"</span>, </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Max Phase"</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>          <span class="st">"#RO5 Violations"</span>, </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>          <span class="st">"QED Weighted"</span>, </span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>          <span class="st">"CX LogP"</span>, </span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>          <span class="st">"CX LogD"</span>, </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Heavy Atoms"</span>]</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>df_4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (944, 8)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">ChEMBL ID</th>
<th data-quarto-table-cell-role="th">Type</th>
<th data-quarto-table-cell-role="th">Max Phase</th>
<th data-quarto-table-cell-role="th">#RO5 Violations</th>
<th data-quarto-table-cell-role="th">QED Weighted</th>
<th data-quarto-table-cell-role="th">CX LogP</th>
<th data-quarto-table-cell-role="th">CX LogD</th>
<th data-quarto-table-cell-role="th">Heavy Atoms</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"CHEMBL1096882"</td>
<td>"Small molecule"</td>
<td>4</td>
<td>0</td>
<td>0.31</td>
<td>-1.97</td>
<td>-5.12</td>
<td>24</td>
</tr>
<tr class="even">
<td>"CHEMBL2023898"</td>
<td>"Small molecule"</td>
<td>4</td>
<td>2</td>
<td>0.14</td>
<td>4.18</td>
<td>4.16</td>
<td>54</td>
</tr>
<tr class="odd">
<td>"CHEMBL1029"</td>
<td>"Small molecule"</td>
<td>4</td>
<td>0</td>
<td>0.46</td>
<td>-1.18</td>
<td>-2.3</td>
<td>15</td>
</tr>
<tr class="even">
<td>"CHEMBL1616"</td>
<td>"Small molecule"</td>
<td>4</td>
<td>0</td>
<td>0.72</td>
<td>2.88</td>
<td>2.58</td>
<td>20</td>
</tr>
<tr class="odd">
<td>"CHEMBL2146123"</td>
<td>"Small molecule"</td>
<td>4</td>
<td>1</td>
<td>0.33</td>
<td>-3.51</td>
<td>-3.81</td>
<td>32</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>"CHEMBL3545062"</td>
<td>"Small molecule"</td>
<td>4</td>
<td>2</td>
<td>0.1</td>
<td>5.57</td>
<td>5.57</td>
<td>65</td>
</tr>
<tr class="even">
<td>"CHEMBL3039520"</td>
<td>"Small molecule"</td>
<td>4</td>
<td>0</td>
<td>0.83</td>
<td>3.3</td>
<td>2.61</td>
<td>27</td>
</tr>
<tr class="odd">
<td>"CHEMBL1198857"</td>
<td>"Small molecule"</td>
<td>4</td>
<td>0</td>
<td>0.26</td>
<td>3.6</td>
<td>1.93</td>
<td>32</td>
</tr>
<tr class="even">
<td>"CHEMBL2146133"</td>
<td>"Small molecule"</td>
<td>4</td>
<td>0</td>
<td>0.77</td>
<td>2.43</td>
<td>2.43</td>
<td>24</td>
</tr>
<tr class="odd">
<td>"CHEMBL1619785"</td>
<td>"Small molecule"</td>
<td>4</td>
<td>0</td>
<td>0.49</td>
<td>2.09</td>
<td>1.86</td>
<td>34</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><br></p>
<section id="re-sampling-via-under-sampling" class="level6">
<h6 class="anchored" data-anchor-id="re-sampling-via-under-sampling"><strong>Re-sampling via under-sampling</strong></h6>
<p>Because of the large number of Max Phase 0 compounds present in the original dataset, I’ve randomly sampled about 950 small molecules from this group, so that there were similar amount of data in each group to avoid having an imbalanced dataset.</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df_s_0 <span class="op">=</span> df_0.sample(n <span class="op">=</span> <span class="dv">950</span>, shuffle <span class="op">=</span> <span class="va">True</span>, seed <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>df_s_0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (950, 8)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">ChEMBL ID</th>
<th data-quarto-table-cell-role="th">Type</th>
<th data-quarto-table-cell-role="th">Max Phase</th>
<th data-quarto-table-cell-role="th">#RO5 Violations</th>
<th data-quarto-table-cell-role="th">QED Weighted</th>
<th data-quarto-table-cell-role="th">CX LogP</th>
<th data-quarto-table-cell-role="th">CX LogD</th>
<th data-quarto-table-cell-role="th">Heavy Atoms</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"CHEMBL1381048"</td>
<td>"Small molecule"</td>
<td>0</td>
<td>0</td>
<td>0.66</td>
<td>1.25</td>
<td>1.24</td>
<td>20</td>
</tr>
<tr class="even">
<td>"CHEMBL14441"</td>
<td>"Small molecule"</td>
<td>0</td>
<td>0</td>
<td>0.71</td>
<td>3.29</td>
<td>3.28</td>
<td>17</td>
</tr>
<tr class="odd">
<td>"CHEMBL3916046"</td>
<td>"Small molecule"</td>
<td>0</td>
<td>1</td>
<td>0.38</td>
<td>1.29</td>
<td>1.28</td>
<td>37</td>
</tr>
<tr class="even">
<td>"CHEMBL1091700"</td>
<td>"Small molecule"</td>
<td>0</td>
<td>2</td>
<td>0.29</td>
<td>3.27</td>
<td>3.13</td>
<td>45</td>
</tr>
<tr class="odd">
<td>"CHEMBL4109628"</td>
<td>"Small molecule"</td>
<td>0</td>
<td>0</td>
<td>0.55</td>
<td>3.52</td>
<td>3.52</td>
<td>34</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>"CHEMBL3261532"</td>
<td>"Small molecule"</td>
<td>0</td>
<td>0</td>
<td>0.78</td>
<td>2.99</td>
<td>-0.35</td>
<td>24</td>
</tr>
<tr class="even">
<td>"CHEMBL3343507"</td>
<td>"Small molecule"</td>
<td>0</td>
<td>0</td>
<td>0.5</td>
<td>2.18</td>
<td>0.03</td>
<td>24</td>
</tr>
<tr class="odd">
<td>"CHEMBL1720477"</td>
<td>"Small molecule"</td>
<td>0</td>
<td>0</td>
<td>0.92</td>
<td>2.34</td>
<td>-0.74</td>
<td>21</td>
</tr>
<tr class="even">
<td>"CHEMBL4293746"</td>
<td>"Small molecule"</td>
<td>0</td>
<td>0</td>
<td>0.48</td>
<td>2.61</td>
<td>2.54</td>
<td>29</td>
</tr>
<tr class="odd">
<td>"CHEMBL3219994"</td>
<td>"Small molecule"</td>
<td>0</td>
<td>0</td>
<td>0.83</td>
<td>4.46</td>
<td>4.18</td>
<td>22</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Since the plan was to use LR method for ML model, the y variable I was interested in was going to be a binary categorical variable - meaning it needed to be 0 (not approved) or 1 (approved). To do this, I’ve added a new column with a new name of “Max_Phase” and replace “4” as “1” by dividing the whole column by 4 to reach this new label.</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df_4_f <span class="op">=</span> df_4.with_columns((pl.col(<span class="st">"Max Phase"</span>) <span class="op">/</span> <span class="dv">4</span>).alias(<span class="st">"Max_Phase"</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>df_4_f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (944, 9)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">ChEMBL ID</th>
<th data-quarto-table-cell-role="th">Type</th>
<th data-quarto-table-cell-role="th">Max Phase</th>
<th data-quarto-table-cell-role="th">#RO5 Violations</th>
<th data-quarto-table-cell-role="th">QED Weighted</th>
<th data-quarto-table-cell-role="th">CX LogP</th>
<th data-quarto-table-cell-role="th">CX LogD</th>
<th data-quarto-table-cell-role="th">Heavy Atoms</th>
<th data-quarto-table-cell-role="th">Max_Phase</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"CHEMBL1096882"</td>
<td>"Small molecule"</td>
<td>4</td>
<td>0</td>
<td>0.31</td>
<td>-1.97</td>
<td>-5.12</td>
<td>24</td>
<td>1.0</td>
</tr>
<tr class="even">
<td>"CHEMBL2023898"</td>
<td>"Small molecule"</td>
<td>4</td>
<td>2</td>
<td>0.14</td>
<td>4.18</td>
<td>4.16</td>
<td>54</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td>"CHEMBL1029"</td>
<td>"Small molecule"</td>
<td>4</td>
<td>0</td>
<td>0.46</td>
<td>-1.18</td>
<td>-2.3</td>
<td>15</td>
<td>1.0</td>
</tr>
<tr class="even">
<td>"CHEMBL1616"</td>
<td>"Small molecule"</td>
<td>4</td>
<td>0</td>
<td>0.72</td>
<td>2.88</td>
<td>2.58</td>
<td>20</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td>"CHEMBL2146123"</td>
<td>"Small molecule"</td>
<td>4</td>
<td>1</td>
<td>0.33</td>
<td>-3.51</td>
<td>-3.81</td>
<td>32</td>
<td>1.0</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>"CHEMBL3545062"</td>
<td>"Small molecule"</td>
<td>4</td>
<td>2</td>
<td>0.1</td>
<td>5.57</td>
<td>5.57</td>
<td>65</td>
<td>1.0</td>
</tr>
<tr class="even">
<td>"CHEMBL3039520"</td>
<td>"Small molecule"</td>
<td>4</td>
<td>0</td>
<td>0.83</td>
<td>3.3</td>
<td>2.61</td>
<td>27</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td>"CHEMBL1198857"</td>
<td>"Small molecule"</td>
<td>4</td>
<td>0</td>
<td>0.26</td>
<td>3.6</td>
<td>1.93</td>
<td>32</td>
<td>1.0</td>
</tr>
<tr class="even">
<td>"CHEMBL2146133"</td>
<td>"Small molecule"</td>
<td>4</td>
<td>0</td>
<td>0.77</td>
<td>2.43</td>
<td>2.43</td>
<td>24</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td>"CHEMBL1619785"</td>
<td>"Small molecule"</td>
<td>4</td>
<td>0</td>
<td>0.49</td>
<td>2.09</td>
<td>1.86</td>
<td>34</td>
<td>1.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Then I changed the data type of “Max_Phase” from float to integer, so that the two different dataframes could be concatenated (which would only work if both were of same data types).</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df_4_f <span class="op">=</span> df_4_f.with_columns((pl.col(<span class="st">"Max_Phase"</span>)).cast(pl.Int64, strict <span class="op">=</span> <span class="va">False</span>))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>df_4_f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (944, 9)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">ChEMBL ID</th>
<th data-quarto-table-cell-role="th">Type</th>
<th data-quarto-table-cell-role="th">Max Phase</th>
<th data-quarto-table-cell-role="th">#RO5 Violations</th>
<th data-quarto-table-cell-role="th">QED Weighted</th>
<th data-quarto-table-cell-role="th">CX LogP</th>
<th data-quarto-table-cell-role="th">CX LogD</th>
<th data-quarto-table-cell-role="th">Heavy Atoms</th>
<th data-quarto-table-cell-role="th">Max_Phase</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"CHEMBL1096882"</td>
<td>"Small molecule"</td>
<td>4</td>
<td>0</td>
<td>0.31</td>
<td>-1.97</td>
<td>-5.12</td>
<td>24</td>
<td>1</td>
</tr>
<tr class="even">
<td>"CHEMBL2023898"</td>
<td>"Small molecule"</td>
<td>4</td>
<td>2</td>
<td>0.14</td>
<td>4.18</td>
<td>4.16</td>
<td>54</td>
<td>1</td>
</tr>
<tr class="odd">
<td>"CHEMBL1029"</td>
<td>"Small molecule"</td>
<td>4</td>
<td>0</td>
<td>0.46</td>
<td>-1.18</td>
<td>-2.3</td>
<td>15</td>
<td>1</td>
</tr>
<tr class="even">
<td>"CHEMBL1616"</td>
<td>"Small molecule"</td>
<td>4</td>
<td>0</td>
<td>0.72</td>
<td>2.88</td>
<td>2.58</td>
<td>20</td>
<td>1</td>
</tr>
<tr class="odd">
<td>"CHEMBL2146123"</td>
<td>"Small molecule"</td>
<td>4</td>
<td>1</td>
<td>0.33</td>
<td>-3.51</td>
<td>-3.81</td>
<td>32</td>
<td>1</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>"CHEMBL3545062"</td>
<td>"Small molecule"</td>
<td>4</td>
<td>2</td>
<td>0.1</td>
<td>5.57</td>
<td>5.57</td>
<td>65</td>
<td>1</td>
</tr>
<tr class="even">
<td>"CHEMBL3039520"</td>
<td>"Small molecule"</td>
<td>4</td>
<td>0</td>
<td>0.83</td>
<td>3.3</td>
<td>2.61</td>
<td>27</td>
<td>1</td>
</tr>
<tr class="odd">
<td>"CHEMBL1198857"</td>
<td>"Small molecule"</td>
<td>4</td>
<td>0</td>
<td>0.26</td>
<td>3.6</td>
<td>1.93</td>
<td>32</td>
<td>1</td>
</tr>
<tr class="even">
<td>"CHEMBL2146133"</td>
<td>"Small molecule"</td>
<td>4</td>
<td>0</td>
<td>0.77</td>
<td>2.43</td>
<td>2.43</td>
<td>24</td>
<td>1</td>
</tr>
<tr class="odd">
<td>"CHEMBL1619785"</td>
<td>"Small molecule"</td>
<td>4</td>
<td>0</td>
<td>0.49</td>
<td>2.09</td>
<td>1.86</td>
<td>34</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Also I’ve created a new column with the same name of “Max_Phase” for Max phase 0 small molecules, so that the two dataframes could be combined (also needed to have exactly the same column names for it to work).</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df_s_0_f <span class="op">=</span> df_s_0.with_columns((pl.col(<span class="st">"Max Phase"</span>)).alias(<span class="st">"Max_Phase"</span>))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>df_s_0_f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (950, 9)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">ChEMBL ID</th>
<th data-quarto-table-cell-role="th">Type</th>
<th data-quarto-table-cell-role="th">Max Phase</th>
<th data-quarto-table-cell-role="th">#RO5 Violations</th>
<th data-quarto-table-cell-role="th">QED Weighted</th>
<th data-quarto-table-cell-role="th">CX LogP</th>
<th data-quarto-table-cell-role="th">CX LogD</th>
<th data-quarto-table-cell-role="th">Heavy Atoms</th>
<th data-quarto-table-cell-role="th">Max_Phase</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"CHEMBL1381048"</td>
<td>"Small molecule"</td>
<td>0</td>
<td>0</td>
<td>0.66</td>
<td>1.25</td>
<td>1.24</td>
<td>20</td>
<td>0</td>
</tr>
<tr class="even">
<td>"CHEMBL14441"</td>
<td>"Small molecule"</td>
<td>0</td>
<td>0</td>
<td>0.71</td>
<td>3.29</td>
<td>3.28</td>
<td>17</td>
<td>0</td>
</tr>
<tr class="odd">
<td>"CHEMBL3916046"</td>
<td>"Small molecule"</td>
<td>0</td>
<td>1</td>
<td>0.38</td>
<td>1.29</td>
<td>1.28</td>
<td>37</td>
<td>0</td>
</tr>
<tr class="even">
<td>"CHEMBL1091700"</td>
<td>"Small molecule"</td>
<td>0</td>
<td>2</td>
<td>0.29</td>
<td>3.27</td>
<td>3.13</td>
<td>45</td>
<td>0</td>
</tr>
<tr class="odd">
<td>"CHEMBL4109628"</td>
<td>"Small molecule"</td>
<td>0</td>
<td>0</td>
<td>0.55</td>
<td>3.52</td>
<td>3.52</td>
<td>34</td>
<td>0</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>"CHEMBL3261532"</td>
<td>"Small molecule"</td>
<td>0</td>
<td>0</td>
<td>0.78</td>
<td>2.99</td>
<td>-0.35</td>
<td>24</td>
<td>0</td>
</tr>
<tr class="even">
<td>"CHEMBL3343507"</td>
<td>"Small molecule"</td>
<td>0</td>
<td>0</td>
<td>0.5</td>
<td>2.18</td>
<td>0.03</td>
<td>24</td>
<td>0</td>
</tr>
<tr class="odd">
<td>"CHEMBL1720477"</td>
<td>"Small molecule"</td>
<td>0</td>
<td>0</td>
<td>0.92</td>
<td>2.34</td>
<td>-0.74</td>
<td>21</td>
<td>0</td>
</tr>
<tr class="even">
<td>"CHEMBL4293746"</td>
<td>"Small molecule"</td>
<td>0</td>
<td>0</td>
<td>0.48</td>
<td>2.61</td>
<td>2.54</td>
<td>29</td>
<td>0</td>
</tr>
<tr class="odd">
<td>"CHEMBL3219994"</td>
<td>"Small molecule"</td>
<td>0</td>
<td>0</td>
<td>0.83</td>
<td>4.46</td>
<td>4.18</td>
<td>22</td>
<td>0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Then I combined df_s_0_f (dataframe with max phase 0 compounds) and df_4_f (dataframe with max phase 4 compounds).</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df_concat <span class="op">=</span> pl.concat([df_s_0_f, df_4_f], how <span class="op">=</span> <span class="st">"vertical"</span>,)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_concat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (1_894, 9)
┌───────────────┬──────────┬───────────┬────────────┬───┬─────────┬─────────┬───────┬───────────┐
│ ChEMBL ID     ┆ Type     ┆ Max Phase ┆ #RO5       ┆ … ┆ CX LogP ┆ CX LogD ┆ Heavy ┆ Max_Phase │
│ ---           ┆ ---      ┆ ---       ┆ Violations ┆   ┆ ---     ┆ ---     ┆ Atoms ┆ ---       │
│ str           ┆ str      ┆ i64       ┆ ---        ┆   ┆ f64     ┆ f64     ┆ ---   ┆ i64       │
│               ┆          ┆           ┆ i64        ┆   ┆         ┆         ┆ i64   ┆           │
╞═══════════════╪══════════╪═══════════╪════════════╪═══╪═════════╪═════════╪═══════╪═══════════╡
│ CHEMBL1381048 ┆ Small    ┆ 0         ┆ 0          ┆ … ┆ 1.25    ┆ 1.24    ┆ 20    ┆ 0         │
│               ┆ molecule ┆           ┆            ┆   ┆         ┆         ┆       ┆           │
│ CHEMBL14441   ┆ Small    ┆ 0         ┆ 0          ┆ … ┆ 3.29    ┆ 3.28    ┆ 17    ┆ 0         │
│               ┆ molecule ┆           ┆            ┆   ┆         ┆         ┆       ┆           │
│ CHEMBL3916046 ┆ Small    ┆ 0         ┆ 1          ┆ … ┆ 1.29    ┆ 1.28    ┆ 37    ┆ 0         │
│               ┆ molecule ┆           ┆            ┆   ┆         ┆         ┆       ┆           │
│ CHEMBL1091700 ┆ Small    ┆ 0         ┆ 2          ┆ … ┆ 3.27    ┆ 3.13    ┆ 45    ┆ 0         │
│               ┆ molecule ┆           ┆            ┆   ┆         ┆         ┆       ┆           │
│ CHEMBL4109628 ┆ Small    ┆ 0         ┆ 0          ┆ … ┆ 3.52    ┆ 3.52    ┆ 34    ┆ 0         │
│               ┆ molecule ┆           ┆            ┆   ┆         ┆         ┆       ┆           │
│ …             ┆ …        ┆ …         ┆ …          ┆ … ┆ …       ┆ …       ┆ …     ┆ …         │
│ CHEMBL3545062 ┆ Small    ┆ 4         ┆ 2          ┆ … ┆ 5.57    ┆ 5.57    ┆ 65    ┆ 1         │
│               ┆ molecule ┆           ┆            ┆   ┆         ┆         ┆       ┆           │
│ CHEMBL3039520 ┆ Small    ┆ 4         ┆ 0          ┆ … ┆ 3.3     ┆ 2.61    ┆ 27    ┆ 1         │
│               ┆ molecule ┆           ┆            ┆   ┆         ┆         ┆       ┆           │
│ CHEMBL1198857 ┆ Small    ┆ 4         ┆ 0          ┆ … ┆ 3.6     ┆ 1.93    ┆ 32    ┆ 1         │
│               ┆ molecule ┆           ┆            ┆   ┆         ┆         ┆       ┆           │
│ CHEMBL2146133 ┆ Small    ┆ 4         ┆ 0          ┆ … ┆ 2.43    ┆ 2.43    ┆ 24    ┆ 1         │
│               ┆ molecule ┆           ┆            ┆   ┆         ┆         ┆       ┆           │
│ CHEMBL1619785 ┆ Small    ┆ 4         ┆ 0          ┆ … ┆ 2.09    ┆ 1.86    ┆ 34    ┆ 1         │
│               ┆ molecule ┆           ┆            ┆   ┆         ┆         ┆       ┆           │
└───────────────┴──────────┴───────────┴────────────┴───┴─────────┴─────────┴───────┴───────────┘</code></pre>
</div>
</div>
<p>This df_concat dataset was checked to see it had all compounds in Max Phase 0 and 4 only. Note: Max Phase 4 (approved) compounds were re-labelled as Max_Phase = 1.</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df_concat.group_by(<span class="st">"Max_Phase"</span>).count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/0y/p72zn_cx4vz1lv6zmyd7gkt00000gn/T/ipykernel_2417/631682218.py:1: DeprecationWarning: `GroupBy.count` is deprecated. It has been renamed to `len`.
  df_concat.group_by("Max_Phase").count()</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (2, 2)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Max_Phase</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
<tr class="even">
<th>i64</th>
<th>u32</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>950</td>
</tr>
<tr class="even">
<td>1</td>
<td>944</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>I then checked df_concat dataset only had small molecules to confirm what I’ve tried to achieve.</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df_concat.group_by(<span class="st">"Type"</span>).count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/0y/p72zn_cx4vz1lv6zmyd7gkt00000gn/T/ipykernel_2417/3888448416.py:1: DeprecationWarning: `GroupBy.count` is deprecated. It has been renamed to `len`.
  df_concat.group_by("Type").count()</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="22">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (1, 2)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Type</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
<tr class="even">
<th>str</th>
<th>u32</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Small molecule"</td>
<td>1894</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>So here we had the final version of the dataset, which I’ve renamed to df_ml to avoid confusion from the previous dataframes, before entering the ML phase.</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Leave out ChEMBL ID and Type</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>df_ml <span class="op">=</span> df_concat.select([<span class="st">"Max_Phase"</span>, </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"#RO5 Violations"</span>, </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"QED Weighted"</span>, </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"CX LogP"</span>, </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"CX LogD"</span>, </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Heavy Atoms"</span>]</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>                        )</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>df_ml</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (1_894, 6)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Max_Phase</th>
<th data-quarto-table-cell-role="th">#RO5 Violations</th>
<th data-quarto-table-cell-role="th">QED Weighted</th>
<th data-quarto-table-cell-role="th">CX LogP</th>
<th data-quarto-table-cell-role="th">CX LogD</th>
<th data-quarto-table-cell-role="th">Heavy Atoms</th>
</tr>
<tr class="even">
<th>i64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0</td>
<td>0.66</td>
<td>1.25</td>
<td>1.24</td>
<td>20</td>
</tr>
<tr class="even">
<td>0</td>
<td>0</td>
<td>0.71</td>
<td>3.29</td>
<td>3.28</td>
<td>17</td>
</tr>
<tr class="odd">
<td>0</td>
<td>1</td>
<td>0.38</td>
<td>1.29</td>
<td>1.28</td>
<td>37</td>
</tr>
<tr class="even">
<td>0</td>
<td>2</td>
<td>0.29</td>
<td>3.27</td>
<td>3.13</td>
<td>45</td>
</tr>
<tr class="odd">
<td>0</td>
<td>0</td>
<td>0.55</td>
<td>3.52</td>
<td>3.52</td>
<td>34</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>0.1</td>
<td>5.57</td>
<td>5.57</td>
<td>65</td>
</tr>
<tr class="even">
<td>1</td>
<td>0</td>
<td>0.83</td>
<td>3.3</td>
<td>2.61</td>
<td>27</td>
</tr>
<tr class="odd">
<td>1</td>
<td>0</td>
<td>0.26</td>
<td>3.6</td>
<td>1.93</td>
<td>32</td>
</tr>
<tr class="even">
<td>1</td>
<td>0</td>
<td>0.77</td>
<td>2.43</td>
<td>2.43</td>
<td>24</td>
</tr>
<tr class="odd">
<td>1</td>
<td>0</td>
<td>0.49</td>
<td>2.09</td>
<td>1.86</td>
<td>34</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for any nulls in the dataset</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>df_ml.null_count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (1, 6)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Max_Phase</th>
<th data-quarto-table-cell-role="th">#RO5 Violations</th>
<th data-quarto-table-cell-role="th">QED Weighted</th>
<th data-quarto-table-cell-role="th">CX LogP</th>
<th data-quarto-table-cell-role="th">CX LogD</th>
<th data-quarto-table-cell-role="th">Heavy Atoms</th>
</tr>
<tr class="even">
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
<th>u32</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check data types in df_ml dataset</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Needed to be integers or floats for scikit-learn algorithms to work</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>df_ml.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>[Int64, Int64, Float64, Float64, Float64, Int64]</code></pre>
</div>
</div>
<div class="sourceCode" id="cb32"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: exported df_ml dataframe as csv file for ML series 1.2.</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>df_ml.write_csv(<span class="st">"df_ml.csv"</span>, sep <span class="op">=</span> <span class="st">","</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
</section>
</section>
<section id="import-libraries-for-machine-learning" class="level5">
<h5 class="anchored" data-anchor-id="import-libraries-for-machine-learning"><strong>Import libraries for machine learning</strong></h5>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install scikit-learn - an open-source ML library</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Uncomment the line below if needing to install this library</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co">#!pip install -U scikit-learn</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import scikit-learn</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sklearn</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check version of scikit-learn </span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sklearn.__version__)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.5.0</code></pre>
</div>
</div>
<p>Other libraries needed to generate ML model were imported as below.</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To use NumPy arrays to prepare X &amp; y variables</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Needed for dataframe in scikit-learn ML</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Uncomment line below if requiring to install pandas</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="co">#!pip install pandas</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="co"># To normalise dataset prior to running ML</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> preprocessing</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="co"># To split dataset into training &amp; testing sets</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="co"># For data visualisations</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Uncomment line below if requiring to install matplotlib</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="co">#!pip install matplotlib</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I’ve then installed pyarrow, to convert Polars dataframe into a Pandas dataframe, which was needed to run <em>scikit-learn</em>.</p>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Uncomment line below to install pyarrow</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co">#!pip install pyarrow</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert Polars df to Pandas df </span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>df_ml_pd <span class="op">=</span> df_ml.to_pandas()</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(df_ml_pd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>pandas.core.frame.DataFrame</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="logistic-regression-with-scikit-learn" class="level5">
<h5 class="anchored" data-anchor-id="logistic-regression-with-scikit-learn"><strong>Logistic regression with <em>scikit-learn</em></strong></h5>
<p>LR was one of the supervised methods in statistical ML realm. As the term “supervised” suggested, this type of ML was purely data-driven to allow computers to learn patterns from input data with known outcomes, in order to predict new outcomes on novel data.</p>
<p><br></p>
<section id="defining-x-and-y-variables" class="level6">
<h6 class="anchored" data-anchor-id="defining-x-and-y-variables"><strong>Defining X and y variables</strong></h6>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define X variables from df_ml_pd dataset</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.asarray(df_ml_pd[[<span class="st">"#RO5 Violations"</span>, </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"QED Weighted"</span>, </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"CX LogP"</span>, </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"CX LogD"</span>, </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"Heavy Atoms"</span>]]</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">0</span>:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>array([[ 0.  ,  0.66,  1.25,  1.24, 20.  ],
       [ 0.  ,  0.71,  3.29,  3.28, 17.  ],
       [ 1.  ,  0.38,  1.29,  1.28, 37.  ],
       [ 2.  ,  0.29,  3.27,  3.13, 45.  ],
       [ 0.  ,  0.55,  3.52,  3.52, 34.  ]])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define y variable</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Note to use "Max_Phase", not the original "Max Phase"</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.asarray(df_ml_pd[<span class="st">"Max_Phase"</span>])</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>y[<span class="dv">0</span>:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>array([0, 0, 0, 0, 0])</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="training-and-testing-sets" class="level6">
<h6 class="anchored" data-anchor-id="training-and-testing-sets"><strong>Training and testing sets</strong></h6>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Split dataset into training &amp; testing sets</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Random number generator</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co">#rng = np.random.RandomState(0) - note: this may produce different result each time</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Edited post to use random_state = 250 to show comparison with ML series 1.2</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="co"># for reproducible result</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size <span class="op">=</span> <span class="fl">0.2</span>, random_state <span class="op">=</span> <span class="dv">250</span>)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Training set:'</span>, X_train.shape, y_train.shape)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Testing set:'</span>, X_test.shape, y_test.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training set: (1515, 5) (1515,)
Testing set: (379, 5) (379,)</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="preprocessing-data" class="level6">
<h6 class="anchored" data-anchor-id="preprocessing-data"><strong>Preprocessing data</strong></h6>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalise &amp; clean the dataset</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit on the training set - not on testing set as this might lead to data leakage</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform on the testing set</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> preprocessing.StandardScaler().fit(X_train).transform(X_test)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">0</span>:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>array([[ 0.60894516, -0.22530057, -1.42757534, -0.9045478 , -0.66822519],
       [-0.6081418 , -0.5780968 ,  0.47438747,  0.26911898,  0.2876441 ],
       [-0.6081418 ,  1.45048155, -0.28333614,  0.03629921, -0.57263826],
       [-0.6081418 ,  1.18588438, -0.7349088 , -0.38787927, -1.14615983],
       [-0.6081418 , -0.48989774,  0.65042427,  0.82724856, -0.19029055]])</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="fitting-lr-classifier-on-training-set" class="level6">
<h6 class="anchored" data-anchor-id="fitting-lr-classifier-on-training-set"><strong>Fitting LR classifier on training set</strong></h6>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import logistic regression </span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an instance of logistic regression classifier and fit the data</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>LogR <span class="op">=</span> LogisticRegression().fit(X_train, y_train)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>LogR</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<style>#sk-container-id-1 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-1 {
  color: var(--sklearn-color-text);
}

#sk-container-id-1 pre {
  padding: 0;
}

#sk-container-id-1 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-1 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-1 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-1 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-1 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-1 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-1 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-1 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-1 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-1 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-1 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-1 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-1 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-1 div.sk-label label.sk-toggleable__label,
#sk-container-id-1 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-1 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-1 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-1 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-1 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-1 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-1 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-1 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-1 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>LogisticRegression()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked=""><label for="sk-estimator-id-1" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;LogisticRegression<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.linear_model.LogisticRegression.html">?<span>Documentation for LogisticRegression</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>LogisticRegression()</pre></div> </div></div></div></div>
</div>
</div>
<p><br></p>
</section>
<section id="applying-lr-classifier-on-testing-set-for-prediction" class="level6">
<h6 class="anchored" data-anchor-id="applying-lr-classifier-on-testing-set-for-prediction"><strong>Applying LR classifier on testing set for prediction</strong></h6>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>y_mp <span class="op">=</span> LogR.predict(X_test)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>y_mp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>array([1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 0,
       0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1,
       1, 1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1,
       0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0,
       1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1,
       0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1,
       0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1,
       0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 0,
       0, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1,
       0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 1,
       0, 0, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0,
       1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 0,
       0, 1, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1,
       0, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 1,
       0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1,
       1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1,
       0, 1, 1, 0, 1])</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="converting-predicted-values-into-a-dataframe" class="level6">
<h6 class="anchored" data-anchor-id="converting-predicted-values-into-a-dataframe"><strong>Converting predicted values into a dataframe</strong></h6>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted values were based on log odds</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Use describe() method to get characteristics of the distribution</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> pd.DataFrame(LogR.predict_log_proba(X))</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>pred.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>379.000000</td>
<td>379.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>-0.862452</td>
<td>-0.616678</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>0.318816</td>
<td>0.258353</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>-1.622114</td>
<td>-1.537892</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>-1.096951</td>
<td>-0.775959</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>-0.826656</td>
<td>-0.575382</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>-0.616677</td>
<td>-0.406300</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>-0.241859</td>
<td>-0.219999</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Alternatively, a quicker way to get predicted probabilities was via predict_proba() method in <em>scikit-learn</em>.</p>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>y_mp_proba <span class="op">=</span> LogR.predict_proba(X_test)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Uncomment below to see the predicted probabilities printed</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co">#print(y_mp_proba)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
</section>
<section id="converting-predicted-probabilities-into-a-dataframe" class="level6">
<h6 class="anchored" data-anchor-id="converting-predicted-probabilities-into-a-dataframe"><strong>Converting predicted probabilities into a dataframe</strong></h6>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use describe() to show distributions</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>y_mp_prob <span class="op">=</span> pd.DataFrame(y_mp_proba)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>y_mp_prob.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>379.000000</td>
<td>379.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>0.482996</td>
<td>0.517004</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>0.169226</td>
<td>0.169226</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>0.008877</td>
<td>0.151562</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>0.365433</td>
<td>0.393816</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>0.504758</td>
<td>0.495242</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>0.606184</td>
<td>0.634567</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>0.848438</td>
<td>0.991123</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><br></p>
</section>
<section id="pipeline-method-for-lr" class="level6">
<h6 class="anchored" data-anchor-id="pipeline-method-for-lr"><strong>Pipeline method for LR</strong></h6>
<p>This was something I thought to try when I was reading through <em>scikit-learn</em> documentation. One major advantage of using pipeline was that it was designed to chain all the estimators used for ML. The benefit of this was that we only had to call fit and predict once in our data to fit the whole chain of estimators. The other useful thing was that this could avoid data leakage from our testing set into the training set by making sure the same set of samples were used to train the transformers and predictors. One other key thing it also helped was that it also avoided the possibility of missing out on the transformation step.</p>
<p>The example below used the function of make_pipeline, which took in a number of estimators as inputted, and then constructed a pipeline based on them.</p>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test pipline from scikit-Learn</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> make_pipeline</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>LR <span class="op">=</span> make_pipeline(StandardScaler(), LogisticRegression())</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>LR.fit(X_train, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<style>#sk-container-id-2 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-2 {
  color: var(--sklearn-color-text);
}

#sk-container-id-2 pre {
  padding: 0;
}

#sk-container-id-2 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-2 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-2 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-2 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-2 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-2 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-2 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-2 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-2 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-2 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-2 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-2 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-2 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-2 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-2 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-2 div.sk-label label.sk-toggleable__label,
#sk-container-id-2 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-2 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-2 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-2 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-2 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-2 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-2 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-2 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-2 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-2 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[('standardscaler', StandardScaler()),
                ('logisticregression', LogisticRegression())])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox"><label for="sk-estimator-id-2" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;Pipeline<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.pipeline.Pipeline.html">?<span>Documentation for Pipeline</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>Pipeline(steps=[('standardscaler', StandardScaler()),
                ('logisticregression', LogisticRegression())])</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox"><label for="sk-estimator-id-3" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;StandardScaler<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.preprocessing.StandardScaler.html">?<span>Documentation for StandardScaler</span></a></label><div class="sk-toggleable__content fitted"><pre>StandardScaler()</pre></div> </div></div><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-4" type="checkbox"><label for="sk-estimator-id-4" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;LogisticRegression<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.linear_model.LogisticRegression.html">?<span>Documentation for LogisticRegression</span></a></label><div class="sk-toggleable__content fitted"><pre>LogisticRegression()</pre></div> </div></div></div></div></div></div>
</div>
</div>
<p><br></p>
</section>
</section>
<section id="evaluation-of-the-logistic-regression-model" class="level4">
<h4 class="anchored" data-anchor-id="evaluation-of-the-logistic-regression-model"><strong>Evaluation of the logistic regression model</strong></h4>
<section id="accuracy-scores" class="level6">
<h6 class="anchored" data-anchor-id="accuracy-scores"><strong>Accuracy scores</strong></h6>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>accuracy_score(y_mp, y_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>0.7018469656992085</code></pre>
</div>
</div>
<p>The accuracy score was 0.7 (after rounding up) based on the original data preprocessing method, which meant that there were around 70% of the cases (or compounds) classified correctly by using this LR classifier. Accuracy literally provided a measure of how close the predicted samples were to the true values. One caveat to note was that for imbalanced dataset, accuracy score might not be very informative, and other evaluation metrics would need to be considered instead.</p>
<p>The accuracy score shown below was from the pipeline method used previously, which showed a very similar accuracy score of 0.69656992 (close to 0.7), confirming the method was in line with the original preprocessing method.</p>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>LR.score(X_test, y_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>0.6965699208443272</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="confusion-matrix" class="level6">
<h6 class="anchored" data-anchor-id="confusion-matrix"><strong>Confusion matrix</strong></h6>
<p>Next, I’ve built a confusion matrix based on the model in order to visualise the counts of correct and incorrect predictions. The function code used below was adapted from the IBM data science course I’ve taken around the end of last year. I’ve added comments to try and explain what each section of the code meant.</p>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import confusion matrix from scikit-learn</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Import itertools - functions to create iterators for efficient looping</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> itertools</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to print and plot confusion matrix</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_confusion_matrix(<span class="co"># Sets a cm object (cm = confusion matrix)</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>                          cm, </span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>                          <span class="co"># Sets classes of '1s' (Successes) &amp; '0s' (Non-successes) for the cm</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>                          classes,</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>                          <span class="co"># If setting normalize = true, reports in ratios instead of counts</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>                          normalize,</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>                          title <span class="op">=</span> <span class="st">'Confusion matrix'</span>,</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>                          <span class="co"># Choose colour of the cm (using colourmap recognised by matplotlib)</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>                          cmap <span class="op">=</span> plt.cm.Reds):</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> normalize:</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>        cm <span class="op">=</span> cm.astype(<span class="st">'float'</span>) <span class="op">/</span> cm.<span class="bu">sum</span>(axis <span class="op">=</span> <span class="dv">1</span>)[:, np.newaxis]</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Normalized confusion matrix"</span>)</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'Confusion matrix, without normalization'</span>)</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(cm)</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot the confusion matrix </span></span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>    plt.imshow(cm, interpolation <span class="op">=</span> <span class="st">'nearest'</span>, cmap <span class="op">=</span> cmap)</span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>    plt.title(title)</span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>    plt.colorbar()</span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>    tick_marks <span class="op">=</span> np.arange(<span class="bu">len</span>(classes))</span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a>    plt.xticks(tick_marks, classes, rotation <span class="op">=</span> <span class="dv">45</span>)</span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a>    plt.yticks(tick_marks, classes)</span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Floats to be round up to two decimal places if using normalize = True</span></span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># or else use integers</span></span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a>    fmt <span class="op">=</span> <span class="st">'.2f'</span> <span class="cf">if</span> normalize <span class="cf">else</span> <span class="st">'d'</span></span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sets threshold of 0.5</span></span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a>    thresh <span class="op">=</span> cm.<span class="bu">max</span>() <span class="op">/</span> <span class="fl">2.</span></span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Iterate through the results and differentiate between two text colours </span></span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># by using the threshold as a cut-off</span></span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, j <span class="kw">in</span> itertools.product(<span class="bu">range</span>(cm.shape[<span class="dv">0</span>]), <span class="bu">range</span>(cm.shape[<span class="dv">1</span>])):</span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a>        plt.text(j, i, <span class="bu">format</span>(cm[i, j], fmt),</span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a>                 horizontalalignment <span class="op">=</span> <span class="st">"center"</span>,</span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true" tabindex="-1"></a>                 color <span class="op">=</span> <span class="st">"white"</span> <span class="cf">if</span> cm[i, j] <span class="op">&gt;</span> thresh <span class="cf">else</span> <span class="st">"black"</span>)</span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-45"><a href="#cb59-45" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb59-46"><a href="#cb59-46" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'True label'</span>)</span>
<span id="cb59-47"><a href="#cb59-47" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Predicted label'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute confusion matrix</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>matrix <span class="op">=</span> confusion_matrix(y_test, y_mp, labels <span class="op">=</span> [<span class="dv">0</span>,<span class="dv">1</span>])</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>np.set_printoptions(precision <span class="op">=</span> <span class="dv">2</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot confusion matrix without normalisation</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>plot_confusion_matrix(matrix, </span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>                      <span class="co"># Define classes of outcomes</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>                      classes <span class="op">=</span> [<span class="st">'Max_Phase = 0'</span>,<span class="st">'Max_Phase = 1'</span>], </span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>                      <span class="co"># Set normalize = True if wanting ratios instead</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>                      normalize <span class="op">=</span> <span class="va">False</span>, </span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>                      title <span class="op">=</span> <span class="st">"Confusion matrix without normalisation"</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>                     )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion matrix, without normalization
[[143  59]
 [ 54 123]]</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ML1-1_chembl_cpds_files/figure-html/cell-45-output-2.png" width="570" height="488" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A common rule of thumb for confusion matrix was that all predicted outcomes were columns and all the true outcomes were rows. However, there might be exceptions where this was the other way round. Four different categories could be seen in the confusion matrix which were:</p>
<ul>
<li>True positive - Predicted Max_Phase = 1 &amp; True Max_Phase = 1 (126 out of 189 samples)</li>
<li>True negative - Predicted Max_Phase = 0 &amp; True Max_Phase = 0 (139 out of 190 samples)</li>
<li>False positive - Predicted Max_Phase = 1 &amp; True Max_Phase = 0 (63 out of 189 samples)</li>
<li>False negative - Predicted Max_Phase = 0 &amp; True Max_Phase = 1 (51 out of 190 samples)</li>
</ul>
<p>By having these four categories known would then lead us to the next section about classification report, which showed all the precision, recall, f1-score and support metrics to evaluate the performance of this classifier.</p>
<p><br></p>
</section>
<section id="classification-report" class="level6">
<h6 class="anchored" data-anchor-id="classification-report"><strong>Classification report</strong></h6>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_mp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              precision    recall  f1-score   support

           0       0.73      0.71      0.72       202
           1       0.68      0.69      0.69       177

    accuracy                           0.70       379
   macro avg       0.70      0.70      0.70       379
weighted avg       0.70      0.70      0.70       379
</code></pre>
</div>
</div>
<p><strong><em>Precision</em></strong> was a measure of the accuracy of a predicted outcome, where a class label had been predicted by the classifier. So in this case, we could see that for class label 1, the precision was 0.67, which corresponded to the true positive result of 126 out of 189 samples (= 0.666). It was defined by:</p>
<p><span class="math display">\[
\text{Precision} = \frac{\Sigma\ True\ Positive}{(\Sigma\ True\ Positive + \Sigma\ False\ Positive)}
\]</span></p>
<p><strong><em>Recall</em></strong>, also known as sensitivity (especially widely used in biostatistics and medical diagnostic fields), was a measure of the strength of the classifier to predict a positive outcome. In simple words, it measured the true positive rate. In this example, there was a total of 126 out of 177 samples (which = 0.712, for True Max_Phase = 1 row) that had a true positive outcome of having a max phase of 1. It was defined by:</p>
<p><span class="math display">\[
\text{Recall} = \frac{\Sigma\ True\ Positive}{(\Sigma\ True\ Positive + \Sigma\ False\ Negative)}
\]</span></p>
<p>The precision and recall metrics could also be calculated for class label = 0, which were shown for the row 0 in the classification report.</p>
<p><strong><em>f1-score</em></strong>, or also known as balanced F-score or F-measure, denoted the harmonic average of both precision and recall metrics. This metric would also give another indication about whether this model performed well on outcome predictions. It normally ranged from 0 (worst precision and recall) to 1 (perfect precision and recall). For this particular classifier, f1-score was at 0.69 (for class label = 1), which was definitely not at its worst, but also could be further improved. It was defined as:</p>
<p><span class="math display">\[
\text{F1-score} = \frac{2 \times (Precision \times Recall)}{(Precision + Recall)}
\]</span></p>
<p><strong><em>Support</em></strong>, which some readers might have already worked out how the numbers were derived, was the total number of true samples in each class label (reading row-wise from the confusion matrix). The main purpose of showing this metric was to help clarifying whether the model or classifier had a reasonably balanced dataset for each class or otherwise.</p>
<p><br></p>
</section>
<section id="log-loss" class="level6">
<h6 class="anchored" data-anchor-id="log-loss"><strong>Log loss</strong></h6>
<p>Log loss could be used as another gauge to show how good the classifier was at making the outcome predictions. The further the predicted probability was from the true value, the larger the log loss, which was also ranged from 0 to 1. Ideally, the smaller the log loss the better the model would be. Here, we had a log loss of 0.607 for this particular model.</p>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Log loss</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> log_loss</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>log_loss(y_test, y_mp_proba)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>0.6171675830247453</code></pre>
</div>
</div>
</section>
</section>
<section id="discussions-and-conclusion" class="level4">
<h4 class="anchored" data-anchor-id="discussions-and-conclusion"><strong>Discussions and conclusion</strong></h4>
<p>So here I’ve completed a very basic LR classifier model for ChEMBL compound dataset. By no means was this a perfect ML model as I haven’t actually changed the default settings of <em>scikit-learn</em>’s LogisticRegression() classifier, with examples such as adjusting C, a regularization parameter which was set at ‘1.0’ by default, and also solvers, which could take in different algorithms for use in optimisation problems and normally set as ‘lbfgs’ by default.</p>
<p>So with this default LR model, the evaluation metrics demonstrated a LR classifer of moderate quality to predict the approval outcomes on ChEMBL small molecules, with a lot of rooms for improvements. Therefore, I could not yet confirm fully that the physicochemical parameters chosen would be the best ones to predict the approval outcomes for any small molecules. However, I might be okay to say that these molecular parameters were on the right track to help with making this prediction.</p>
<p>To further improve this model, I could possibly trial changing the C value and use different solvers to see if better outcomes could be achieved, or even add more molecular parameters in the model to test. I could have also trialled adding more class labels, e.g.&nbsp;making it between max phase 1, 2 and 4, or a mix-and-match between each max phase category. Other things to consider would be to use other types of ML methods such as naive Bayes, K-nearest neighbours or decision trees and so on. To tackle the problem thoroughly, I would most likely need to do an ensemble of different ML models to find out which model would be the most optimal to answer our target question.</p>
<p><br></p>
</section>
<section id="final-words" class="level4">
<h4 class="anchored" data-anchor-id="final-words"><strong>Final words</strong></h4>
<p>I’ve experienced the fun of ML after completing this project. The idea was to build on what I knew gradually and enjoy what ML could do when making critical decisions. From what I’ve learnt about ML so far (and definitely more to learn) was that the quality of data was vital for making meaningful interpretations of the results.</p>
<p>However, jumping back to present time, I’ll need to work on my second project first, which is about using Rust interactively via Jupyter notebook. At the moment, I’m not sure how long it will take or how the content will play out. I’ll certainly do as much as I can since Rust is very new to me. If I get very stuck, I’d most likely continue on this ML series. Thanks for reading.</p>
<p><br></p>
</section>
<section id="references" class="level4">
<h4 class="anchored" data-anchor-id="references"><strong>References</strong></h4>
<p>I’ve listed below most of the references used throughout this project. Again, huge thanks could not be forgotten for our online communities, and definitely also towards the references I’ve used here.</p>
<ul>
<li><a href="https://scikit-learn.org/stable/index.html">scikit-learn documentation</a></li>
<li><a href="https://jmlr.csail.mit.edu/papers/v12/pedregosa11a.html">Scikit-learn: Machine Learning in Python</a>, Pedregosa <em>et al.</em>, JMLR 12, pp.&nbsp;2825-2830, 2011.</li>
<li>Bruce, P., Bruce, A. &amp; Gedeck P. (2020). Practical statistics for data scientists. O’Reilly.</li>
<li><a href="https://stackoverflow.com">Stack Overflow</a></li>
<li>Polars references:
<ol type="1">
<li><a href="https://pola-rs.github.io/polars-book/user-guide/introduction.html">Polars - User Guide</a> - https://pola-rs.github.io/polars-book/user-guide/introduction.html</li>
<li><a href="https://pola-rs.github.io/polars/py-polars/html/index.html#">Polars documentation</a> - https://pola-rs.github.io/polars/py-polars/html/index.html#</li>
<li><a href="https://github.com/pola-rs/polars">Polars GitHub repository</a> - https://github.com/pola-rs/polars</li>
</ol></li>
</ul>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/jhylin\.github\.io\/Data_in_life_blog\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
<script>
  function loadGiscus() {
    // Function to get the theme based on body class
    const getTheme = () => {
      let baseTheme = document.getElementById('giscus-base-theme').value;
      let altTheme = document.getElementById('giscus-alt-theme').value;
      if (authorPrefersDark) {
          [baseTheme, altTheme] = [altTheme, baseTheme];
      }
      return document.body.classList.contains('quarto-dark') ? altTheme : baseTheme;
    };
    const script = document.createElement("script");
    script.src = "https://giscus.app/client.js";
    script.async = true;
    script.dataset.repo = "jhylin/Data_in_life_blog";
    script.dataset.repoId = "R_kgDOHw7lGQ";
    script.dataset.category = "General";
    script.dataset.categoryId = "DIC_kwDOHw7lGc4CQzQ_";
    script.dataset.mapping = "title";
    script.dataset.reactionsEnabled = "1";
    script.dataset.emitMetadata = "0";
    script.dataset.inputPosition = "top";
    script.dataset.theme = getTheme();
    script.dataset.lang = "en";
    script.crossOrigin = "anonymous";
    // Append the script to the desired div instead of at the end of the body
    document.getElementById("quarto-content").appendChild(script);
  }
  loadGiscus();
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Website made with 💜 in <a href="https://quarto.org/">Quarto</a> by Jennifer HY Lin © 2022 - 2025</p>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jhylin/Data_in_life_blog/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>